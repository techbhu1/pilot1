<html lang="en-US">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
<title>7-Configuring Shortest Path Bridging</title>
<link href="../../rhstylemapping.css" rel="stylesheet" type="text/css" />
<link href="../os8_nt___Web.css" rel="stylesheet" type="text/css" />
<link href="../../editstyle.css" rel="stylesheet" type="text/css" /><script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
p.WebHelpNavBar { text-align:right; }
-->
</style>
 <meta name="generator" content="Adobe FrameMaker v16.0" />
<script type="text/javascript" src="../../template/scripts/rh.min.js"></script>
<script type="text/javascript" src="../../template/scripts/common.min.js"></script>
<script type="text/javascript" src="../../template/scripts/topic.min.js"></script>
<script type="text/javascript" src="../../template/scripts/constants.js"></script>
<script type="text/javascript" src="../../template/scripts/utils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhutils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhlang.js"></script>
<script type="text/javascript" src="../../template/scripts/mhver.js"></script>
<script type="text/javascript" src="../../template/scripts/settings.js"></script>
<script type="text/javascript" src="../../template/scripts/XmlJsReader.js"></script>
<script type="text/javascript" src="../../template/scripts/loadparentdata.js"></script>
<script type="text/javascript" src="../../template/scripts/loadscreen.js"></script>
<script type="text/javascript" src="../../template/scripts/loadprojdata.js"></script>
<script type="text/javascript" src="../../template/scripts/mhtopic.js"></script>
 <link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css">
<script type="text/javascript" >
gRootRelPath = "../..";
gCommonRootRelPath = "../..";
gTopicId = "0_9";
</script>
</head>
<body dir="ltr">
<script type="text/javascript" src="../../ehlpdhtm.js"></script>
<div class="FLOW_A" dir="ltr"><p class="Chapter_Title" id="1118799">7    <br/><a id="XREF_15243__1_Configuring_Spanning_Tree_Parameters163" name="XREF_15243__1_Configuring_Spanning_Tree_Parameters163">Configuring Shortest </a>Path Bridging </p><p class="text" id="1118045"><a id="163_text_1118045" name="163_text_1118045"></a>The OmniSwitch supports <a id="index_1135417" name="index_1135417"></a><a data-indexterm="Shortest%20Path%20Bridging" id="Shortest_Path_Bridging" name="Shortest_Path_Bridging"></a><a data-indexterm="%3C$nopage%3ESPB%3Csee%20also%3E%20see%20%3Cdefault%20para%20font%3E%20Shortest%20Path%20Bridging" id="%3C$nopage%3ESPB%3Csee_also%3E_see_%3Cdefault_para_font%3E_Shortest_Path_Bridging" name="%3C$nopage%3ESPB%3Csee_also%3E_see_%3Cdefault_para_font%3E_Shortest_Path_Bridging"></a>Shortest Path Bridging MAC (SPBM), as defined in the IEEE 8&#x30;2.1aq standard. SPBM uses the Provider Backbone Bridge (PBB) network model to encapsulate (using IEEE 8&#x30;2.1ah headers) and tunnel customer traffic through the network backbone. The shortest path trees upon which the PBB network infrastructure operates are determined using a version of the Intermediate System&#x2D;to&#x2D;Intermediate System (IS&#x2D;IS) link state protocol that supports TLV extensions for SPB (ISIS&#x2D;SPB).</p><p class="text" id="1118348"><a id="index_1135418" name="index_1135418"></a><a data-indexterm="Shortest%20Path%20Bridging:benefits" id="Shortest_Path_Bridging_benefits" name="Shortest_Path_Bridging_benefits"></a>Incorporating SPBM into the data center infrastructure provides the following benefits&#x3A;</p><p class="bullet" id="1118349"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Transparently extends Layer 2 connections (VLAN segments) across a large virtual service Layer 2 backbone network. </p><p class="bullet" id="1120863"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Maintains a loop&#x2D;free network while providing efficient use of available bandwidth, especially in a mesh topology. All connections between all switches in the topology remain active (no blocking of redundant links).</p><p class="bullet" id="1118351"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A shortest path is automatically calculated between each bridge and every other bridge in the data center mesh, resulting in low latency and sub&#x2D;second convergence times needed to support critical data center bridging requirements.</p><p class="bullet" id="1118352"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Can process a large number of customer MAC addresses without overrunning provider network resources. Customer MAC addresses are only learned on Backbone Edge Bridges (BEB), where customer traffic is then encapsulated and tunneled through the network core infrastructure. Backbone Core Bridges (BCB) do not have to learn any customer MAC addresses.</p><p class="bullet" id="1118353"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Provides a clear separation of customer traffic (between different customers and between the provider network domain). Entry points for customer traffic are clearly defined on the participating BEBs. Customer traffic is identified and associated with a specific service instance bound to the PBB infrastructure. </p><p class="bullet" id="1135853"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Integration with Virtual Machine Network Profiles (vNPs) to support virtual machine (VM) discovery and mobility. </p><p class="heading1" id="1134826">In This Chapter</p><p class="text" id="1077826">This chapter provides an overview about how Shortest Path Bridging MAC (SPBM) works and how to configure SPBM through the Command Line Interface (CLI). CLI commands are used in the configuration examples; for more details about the syntax of commands, see the <span class="Times_italics" style="font-style:Italic;background-color:transparent;"><span data-keyref="CLI Reference Guide">OmniSwitch AOS Release 8 CLI Reference Guide</span></span>.</p><p class="text" id="1077827">This chapter includes the following topics&#x3A;</p><p class="bullet" id="1118775"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_23013__SPBM_Parameter_Defaults163" style="color:#0000ff;background-color:transparent;">SPBM Parameter Defaults</a>.</p><p class="bullet" id="1118780"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_79082__SPBM_Interface_Defaults163" style="color:#0000ff;background-color:transparent;">SPBM Interface Defaults</a>.</p><p class="bullet" id="1134716"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_66283__SPBM_Service_Defaults163" style="color:#0000ff;background-color:transparent;">SPBM Service Defaults</a>.</p><p class="bullet" id="1118785"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_74808__Shortest_Path_Bridging_Overview163" style="color:#0000ff;background-color:transparent;">Shortest Path Bridging Overview</a>.</p><p class="bullet" id="1350500"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_22820__SPBM_Pseudo-Wire_(E-LINE_Transparent)_Service163" style="color:#0000ff;background-color:transparent;">SPBM Pseudo-Wire (E-LINE Transparent) Service</a>.</p><p class="bullet" id="1182676"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_76050__Remote_Fault_Propagation_for_SPBM_Services163" style="color:#0000ff;background-color:transparent;">Remote Fault Propagation for SPBM Services</a>.</p><p class="bullet" id="1140222"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_21917__IP_over_SPB-M163" style="color:#0000ff;background-color:transparent;">IP over SPBM</a>.</p><p class="bullet" id="1291009"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_79553__SPB_over_a_Shared_Network163" style="color:#0000ff;background-color:transparent;">SPB Over Shared Ethernet</a>.</p><p class="bullet" id="1362654"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_52604__SPB_In-Band_Management163" style="color:#0000ff;background-color:transparent;">SPB In-Band Management</a>.</p><p class="bullet" id="1134003"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_69468__Quick_Steps_for_Configuring_a_VLAN_Stacking_Service163" style="color:#0000ff;background-color:transparent;">Interaction With Other Features</a>.</p><p class="bullet" id="1118770"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_34328__Quick_Steps_for_Configuring_Service-Based_VLAN_Stacking163" style="color:#0000ff;background-color:transparent;">Quick Steps for Configuring SPBM</a>.</p><p class="bullet" id="1071096"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_30935__Configuring_SPBM163" style="color:#0000ff;background-color:transparent;">Configuring SPBM</a>.</p><p class="bullet" id="1353002"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_26657__Configuring_an_SPB_Pseudo-Wire_Service163" style="color:#0000ff;background-color:transparent;">Configuring an SPB Pseudo-Wire Service</a>.</p><p class="bullet" id="1250928"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_32410__Configuring_Remote_Fault_Propagation_for_SPBM163" style="color:#0000ff;background-color:transparent;">Configuring Remote Fault Propagation for SPBM</a>.</p><p class="bullet" id="1250934"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_26416__Configuring_IP_over_SPB163" style="color:#0000ff;background-color:transparent;">Configuring IP over SPB</a>.</p><p class="bullet" id="1317433"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_27091__Configuring_SPB_over_a_Multiple_Access_Domain163" style="color:#0000ff;background-color:transparent;">Configuring SPB Over Shared Ethernet</a>.</p><p class="bullet" id="1133850"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_98796__Verifying_the_SPB_Backbone_and_Services163" style="color:#0000ff;background-color:transparent;">Verifying the SPB Backbone and Services</a>.</p><p class="heading1" id="1095675"><a id="XREF_23013__SPBM_Parameter_Defaults163" name="XREF_23013__SPBM_Parameter_Defaults163">SPBM Parameter Defaults </a><div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="215.04px"/><col width="208.80px"/><col width="172.80px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1095598"><a id="163_CellHeading_1095598" name="163_CellHeading_1095598"></a>Parameter Description</p></th><th><p class="CellHeading" id="1095600">Command</p></th><th><p class="CellHeading" id="1095602">Default</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1095604">ISIS&#x2D;SPB status for the switch.</p></td><td><p class="CellBody" id="1095609"><a href="../c_spb/c_spb.htm#XREF_74387__spb_isis_status" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis admin-state</a></p></td><td><p class="CellBody" id="1095611">Disabled</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1121060">Equal Cost Tree (ECT) ID number for the backbone VLAN (BVLAN).</p></td><td><p class="CellBody" id="1121062"><a href="../c_spb/c_spb.htm#XREF_40021__spb_isis_bvlan_ect-id" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis bvlan ect-id</a></p></td><td><p class="CellBody" id="1121064">1 or next available ECT ID number on the local switch.</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1121072">Control BVLAN for the switch.</p></td><td><p class="CellBody" id="1121074"><a href="../c_spb/c_spb.htm#XREF_48955__spb_isis_control-bvlan" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis control-bvlan</a></p></td><td><p class="CellBody" id="1121076">None</p></td></tr><tr height="55.33px"><td><p class="CellBody" id="1121084">The BVLAN tandem multicast mode (only applies to associated SPB services running in tandem mode).</p></td><td><p class="CellBody" id="1121086"><a href="../c_spb/c_spb.htm#XREF_32089__spb_isis_bvlan_tandem-multicast-mode" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis bvlan tandem-multicast-mode</a></p></td><td><p class="CellBody" id="1121088">Source and Group (S, G)</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1117720">Priority value for the ISIS&#x2D;SPB instance.</p></td><td><p class="CellBody" id="1117725"><a href="../c_spb/c_spb.htm#XREF_14166__spb_isis_bridge-priority" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis bridge-priority</a></p></td><td><p class="CellBody" id="1117727">32768</p></td></tr><tr height="55.33px"><td><p class="CellBody" id="1117833">Wait time intervals, in milliseconds, for shortest path first (SPF) calculations.</p></td><td><p class="CellBody" id="1117838"><a href="../c_spb/c_spb.htm#XREF_57297__spb_isis_spf-wait" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis spf-wait</a></p></td><td><p class="CellBody" id="1117840">maximum wait&#x3A; 1&#x30;&#x30;&#x30; </p><p class="CellBody" id="1117841">initial wait       &#x3A; 1&#x30;&#x30;</p><p class="CellBody" id="1117842">second wait    &#x3A; 3&#x30;&#x30;</p></td></tr><tr height="55.33px"><td><p class="CellBody" id="1117844">Wait time intervals, in milliseconds, for link state PDU (LSP) transmissions.</p></td><td><p class="CellBody" id="1117849"><a href="../c_spb/c_spb.htm#XREF_37596__spb_isis_lsp-wait" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis lsp-wait</a></p></td><td><p class="CellBody" id="1117851">maximum wait&#x3A; 1&#x30;&#x30;&#x30;</p><p class="CellBody" id="1117852">initial wait       &#x3A; &#x30;</p><p class="CellBody" id="1117853">second wait    &#x3A; 3&#x30;&#x30;</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1117980">Graceful restart status for the switch.</p></td><td><p class="CellBody" id="1117982"><a href="../c_spb/c_spb.htm#XREF_11235__spb_isis_graceful-restart" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis graceful-restart</a></p></td><td><p class="CellBody" id="1117984">Enabled</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1117989">Graceful restart helper status for the switch.</p></td><td><p class="CellBody" id="1117991"><a href="../c_spb/c_spb.htm#XREF_16646__spb_isis_graceful-restart_helper" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis graceful-restart helper</a></p></td><td><p class="CellBody" id="1117993">Enabled</p></td></tr></table></div></p><p class="heading1" id="1095738"><a id="XREF_79082__SPBM_Interface_Defaults163" name="XREF_79082__SPBM_Interface_Defaults163">SPBM Interface Defaults</a><div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="215.04px"/><col width="208.80px"/><col width="172.80px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1095679"><a id="163_CellHeading_1095679" name="163_CellHeading_1095679"></a>Parameter Description </p></th><th><p class="CellHeading" id="1095681">Command</p></th><th><p class="CellHeading" id="1095683">Default</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1117940">SPB interface status</p></td><td><p class="CellBody" id="1117945"><a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a></p></td><td><p class="CellBody" id="1117947">Disabled</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1117949">SPB interface time interval between each hello packet transmission.</p></td><td><p class="CellBody" id="1117954"><a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a>&#160;<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">hello&#x2D;interval</span></p></td><td><p class="CellBody" id="1117956">9 seconds</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1117958">SPB interface hello multiplier used to determine hello packet hold time.</p></td><td><p class="CellBody" id="1117963"><a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a>&#160;<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">hello&#x2D;multiplier</span></p></td><td><p class="CellBody" id="1117965">3</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1117967">SPB interface link cost to reach the peer bridge.</p></td><td><p class="CellBody" id="1117972"><a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a>&#160;<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">metric</span></p></td><td><p class="CellBody" id="1117974">1&#x30;</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1288583">SPB interface type (P2P or multiple access).</p></td><td><p class="CellBody" id="1288585"><a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a>&#160;<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">type</span></p></td><td><p class="CellBody" id="1288587">Point&#x2D;to&#x2D;point (P2P)</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1288677">SPB interface priority (applies only to multiple access interfaces)</p></td><td><p class="CellBody" id="1288792"><a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a>&#160;<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">priority</span></p></td><td><p class="CellBody" id="1288681">64</p></td></tr></table></div></p><p class="heading1" id="1120979"><a id="XREF_66283__SPBM_Service_Defaults163" name="XREF_66283__SPBM_Service_Defaults163">SPBM Service Defaults</a></p><p>By default, there are no SPBM service components configured for the switch. However, when a service is created, the following default values apply&#x3A;<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="197.76px"/><col width="192.00px"/><col width="203.52px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1135641"><a id="163_CellHeading_1135641" name="163_CellHeading_1135641"></a>Parameter Description </p></th><th><p class="CellHeading" id="1135643">Command</p></th><th><p class="CellHeading" id="1135645">Default</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1135647">SPB service administrative status.</p></td><td><p class="CellBody" id="1135652" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_55074__service_spb_admin-state" style="background-color:transparent;">service admin-state</a></p></td><td><p class="CellBody" id="1135654">Disabled</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1135656">SPB service multicast replication mode.</p></td><td><p class="CellBody" id="1135661" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_69846__service_spb_multicast-mode" style="background-color:transparent;">service multicast-mode</a></p></td><td><p class="CellBody" id="1135663">Head&#x2D;end</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1135665">SPB service VLAN translation.</p></td><td><p class="CellBody" id="1135670" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_57097__service_spb_vlan-xlation" style="background-color:transparent;">service vlan-xlation</a></p></td><td><p class="CellBody" id="1135672">Disabled</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1135674">SPB service maximum transmission unit (MTU) value.</p></td><td><p class="CellBody" id="1135676">Not configurable at this time</p></td><td><p class="CellBody" id="1135678">9194</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1135680">SPB service statistics collection.</p></td><td><p class="CellBody" id="1135685" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_32744__service_spb_stats" style="background-color:transparent;">service stats</a></p></td><td><p class="CellBody" id="1135687">Disabled</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1135689">SPB service description.</p></td><td><p class="CellBody" id="1135694" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_10587__service_spb_description" style="background-color:transparent;">service description</a></p></td><td><p class="CellBody" id="1135696">None.</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1135698">Default profile automatically applied to access ports.</p></td><td><p class="CellBody" id="1135703" style="font-weight:Bold;color:#0000ff;"><span style="font-weight:normal;color:#000000;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_90596__service_port_l2profile" style="background-color:transparent;">service access l2profile</a></span></p></td><td><p class="CellBody" id="1135705">def&#x2D;access&#x2D;profile</p></td></tr><tr height="87.33px"><td><p class="CellBody" id="1135707">Layer 2 profile that specifies how control packets are processed on service access ports.</p></td><td><p class="CellBody" id="1135712" style="font-weight:Bold;color:#0000ff;"><span class="blue_bold" style="background-color:transparent;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_48070__service_l2profile" style="background-color:transparent;">service l2profile</a></span></p></td><td><p class="CellBody" id="1135714">def&#x2D;access&#x2D;profile&#x3A; </p><p class="CellBody" id="1135715">STP, GVRP, MVRP &#x3D; tunnel</p><p class="CellBody" id="1135716">8&#x30;2.3ad &#x3D; peer</p><p class="CellBody" id="1135717">8&#x30;2.1x, 8&#x30;2.1ab, AMAP &#x3D; drop</p><p class="CellBody" id="1135718">CSCO PDU, VLAN, uplink &#x3D; drop</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1135720">VLAN translation for the service access port.</p></td><td><p class="CellBody" id="1135725" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_89704__service_access_vlan-xlation" style="background-color:transparent;">service access vlan-xlation</a></p></td><td><p class="CellBody" id="1135727">Disabled</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1135729">Service access point (SAP) administrative status.</p></td><td><p class="CellBody" id="1135734" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_48837__service_spb_sap_admin-state" style="background-color:transparent;">service sap admin-state</a></p></td><td><p class="CellBody" id="1135736">Enabled</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1135738">SAP encapsulation.</p></td><td><p class="CellBody" id="1135743" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_73897__service_spb_sap" style="background-color:transparent;">service sap</a></p></td><td><p class="CellBody" id="1135745">&#x30; (untagged traffic).</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1135747">SAP trust mode.</p></td><td><p class="CellBody" id="1135752"><a href="../c_svcmgr/c_svcmgr.htm#XREF_34281__service_spb_sap_trusted" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap trusted</a></p></td><td><p class="CellBody" id="1135754">Trusted</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1135756">SAP statistics collection.</p></td><td><p class="CellBody" id="1135761"><a href="../c_svcmgr/c_svcmgr.htm#XREF_57012__service_spb_stats" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap stats</a></p></td><td><p class="CellBody" id="1135763">Disabled</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1135765">SAP description.</p></td><td><p class="CellBody" id="1135770"><a href="../c_svcmgr/c_svcmgr.htm#XREF_15874__service_spb_sap_description" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap description</a></p></td><td><p class="CellBody" id="1135772">None</p></td></tr></table></div></p><p class="heading1" id="1134777"><a id="XREF_74808__Shortest_Path_Bridging_Overview163" name="XREF_74808__Shortest_Path_Bridging_Overview163">Shortest Path Bridging Overview</a></p><p class="text" id="1134778"><a id="163_text_1134778" name="163_text_1134778"></a>The OmniSwitch implementation of <a id="index_1135440" name="index_1135440"></a><a data-indexterm="Shortest%20Path%20Bridging" id="Shortest_Path_Bridging" name="Shortest_Path_Bridging"></a>Shortest Path Bridging (SPB) supports SPB MAC (SPBM) as defined in the IEEE 8&#x30;2.1aq standard. SPBM is defined for use in <a id="index_1135441" name="index_1135441"></a><a data-indexterm="Provider%20Backbone%20Bridge:802.1AH" id="Provider_Backbone_Bridge_802_1AH" name="Provider_Backbone_Bridge_802_1AH"></a><a data-indexterm="%3C$nopage%3EPBB%3Csee%20also%3E%20see%20%3Cdefault%20para%20font%3E%20Provider%20Backbone%20Bridge" id="%3C$nopage%3EPBB%3Csee_also%3E_see_%3Cdefault_para_font%3E_Provider_Backbone_Bridge" name="%3C$nopage%3EPBB%3Csee_also%3E_see_%3Cdefault_para_font%3E_Provider_Backbone_Bridge"></a>Provider Backbone Bridge (PBB) networks as specified in the IEEE 8&#x30;2.1ah standard.</p><p class="text" id="1123946">SPBM provides a mechanism to automatically define a shortest path tree (SPT) bridging configuration through a Layer 2 Ethernet network. SPBM Ethernet services use this configuration to encapsulate and tunnel data through the PBB network. The following main components of the OmniSwitch implementation of SPBM provide this type of functionality&#x3A;</p><p class="bullet" id="1119269"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ISIS&#x2D;SPB&#x2014;</span>A version of the Intermediate to Intermediate System (IS&#x2D;IS) link state protocol that supports SPB TLV extensions. SPBM uses ISIS&#x2D;SPB to build sets of symmetric shortest path trees (SPTs) between any SPB switch. </p><p class="bullet" id="1119315"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Provider Backbone Bridge (PBB) IEEE 8&#x30;2.1ah</span>&#x2014; Defines a MAC&#x2D;in&#x2D;MAC data encapsulation path for PBB networks that is supported by SPBM. </p><p class="bullet" id="1119395"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Provider Backbone Bridge Network (PBBN)&#x2014;<a id="index_1135442" name="index_1135442"></a><a data-indexterm="Provider%20Backbone%20Bridge:network" id="Provider_Backbone_Bridge_network" name="Provider_Backbone_Bridge_network"></a></span>A network comprised of Backbone Edge Bridges (BEBs) and Backbone Core Bridges (BCB) that is used to interconnect Provider Bridge Networks (PBN) with other networks.</p><p class="bullet" id="1119304"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Backbone Edge Bridge (BEB)&#x2014;</span>An SPB switch positioned at the edge of the PBB network that learns and encapsulates (adds an 8&#x30;2.1ah backbone header to) customer frames for transport across the backbone network. The BEB interconnects the customer network space with PBB network space. </p><p class="bullet" id="1119467"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Backbone Core Bridge (BCB)&#x2014;</span>An SPB node that resides inside the PBB network core. The BCB employs the same BVLAN on two or more network ports. This BVLAN does not terminate on the switch itself; traffic ingressing on an SPB network port is switched to other SPB network ports. As a result, the BCB does not have to learn any of the customer MAC addresses. It mainly serves as a transit bridge for the PBB network.</p><p class="bullet" id="1135519"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">SPBM Service&#x2014;</span>An OmniSwitch Service Manager<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">&#160;</span>service configured on the BEBs. Each service maps to a service instance identifier (I&#x2D;SID) which is bound to a backbone VLAN. One backbone VLAN can accommodate multiple I&#x2D;SIDs. </p><p class="bullet" id="1135520"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Backbone VLAN (BVLAN)&#x2014;</span>A VLAN that serves as a transport VLAN for the SPBM service instances and to connect SPB bridges together through SPT sets. Unlike standard VLANs, BVLANs do not learn source MAC addresses or flood unknown destination or multicast frames. Instead, BVLANs only forward on the basis of the forwarding database (FDB) as populated by the ISIS&#x2D;SPB protocol.</p><p class="text" id="1125285">The following diagram shows how SPBM uses the above components to tunnel customer traffic through a Provider Backbone Bridge Network&#x3A;</p><p class="text" id="1133762"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_68.svg" height="355.822408" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="516.176086"></object></p><p class="Figure_Title_NumOne" id="1125292">Figure 7&#x2D;1 &#x3A;  SPBM Network Components</p><p class="text" id="1130018">In this network, </p><p class="bullet" id="1119958"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The BEBs are SPBM capable (ISIS&#x2D;SPB configured and enabled) and form a shortest path bridging network that also includes the SPBM capable Backbone Core Bridges (BCBs).</p><p class="bullet" id="1135141"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Each bridge calculates a shortest path tree (SPT) for each BVLAN with itself as the root of each tree. </p><p class="bullet" id="1119979"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB Ethernet service instances identified by I&#x2D;SIDs are created on each BEB. Each I&#x2D;SID is associated with a BVLAN ID. The BVLAN is configured on each bridge (BEB and BCB) in the backbone network. However, the I&#x2D;SID itself and the I&#x2D;SID association with the BVLAN is only configured on each BEB that will service customer traffic.</p><p class="bullet" id="1119991"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A Service Access Point (SAP) is configured on each BEB to identify the access port on which customer traffic will enter the PBBN, the SPB service instance that will tunnel the traffic through the network, and the type of customer traffic to forward (for example, only specific CVLAN IDs, untagged traffic only, or all tagged traffic). Basically, the SAP binds access ports and the specified customer traffic received on those ports to the service.</p><p class="bullet" id="1119992"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Layer 2 traffic from the connected edge networks enters the BEBs through access ports. The SAP configuration on the receiving access port is applied to classify which frames are mapped to which services, if any. </p><p class="bullet" id="1120064"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Classified traffic is then encapsulated into 8&#x30;2.1ah frames by the BEB before the frames are transmitted through the backbone network. </p><p class="bullet" id="1121198"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The 8&#x30;2.1ah encapsulated frames are forwarded on the shortest path through the entire PBBN to reach the intended destination BEB. The BCBs switch traffic based on the destination backbone MAC address (BMAC)&#x2014;bridge MAC address of the BEB&#x2014;provided in the 8&#x30;2.1ah header and do not process any I&#x2D;SID information in the frame.</p><p class="heading2" id="1121200"><a id="XREF_70872__SPBM_Shortest_Path_Trees163" name="XREF_70872__SPBM_Shortest_Path_Trees163">SPBM Shortest Path Trees</a></p><p class="text" id="1134845"><a id="163_text_1134845" name="163_text_1134845"></a>The shortest path between two points is a straight line. Shortest Path Bridging (SPB) implements frame forwarding on the shortest path between any two bridges in an Ethernet network. The <a id="index_1135443" name="index_1135443"></a><a data-indexterm="Shortest%20Path%20Bridging:shortest%20path%20trees" id="Shortest_Path_Bridging_shortest_path_trees" name="Shortest_Path_Bridging_shortest_path_trees"></a><a data-indexterm="Shortest%20Path%20Bridging:SPT" id="Shortest_Path_Bridging_SPT" name="Shortest_Path_Bridging_SPT"></a>shortest path trees (SPTs) calculated by SPB provide the shortest and most efficient path to and from the intended destination. SPTs are formed along the direct, straight&#x2D;line links between switches to make up an overall path through the topology that provides a robust, efficient direction for network traffic to travel.</p><p class="text" id="1123915">The SPBM network topology consists of two layers&#x3A; </p><p class="bullet" id="1134858"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">The backbone infrastructure (control plane) layer</span>. ISIS&#x2D;SPB builds the backbone layer by defining loop&#x2D;free, shortest path trees (SPTs) through the backbone network. </p><p class="bullet" id="1144178"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">The services (data plane) layer</span>. The service layer is based on the Provider Backbone Bridging (PBB) framework as defined in the IEEE 8&#x30;2.1ah standard. SPBM supports the 8&#x30;2.1ah MAC&#x2D;in&#x2D;MAC method for data encapsulation. SPBM services transport the encapsulated traffic over the ISIS&#x2D;SPB infrastructure. (See <a  href="#XREF_16431__SPB_Services163" style="color:#0000ff;background-color:transparent;">SPB Services</a> for more information).</p><p class="text" id="1144182">This section contains an example of ISIS&#x2D;SPB operations in a small SPBM network. In addition to describing how shortest path trees are created in the BVLAN domain, the flow of unicast and multicast traffic through the network, this example also shows the benefits of using SPB over Spanning Tree for VLAN traffic distribution.</p><p class="heading3" id="1120248">Spanning Tree</p><p class="text" id="1151748">The following diagram shows an example Provider Backbone Bridge (PBB) network with a single backbone VLAN using the Spanning Tree protocol for network loop protection with the same path cost on all links&#x3A;<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_70.svg" height="322.000427" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="493.999512"></object></p><p class="FigureTitle" id="1120250">Figure 7&#x2D;2 &#x3A;  Spanning Tree Topology</p><p class="text" id="1120238">In this example, Bridge A is the Root bridge. As a result, customer traffic entering Bridge A would always use the shortest path to reach every other bridge in the network. However, traffic entering Bridge D that is destined for Bridge C must traverse the path through Bridge A to reach Bridge C, even though Bridge D is directly connected to Bridge C. Clearly the path from Bridge D to Bridge C is not the shortest path in this case.</p><p class="heading3" id="1120334">ISIS&#x2D;SPB</p><p class="text" id="1120649"><a id="index_1135444" name="index_1135444"></a><a data-indexterm="ISIS-SPB" id="ISIS-SPB" name="ISIS-SPB"></a><a data-indexterm="Shortest%20Path%20Bridging:ISIS-SPB" id="Shortest_Path_Bridging_ISIS-SPB" name="Shortest_Path_Bridging_ISIS-SPB"></a>The IEEE 8&#x30;2.1aq standard for SPB specifies the use of the IS&#x2D;IS link state protocol instead of Spanning Tree to form sets of shortest path trees through the network. When SPB is used, each bridge is the Root for all traffic entering that bridge. As a result, each bridge can provide the shortest path to every other bridge in the network.</p><p class="text" id="1120339">The bridging methodology needed to allow each bridge to serve as its own root bridge is enforced through the use of SPB BVLANs. This type of VLAN does not learn customer MAC addresses or flood unknown unicast and multicast traffic. In addition, network loops are mitigated through strict ingress checks based on the source MAC address of frames received on the BVLAN (frames received from an unexpected source are discarded).</p><p class="text" id="1120341">SPBM uses an extended version of the IS&#x2D;IS protocol that supports SPB (ISIS&#x2D;SPB) to calculate the SPBM network topology. In addition, the learning and propagation of source MAC addresses is handled through the ISIS&#x2D;SPB control plane, instead of through the data plane.</p><p class="text" id="1120374">When calculating the SPBM network topology, ISIS&#x2D;SPB must meet Layer 2 requirements to create congruent and symmetric paths. To do this, SPBM supports 16 predefined Equal Cost Tree (ECT) algorithms to break ties when two or more equal cost paths to the same destination are discovered. The same ECT algorithm is configured for the same BVLAN ID on each SPB switch in the network to ensure congruent, symmetric paths for the service traffic bound to that BVLAN.</p><p class="text" id="1120375">Basically, to create a unicast tree, SPBM simply computes the shortest path from every bridge with each bridge serving as the Root (as shown below) and populates the Layer 2 forwarding database (FDB) on the SPB bridges with MAC addresses. </p><p class="text" id="1291247"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_75.svg" height="476.201152" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="618.000020"></object></p><p class="FigureTitle" id="1291248">Figure 7&#x2D;3 &#x3A;  ISIS&#x2D;SPB Shortest Path Calculations</p><p class="text" id="1291249">The ISIS&#x2D;SPB unicast trees shown in Figure 3 were built as follows&#x3A;</p><p class="step_first" id="1120665"><span class="Futura_Bold">1&#160;&#160;&#160; </span>Bridge A calculates the shortest path tree to Bridge B and then programs its FDB with MAC address B on the link, as shown in (1). </p><p class="step_next" id="1120666"><span class="Futura_Bold">2&#160;&#160;&#160; </span>Bridge A will then calculate shortest paths to Bridge C and Bridge D and programs the MAC addresses according to the path computed. </p><p class="step_next" id="1120667"><span class="Futura_Bold">3&#160;&#160;&#160; </span>All other bridges follow the same procedure (note that the actual computation is much more optimized and the description here is only for illustration purposes).</p><p class="step_next" id="1120683"><span class="Futura_Bold">4&#160;&#160;&#160; </span>The following traffic pattern for this example network is the result of the ISIS&#x2D;SPB SPT calculations&#x3A;</p><p class="screen2" id="1120335"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_92.svg" height="365.000549" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="419.999227"></object></p><p class="FigureTitle" id="1120481">Figure 7&#x2D;4 &#x3A;  ISIS&#x2D;SPB Topology</p><p class="text" id="1120693">As shown in Figure 4, all the backbone MAC (BMAC) addresses are learned by the switches when ISIS&#x2D;SPB converges. The path taken by each unicast flow (for example ABC, CBA) are reverse path congruent and travel the shortest path through the network.</p><p class="text" id="1120483">In the ISIS&#x2D;SPB topology (Figure 4), the link between Bridge D and Bridge C carries traffic, whereas in the Spanning Tree topology (Figure 3), this link is blocked. Although these examples are based on traffic distribution for a single BVLAN, the ability to make all links in the topology available at all times is especially advantageous in highly redundant, meshed networks.</p><p class="text" id="1120719">Although the link between Bridge D and Bridge C is used in the ISIS&#x2D;SPB topology, traffic flow is relatively low in comparison to the other links. To make better use of this link, a second BVLAN could be created and assigned a different ECT algorithm to trigger ISIS&#x2D;SPB calculations of a separate set of SPTs for the second BVLAN. This is similar to creating a new Multiple Spanning Tree (MST) instance in a Spanning Tree topology to create a different tree and assigning a new VLAN to that instance.</p><p class="text" id="1120775">Each ECT algorithm uses a different calculation to break ties when paths between SPB bridges are equal cost. Another method to influence the SPT calculation is to modify the bridge priority for the switch or change the link cost metric for the SPB interface connection between two switches.</p><p class="heading4" id="1120487">Multicast Traffic</p><p class="text" id="1120740">SPBM supports two methods for replicating and forwarding multicast traffic (or unknown destination traffic) received from customer equipment&#x3A; head&#x2D;end replication and tandem replication. </p><p class="bullet" id="1120789"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Head&#x2D;end replication</span>. Multicast traffic is replicated once for each receiver, encapsulated with the BMAC address, and then sent as a unicast packet to each destination. This method is more suited for networks where there is a low demand for multicast traffic.</p><p class="bullet" id="1135165"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Tandem replication</span>. Multicast traffic is replicated only where there is a fork in the SPT and each branch has at least one receiver. Each multicast source bridge in the SPBM network is the root for a multicast distribution tree (MDT). An MDT is created per&#x2D;source per&#x2D;BVLAN and it is pruned according to whether the SPB node is on the shortest path of a multicast transmitter and receiver. For those MDTs that cross a given Backbone Core Bridge (BCB), that BCB needs to generate a multicast forwarding table for each such MDT.</p><p>Multicast traffic originating from a bridge is encapsulated with a special multicast BMAC DA that identifies the source of the traffic and then forwarded on the tree. Participating bridges that receive the packet will then know the source of the traffic and will use the multicast forwarding information for that source to switch the packet to the appropriate destination.<span style="font-size : 12.00pt;"><div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="144.00px"/><col width="144.00px"/><col width="144.00px"/><col width="144.00px"/><thead><tr height="28.67px"><th/><th><p class="CellHeading" id="1386574" style="text-align:center;">Head&#x2D;end</p></th><th><p class="CellHeading" id="1386834" style="text-align:center;">&#160;&#160;&#160;Tandem (S,G)&#160;&#160;&#160;</p></th><th><p class="CellHeading" id="1386581" style="text-align:center;">Tandem (&#x2A;,G)</p></th></tr></thead><tr height="23.33px"><td/><td/><td/><td/></tr><tr height="87.33px"><td><p class="CellBody" id="1386597" style="font-kerning:normal;">Operation</p></td><td><p class="CellBody" id="1387040">BUM traffic replicated at ingress BEB and forwarded</p><p class="CellBody" id="1386599">using the unicast FDB.</p></td><td><p class="CellBody" id="1387017">&#160;&#160;&#160;BUM traffic forwarded per the multicast FDB and replicated as needed at the SPT&apos;s fork&#x2D;out points.</p></td><td><p class="CellBody" id="1386603">BUM traffic forwarded using a shared, non&#x2D;SP tree and replicated at fork&#x2D;out points.</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1386608" style="font-kerning:normal;">Bandwidth efficiency</p></td><td><p class="CellBody" id="1386610" style="text-align:center;">Low</p></td><td><p class="CellBody" id="1386612" style="text-align:center;">High</p></td><td><p class="CellBody" id="1386614" style="text-align:center;">High</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1386917" style="font-kerning:normal;">Resource efficiency</p></td><td><p class="CellBody" id="1386621" style="text-align:center;">High</p></td><td><p class="CellBody" id="1387093" style="text-align:center;">&#160;&#160;&#160;Low&#160;&#160;&#160;&#160;&#160;&#160;</p></td><td><p class="CellBody" id="1386625" style="text-align:center;">Medium</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1386640" style="font-kerning:normal;">Congruency</p></td><td><p class="CellBody" id="1386643" style="text-align:center;">Yes</p></td><td><p class="CellBody" id="1386645" style="text-align:center;">Yes</p></td><td><p class="CellBody" id="1386647" style="text-align:center;">No</p></td></tr><tr height="156.00px"><td><p class="CellBody" id="1386652" style="font-kerning:normal;">Suggested use</p></td><td><p class="bullet___cell" id="1386654"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Low multicast bandwidth</p><p class="bullet___cell" id="1387394"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Many sources and few receivers</p></td><td><p class="bullet___cell" id="1387300"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>&#160;&#160;&#160;High multicast bandwidth</p><p class="bullet___cell" id="1387402"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Few sources and many receivers</p><p class="CellBody" id="1387302"><br/></p></td><td><p class="bullet___cell" id="1387371"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>&#160;&#160;&#160;When root bridge is source or receiver of most multicast traffic and congruency is not required.</p><p class="bullet___cell" id="1387410"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When required to interoperate with third&#x2D;party equipment</p></td></tr></table></div></span></p><p class="figure_title" id="1387431">Multicast Replication Modes and Suggested Uses</p><p class="heading2" id="1120476"><a id="XREF_16431__SPB_Services163" name="XREF_16431__SPB_Services163">SPB Services</a></p><p class="text" id="1124526"><a id="163_text_1124526" name="163_text_1124526"></a>The SPBM network topology consists of two layers&#x3A;</p><p class="bullet" id="1134879"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">The backbone infrastructure (control plane) layer</span>. ISIS&#x2D;SPB builds the backbone layer by defining loop&#x2D;free, shortest path trees (SPTs) through the backbone network (see <a  href="#XREF_70872__SPBM_Shortest_Path_Trees163" style="color:#0000ff;background-color:transparent;">SPBM Shortest Path Trees</a> for more information). </p><p class="bullet" id="1134884"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">The services (data plane) layer</span>. <a id="index_1135445" name="index_1135445"></a><a data-indexterm="Shortest%20Path%20Bridging:services" id="Shortest_Path_Bridging_services" name="Shortest_Path_Bridging_services"></a><a data-indexterm="Provider%20Backbone%20Bridge:SPB%20services" id="Provider_Backbone_Bridge_SPB_services" name="Provider_Backbone_Bridge_SPB_services"></a>The service layer is based on the Provider Backbone Bridging (PBB) framework as defined in the IEEE 8&#x30;2.1ah standard. SPBM supports the 8&#x30;2.1ah MAC&#x2D;in&#x2D;MAC method for data encapsulation. SPBM services transport the encapsulated traffic over the ISIS&#x2D;SPB infrastructure.</p><p class="text" id="1124530">The SPB service layer framework is comprised of the following components&#x3A;</p><p class="bullet" id="1124531"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Backbone Edge Bridge (BEB)</span>. An OmniSwitch is considered a BEB if the switch is SPB capable and at least one service access point (SAP) and one SPB interface is configured on the switch. The BEB marks the boundary between the customer network and the PBB network (PBBN). </p><p class="bullet" id="1123844"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Backbone Core Bridge (BCB)</span>. An OmniSwitch is considered a BCB if the switch is SPB capable and no SAPs are configured but at least one SPB interface is configured on the switch to forward encapsulated SPBM network traffic. Note that the requirement for configuring a BCB is based on whether or not the network topology includes a transit bridge.</p><p class="bullet" id="1123845"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Service Instance Identifier (I&#x2D;SID)</span>. Configured only on a BEB, this component identifies a backbone service instance that will tunnel the encapsulated data traffic through the PBBN between BEBs. The I&#x2D;SID is bound to a BVLAN ID and a Service Manager SPB service ID when the service is created.</p><p class="bullet" id="1123846"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Access Port</span>. A port or link aggregate configured as an SPB access port. This type of port is configured on the BEBs and defines the point at which traffic from other provider networks or directly from customer networks enters the PBBN. The access port is also associated with a Layer 2 profile that specifies how to process protocol control frames received on the port</p><p class="bullet" id="1128859"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Service Access Point (SAP)</span>&#x2014;A SAP is a logical service entity (also referred to as a virtual port) that is configured on a BEB to bind an access port to an SPB service ID and specify the type of customer traffic ((untagged, single&#x2D;tagged, double&#x2D;tagged, or all) to encapsulate and tunnel through the PBBN.</p><p class="bullet" id="1124519"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">SPB Interface (Network Port)&#x2014;</span>A port or link aggregate configured as an SPB interface that resides on either a BEB or a BCB and connects to the backbone network. Network ports carry customer traffic encapsulated in 8&#x30;2.1ah frames and are associated with all BVLANs on the switch. Customer traffic ingressing on a network port is switched to another network port (on BCBs) or to an access port (on BEBs).</p><p class="text" id="1123973">Once the ISIS&#x2D;SPB infrastructure and the SPB service&#x2D;based architecture is defined, the following service components are dynamically created by the <span data-keyref="OmniSwitch">OmniSwitch</span>. No user&#x2D;configuration is required.</p><p class="bullet" id="1123962"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Service Distribution Point (SDP)</span>&#x2014;An SDP provides a logical point at which customer traffic is directed from one BEB to another BEB. SDPs are used to set up distributed services, which consist of at least one SAP on a local node, one SAP on a remote node, and an SDP binding the service on both nodes. </p><p class="bullet" id="1124599"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">SDP Bind</span>&#x2014;An SDP binding represents the binding of an SPB service instance to an SDP. The SDP then distributes the service connectivity to other BEBs through the ISIS&#x2D;SPB shortest path trees. </p><p class="heading2" id="1124775"><a id="XREF_23286__Sample_SPBM_Network_Topology163" name="XREF_23286__Sample_SPBM_Network_Topology163">Sample SPBM Network Topology</a></p><p class="text" id="1125231"><a id="163_text_1125231" name="163_text_1125231"></a>The following diagram provides a <a id="index_1135446" name="index_1135446"></a><a data-indexterm="Shortest%20Path%20Bridging:topology%20example" id="Shortest_Path_Bridging_topology_example" name="Shortest_Path_Bridging_topology_example"></a>sample SPBM network topology that shows how the SPBM service and ISIS&#x2D;SPB backbone layers work together to basically extend (or virtualize) customer traffic across a Provider Backbone Bridge Network (PBBN)&#x3A;<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_97.svg" height="479.912191" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1125722">Figure 7&#x2D;5 &#x3A;  Sample SPBM Network</p><p class="text" id="1130004">In this sample SPBM topology&#x3A;</p><p class="bullet" id="1123835"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The packet flow for Customer A frames tagged with VLAN 1&#x30; is shown as a typical example. These frames are mapped to an SPB service that represents a binding of I&#x2D;SID 5&#x30;&#x30; to BVLAN 4&#x30;&#x30;1. The path for this binding is shown in green.</p><p class="bullet" id="1130894"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An additional path, shown in blue, is for another SPB service that represents a binding of I&#x2D;SID 5&#x30;1 to BVLAN 4&#x30;&#x30;2. This provides an example of how adding an additional BVLAN and service configuration to the topology can provide an alternate service path for other traffic from the same customer or traffic from a completely different customer. </p><p class="bullet" id="1130886"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB BVLAN 4&#x30;&#x30;1 and 4&#x30;&#x30;2 are created and assigned to ECT ID 1 and 2, respectively, on every switch (BEBs and BCBs) in the topology. These BVLANs serve as the transport entity on which ISIS&#x2D;SPB builds the shortest path trees and SPB services tunnel data. </p><p class="bullet" id="1125261"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The switch ports connecting each SPB switch with the next&#x2D;hop SPB switch are configured as SPB interface ports. This type of port is used to forward ISIS&#x2D;SPB control packets and serves as a network port for tunneling encapsulated traffic through SPB services. </p><p class="bullet" id="1130939"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The service access points (SAPs) created on BEB&#x2D;1 and BEB&#x2D;2 determine which frames from Customer A are accepted on the SAP port, where they are then encapsulated and mapped to the associated service. Other SAPs exist on these switches for the other service path. </p><p class="bullet" id="1125870"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When a frame tagged with VLAN 1&#x30; ingresses on port 1&#47;12, the frame is encapsulated in an 8&#x30;2.1ah header. The header specifies the BMAC for BEB&#x2D;1 as the B&#x2D;SA, the BMAC for BEB&#x2D;2 as the B&#x2D;DA, the SAP I&#x2D;SID (5&#x30;&#x30;), and the SAP BVLAN (4&#x30;&#x30;1). </p><p class="bullet" id="1125898"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>All other frames ingressing on SAP 1&#47;12&#x3A;1&#x30; that are not tagged with VLAN 1&#x30; are dropped, unless there are other SAPs configured for that port that will classify those frames.</p><p class="bullet" id="1125905"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The encapsulated frame is then forwarded along the BVLAN 4&#x30;&#x30;1 shortest path tree (SPT) to BEB&#x2D;2, where the 8&#x30;2.1ah header is stripped off and the frame is forwarded to the appropriate destination port.</p><p class="bullet" id="1125920"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The entire process for encapsulating and tunneling customer frames is the same for frames ingressing on port 2&#47;1 of BEB&#x2D;2 destined for BEB&#x2D;1.</p><p class="heading3" id="1123828">How it Works</p><p class="bullet" id="1125738"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>There is one instance of ISIS&#x2D;SPB supported in the backbone topology. This instance is activated once the BVLANs and SPB interfaces are created and the administrative status of ISIS&#x2D;SPB is enabled for each switch. </p><p class="bullet" id="1125739"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When ISIS&#x2D;SPB is administratively enabled on each switch, all the configured SPB interfaces start to advertise Hello packets to discover and establish adjacencies with other SPB switches. </p><p class="bullet" id="1125755"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Once adjacencies are established, link state packets (LSPs) are generated with SPB&#x2D;specific TLVs and shortest path trees from each switch to all other switches are calculated. </p><p class="bullet" id="1125741"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Each SPB switch learns the backbone MAC (BMAC) address and associated BVLAN IDs of every SPB switch in the network and stores that information in a local forwarding database. The BMAC address is the bridge MAC address of the switch and is advertised by ISIS&#x2D;SPB as the System ID.</p><p class="bullet" id="1125742"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>ISIS&#x2D;SPB then informs Service Manager of the reachability of the BMAC&#47;BVLAN combinations. This information is used to automatically create a service distribution point (SDP) between the same BVLAN on each BEB. </p><p class="bullet" id="1125760"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When ISIS&#x2D;SPB receives advertisement of a service instance identifier (I&#x2D;SID) from a remote BEB that matches an I&#x2D;SID created on the local switch, the SDP (BMAC&#47;BVLAN) of the remote BEB is bound to the I&#x2D;SID. The binding of a service to an SDP is referred to as a mesh SDP. </p><p class="bullet" id="1136159"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Basically, an SDP is a dynamically created logical entity that distributes service connectivity to other BEBs through the ISIS&#x2D;SPB shortest path trees.When customer frames are then classified into a specific SAP, the frames are encapsulated and tunneled through the mesh SDP (service&#47;SDP bind) associated with that SAP.</p><p class="text" id="1288878">For CLI configuration examples, see <a  href="#XREF_34328__Quick_Steps_for_Configuring_Service-Based_VLAN_Stacking163" style="color:#0000ff;background-color:transparent;">Quick Steps for Configuring SPBM</a>.</p><p class="heading2" id="1348614"><a id="XREF_22820__SPBM_Pseudo-Wire_(E-LINE_Transparent)_Service163" name="XREF_22820__SPBM_Pseudo-Wire_(E-LINE_Transparent)_Service163">SPBM Pseudo&#x2D;Wire (E&#x2D;LINE Transparent) Service</a></p><p class="text" id="1349704"><a id="163_text_1349704" name="163_text_1349704"></a>The <span data-keyref="OmniSwitch">OmniSwitch</span> implementation of Shortest Path Bridging provides customers at various sites with a multipoint&#x2D;to&#x2D;multipoint (E&#x2D;LAN) connectivity solution. When an SPB backbone service instance (I&#x2D;SID) is created on a BEB, SDP tunnels are automatically created with other BEBs on which the same I&#x2D;SID is configured. This results in a full mesh of connectivity between the BEBs that provides any&#x2D;to&#x2D;any connectivity for the service traffic on the I&#x2D;SID. However, as the number of users increases, so does the number of MAC addresses that are dynamically learned to minimize the amount of traffic flooding in the network. </p><p class="text" id="1349958">To help reduce the use of system resources and prevent MAC address explosion, an SPB service can be configured as a pseudo&#x2D;wire type of service to provide a single point&#x2D;to&#x2D;point (E&#x2D;LINE) connection between two SAP attachment points. The attachment points to customer edge (CE) devices can be between two local SAPs associated with the same service or between two SAPs across the SPB network, as shown in the following diagram&#x3A;<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_106.svg" height="234.686768" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1350347">Figure 7&#x2D;6 &#x3A;  Local and Remote SPB Pseudo&#x2D;Wire Connections</p><p class="text" id="1351126">An SPB pseudo&#x2D;wire service reduces the number of customer MAC addresses learned and simplifies the flow of user traffic, as follows&#x3A;</p><p class="bullet" id="1351435"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Packets are transparently forwarded (MAC addresses are not learned) between two local SAPs.</p><p class="bullet" id="1351590"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Packets from one SAP are encapsulated and transparently forwarded out of the SPB service network port.</p><p class="bullet" id="1351725"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The encapsulation is removed from packets received from the SPB network port and are transparently forwarded out of the SAP.</p><p class="bullet" id="1351920"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>MAC address learning is automatically disabled, since there is no forwarding decision to be made. Packets entering one SAP attachment point will simply egress the other SAP attachment point of the pseudo&#x2D;wire unchanged.</p><p><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Flooding and replication is not necessary since only two virtual ports are involved (SAP to SAP for a local service or SAP to a network port for the same service instance across the SPB backbone).<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="54.00px"><td><p class="CellBody_note_text" id="1352464"><span class="Times_Bold">Note.  </span>When a pseudo&#x2D;wire service connects two remote SPB nodes across the SPB backbone network, the ISIS&#x2D;SPB control protocol still advertises the I&#x2D;SID of the pseudo&#x2D;wire service to each node to maintain the virtual connectivity between the two nodes.</p></td></tr></table></div></p><p class="text" id="1351149">For more information and configuration examples, see <a  href="#XREF_26657__Configuring_an_SPB_Pseudo-Wire_Service163" style="color:#0000ff;background-color:transparent;">Configuring an SPB Pseudo-Wire Service</a> and <a  href="#XREF_86413__SPB_Pseudo-Wire_Configuration_Example163" style="color:#0000ff;background-color:transparent;">SPB Pseudo-Wire Configuration Example</a>.</p><p class="heading2" id="1188335"><a id="XREF_76050__Remote_Fault_Propagation_for_SPBM_Services163" name="XREF_76050__Remote_Fault_Propagation_for_SPBM_Services163">Remote Fault Propagation for SPBM Services</a></p><p class="text" id="1189081"><a id="163_text_1189081" name="163_text_1189081"></a>When a point&#x2D;to&#x2D;point connection is emulated with a Layer 2 SPB service, it is necessary to propagate connectivity faults from one end of the service tunnel to the other end. This allows a locally connected device to detect a connectivity fault in the SPB service and take action (such as enable a redundant link or send a trap) in response to the detected fault. Remote Fault Propagation (RFP) for SPB provides this type of fault detection and propagation from one end of an SPB service to the other.</p><p class="text" id="1188337">The RFP functionality is applied to the SPBM service (data plane) layer. Connectivity fault events are propagated into an SPB Service Access Point (SAP). A SAP is associated with an SPB access port and a service instance identifier (I&#x2D;SID). When a SAP port goes down, the SAP port on the other end of the service is also brought down. Without the RFP for SPB feature, the other end would continue to transmit packets waiting for a response. </p><p class="text" id="1188370">Ethernet OAM messaging is used to detect a failed condition and propagate the fault. An OAM Continuity Check Message (CCM) is sent at specified intervals between SAPs to advertise the status of SAP components (such as the SPB access port and I&#x2D;SID information).</p><p class="text" id="1155149">This implementation of RFP for SPB involves setting up the following components&#x3A;</p><p class="bullet" id="1155356"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An underlying SPB network infrastructure. RFP will monitor SPB access ports, which are bound to SAPs. A SAP consists of an access port, SPB service ID, and an encapsulation value (the VLAN tags that the SAP will process on the access ports).</p><p class="bullet" id="1155640"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An RFP domain, which consists of local maintenance end points (MEPs) with remote end point lists that are assigned to the same RFP domain ID. </p><p class="bullet_sub" id="1162788"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A local MEP defines the RFP domain parameters, such as the RFP domain ID, level, and CCM interval. An ID number is assigned to the local MEP to identify the local switch as a participant in an RFP OAM domain. </p><p class="bullet_sub" id="1162796"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A remote end point list identifies the SPB services to monitor and the remote end points (the MEP IDs of remote switches) to which the status of the services is advertised. Configuring the remote end point list of an RFP domain triggers the sending of CCM packets.</p><p class="bullet" id="1155740"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A reserved Ethernet OAM domain to which the RFP domain is mapped. When the local MEP of an RFP domain is configured, an OAM domain is automatically created based on the parameters specified when the local RFP MEP was created. </p><p class="text" id="1156815">The following diagram shows how RFP works in a sample SPBM network topology&#x3A;</p><p class="text" id="1160947"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_124.svg" height="311.911560" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1157336">Figure 7&#x2D;7 &#x3A;  <a id="XREF_88332_%11RFP_in_a_Sample%11SPBM%11Network163" name="XREF_88332_%11RFP_in_a_Sample%11SPBM%11Network163">RFP in a Sample SPBM Network</a></p><p class="text" id="1154029"><a id="163_text_1154029" name="163_text_1154029"></a>In this sample SPBM topology&#x3A;</p><p class="bullet" id="1161726"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An RFP local MEP and a remote end point list are configured on each Backbone Edge Bridge (BEB). Both are assigned to the same RFP domain ID on each BEB to identify the end points as participating members of the RFP domain.</p><p class="bullet" id="1161627"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Each local MEP is assigned an ID number, which is used as the virtual UP MEP ID. In this example, the virtual UP MEP ID is 1 for BEB&#x2D;1, 2 for BEB&#x2D;2, 3 for BEB&#x2D;3, and 4 for BEB&#x2D;4.</p><p class="bullet" id="1162002"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Each remote end point list specifies the SPB services to monitor and the MEP IDs of remote BEBs to which the status of the services is advertised. For example, the remote end point list on BEB&#x2D;1 contains the monitored SPB services and local MEP IDs for BEB&#x2D;2, BEB&#x2D;3, and BEB&#x2D;4.</p><p class="bullet" id="1160126"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The remote end point list binds an SPB service ID to the RFP domain. The service ID is associated with a service instance identifier (I&#x2D;SID) and a SAP, which identifies the SPB service instance and access port to monitor. For example, on the BEB&#x2D;2 switch, the status of I&#x2D;SID 15&#x30;&#x30; on access port 2&#47;1 is monitored and advertised to BEB&#x2D;1.</p><p class="bullet" id="1159063"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>CCM packets transmitted on the RFP domain advertise I&#x2D;SID and access port status information for the local SAP. The SAP information to advertise is identified through the SPB service ID that is associated with the RFP domain. For example, BEB&#x2D;1 and BEB&#x2D;2 both advertise the status of SAP port 1&#47;1 and SAP port 2&#47;1 for I&#x2D;SID 15&#x30;&#x30;. The same SPB service ID is mapped to each of these SAPs, which means the same I&#x2D;SID is mapped to each of these SAPs.</p><p class="bullet" id="1159751"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When port 2&#47;1 goes down on BEB&#x2D;2, the service represented by I&#x2D;SID 15&#x30;&#x30; stops transmitting. The CCM packets transmitted between BEB&#x2D;2 and BEB&#x2D;1 detect and advertise the port down fault. This causes BEB&#x2D;1 to administratively down port 1&#47;1 in response to the fault condition.</p><p class="text" id="1184790">For an example of the CLI configuration for this sample deployment of RFP in an SPB network, refer to the<a  href="#XREF_35424__RFP_for_SPB_Configuration_Example163" style="color:#0000ff;background-color:transparent;">RFP for SPB Configuration Example</a>.</p><p class="heading3" id="1166752">Customized CCM Packets</p><p>The CCM packets transmitted between RFP end points contain a proprietary OUI TLV that provides link fault information for the SPB services that are monitored by the RFP domain. The following shows an example of the proprietary TLV format&#x3A;<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="144.00px"/><col width="144.00px"/><col width="288.00px"/><tr height="135.33px"><td style="border-left-width:0.5pt;border-left-style:solid;border-left-color:#000000;border-right-width:0.5pt;border-right-style:solid;border-right-color:#000000;"><p class="CellBody" id="1164451"><br/></p><p class="CellBody" id="1164464"><br/></p><p class="CellBody" id="1164466"><br/></p><p class="CellBody" id="1164468" style="text-align:center;">Type &#x3D; 127</p></td><td style="border-left-width:0.5pt;border-left-style:solid;border-left-color:#000000;border-right-width:0.5pt;border-right-style:solid;border-right-color:#000000;"><p class="CellBody" id="1164453"><br/></p><p class="CellBody" id="1164472"><br/></p><p class="CellBody" id="1164474"><br/></p><p class="CellBody" id="1164476" style="text-align:center;">Length</p></td><td style="border-left-width:0.5pt;border-left-style:solid;border-left-color:#000000;border-right-width:0.5pt;border-right-style:solid;border-right-color:#000000;"><p class="CellBody" id="1164455" style="margin-left : 7.20pt;text-indent : 0.00pt;">OUI MAC &#x3D;&#x3D; Alcatel OUI (3 octet)</p><p class="CellBody" id="1164456"><br/></p><p class="CellBody" id="1164457" style="margin-left : 7.20pt;text-indent : 0.00pt;">Information about ISID, Portstate</p><p class="CellBody" id="1164458" style="margin-left : 7.20pt;text-indent : 0.00pt;">ISID           24 bit value       (3 octet)</p><p class="CellBody" id="1164459" style="margin-left : 7.20pt;text-indent : 0.00pt;">Port state    (UP&#47;STATE)    (1 octet)</p><p class="CellBody" id="1164460"><br/></p><p class="CellBody" id="1164461" style="margin-left : 7.20pt;text-indent : 0.00pt;">The above information is repeated if there are multiple I&#x2D;SIDs.</p></td></tr></table></div></p><p class="bullet" id="1168823"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>OAM unicast CCM packets are sent without Provider Backbone Bridge (PBB) header encapsulation across the SPBM network to each remote BEB device on the control B&#x2D;VLAN.</p><p class="bullet" id="1168824"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Only information related to the I&#x2D;SID associated with the remote BEB is sent in the proprietary TLV.</p><p class="bullet" id="1168825"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>OAM packets are filtered on the SPB SDP interfaces to capture only the CCM packets used for RFP monitoring.</p><p class="bullet" id="1168826"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Only CCM information will be processed for the related I&#x2D;SID information on the receiving switch.</p><p class="heading3" id="1164138">Fault Detection</p><p class="text" id="1168897">Each BEB in the RFP domain will check the I&#x2D;SID and port state information contained in the received CCM packets. </p><p class="bullet" id="1169074"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If any port state has transitioned from up to down, the local SAP port associated with the same I&#x2D;SID is also brought down as a port violation. </p><p class="bullet" id="1169082"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When a CCM indicates that the downed port has transitioned back to an up state, the local port violation is cleared. </p><p class="bullet" id="1168869"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>After a port violation is cleared, a 1&#x30; second timer is started to avoid bringing down the local ports immediately. This allows for the scenario in which a port violation is manually cleared on one BEB and by the time the violation is cleared on another BEB, a CCM packet from the other BEB is received with SAP port down information.</p><p class="bullet" id="1168870"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If a BEB device goes down, the information about the BEB will time out on remote BEB devices after 3 multiplied by the value of the CCM interval (3&#x2A;CCM interval value). For example, if the CCM interval value is set to 1&#x30;&#x30;ms, a remote BEB will wait 3&#x30;&#x30;ms before timing out the information about the BEB that went down. The local physical SAP access port mapped to the I&#x2D;SID that timed out is then brought down as well.</p><p class="text" id="1169962">For more information and CLI configuration examples, see <a  href="#XREF_32410__Configuring_Remote_Fault_Propagation_for_SPBM163" style="color:#0000ff;background-color:transparent;">Configuring Remote Fault Propagation for SPBM</a> and <a  href="#XREF_35424__RFP_for_SPB_Configuration_Example163" style="color:#0000ff;background-color:transparent;">RFP for SPB Configuration Example</a>.</p><p class="text" id="1269636">For more information about Ethernet OAM, see <a href="../n_ethoam/n_ethoam.htm#XREF_91998__1_Server_Management268" style="color:#0000ff;background-color:transparent;">Chapter&#160;42&#44; Configuring Ethernet OAM.</a></p><p class="heading2" id="1269638"><a id="XREF_21917__IP_over_SPB-M163" name="XREF_21917__IP_over_SPB-M163">IP over SPBM</a></p><p class="text" id="1269639"><a id="163_text_1269639" name="163_text_1269639"></a>The <span data-keyref="OmniSwitch">OmniSwitch</span> implementation of SPBM provides L2 VPN capability that bridges L2 customer LAN segments. Customer edge (CE) devices form peers and exchange routing information, as well as perform the necessary IP forwarding. Then the SPBM BEBs bridge the already routed IP traffic across the SPBM backbone.</p><p class="text" id="1136167">In addition to L2 VPN, the <span data-keyref="OmniSwitch">OmniSwitch</span> also provides an IP over SPBM capability that consolidates the routing functionality of CE devices into the BEB devices. The Virtual Routing and Forwarding (VRF) instances on different BEBs are tied together via backbone I&#x2D;SIDs across the same SPBM backbone that is used to support Layer 2 VPNs.</p><p class="text" id="1136168">The <span data-keyref="OmniSwitch">OmniSwitch</span> IP over SPBM solution supports two methods for combining L3 routing and L2 SPBM in the same switch&#x3A; VPN&#x2D;Lite and L3 VPN.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="54.00px"><td><p class="CellBody_note_text" id="1250541"><span class="Times_Bold">Note.  </span>The term &#x201c;IP over SPBM&#x201d; refers to both IPv4 and IPv6 over SPBM. If there are any differences between the implementation of IPv4 over SPBM and IPv6 over SPBM, an explicit reference to IPv4 or IPv6 is made.</p></td></tr></table></div></p><p class="heading3" id="1136169">VPN&#x2D;Lite</p><p class="text" id="1136170">The VPN&#x2D;Lite method provides a gateway between a regular SPBM service and a router within the same <span data-keyref="OmniSwitch">OmniSwitch</span> chassis. This solution provides a specific advantage in that it allows a single box to represent two tiers in a typical fat&#x2D;tree network, which is popular in data center deployments. </p><p class="text" id="1136399">In addition, a VPN&#x2D;Lite configuration can act purely as an L3 VPN when configured correctly. In this mode, existing routing protocols can form adjacencies across the SPBM PBB network. To keep it purely an L3 VPN, the administrator makes sure that no SPBM SAPs that can inject bridged flows are allowed to attach to the I&#x2D;SID designated for the specific VPN.</p><p class="text" id="1136400">The VPN&#x2D;Lite approach uses the SPBM network in the same way a VLAN is used for transporting L3 frames. Each BEB or host can inject frames into the I&#x2D;SID as needed, and BEBs can decide to bridge or route those frames based on their inner and outer destination MAC address.</p><p class="heading3" id="1136173">L3 VPN (ISIS&#x2D;SPB)</p><p class="text" id="1136174">When the L3 VPN method is implemented, the <span data-keyref="OmniSwitch">OmniSwitch</span> acts as an access or edge router to multiple VRFs and connects these VRFs across an SPBM PBB network. Each VPN is identified by a local VRF instance on each BEB and globally in the backbone by an I&#x2D;SID in the PBB header. ISIS&#x2D;SPB will import and export routes from the local routing protocols running inside their respective VRFs. In essence, ISIS&#x2D;SPB is creating tunnels between BEBs through which routed frames are sent to reach their target networks.</p><p class="text" id="1216808">The <span data-keyref="OmniSwitch">OmniSwitch</span> L3 VPN solution is based on the IETF drafts <span class="Times_italics" style="font-style:Italic;background-color:transparent;">IP&#47;IPVPN services with IEEE 8&#x30;2.1aq SPB(B) networks</span> and uses IS&#x2D;IS TLVs to exchange routes between the BEBs that host the same VPN services. This approach also gives an administrator the ability to build VPNs and extend them over an SPBM core.</p><p class="heading3" id="1226410"><a id="XREF_95519__L3_VPN_Interface163" name="XREF_95519__L3_VPN_Interface163">L3 VPN Interface</a></p><p class="text" id="1318624"><a id="163_text_1318624" name="163_text_1318624"></a>An L3 VPN interface serves as an IP gateway to access remote networks and is required when using either the VPN&#x2D;Lite or L3 VPN method.</p><p class="heading4" id="1343719"><a id="XREF_72523__Supported_L3_VPN_Interface_Options163" name="XREF_72523__Supported_L3_VPN_Interface_Options163">Supported L3 VPN Interface Options</a></p><p>The following available options for defining an L3 VPN interface are based on the switch platform.<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="211.20px"/><col width="105.60px"/><col width="139.20px"/><col width="120.00px"/><thead><tr height="62.00px"><th><p class="CellHeading" id="1343722" style="text-align:center;"><a id="163_CellHeading_1343722" name="163_CellHeading_1343722"></a>Switch</p></th><th><p class="CellHeading" id="1381122" style="text-align:center;">Inline Routing</p><p class="CellHeading" id="1381123" style="text-align:center;">Service&#x2D;Based</p><p class="CellHeading" id="1343726" style="text-align:center;">(Single Pass)</p></th><th><p class="CellHeading" id="1343728" style="text-align:center;">Inline Routing</p><p class="CellHeading" id="1343729" style="text-align:center;">Front&#x2D;Panel Ports</p><p class="CellHeading" id="1343730" style="text-align:center;">(Two Pass; No Cable)</p></th><th><p class="CellHeading" id="1343732" style="text-align:center;">External Loopback Cable</p><p class="CellHeading" id="1343733" style="text-align:center;">(Two&#x2D;Pass)</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1343738"><span data-keyref="Platforms Supported_OS6860">OmniSwitch 6860</span></p></td><td><p class="CellBody" id="1343740" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343742" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343744" style="text-align:center;">Yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1343749"><span data-keyref="Platforms Supported_OS6860N">OmniSwitch 6860N</span>&#x2A;</p></td><td><p class="CellBody" id="1343751" style="text-align:center;">Yes</p></td><td><p class="CellBody" id="1343753" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343755" style="text-align:center;">Yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1343760"><span data-keyref="Platforms Supported_OS6865">OmniSwitch 6865</span></p></td><td><p class="CellBody" id="1343762" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343764" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343766" style="text-align:center;">Yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1343771"><span data-keyref="Platforms Supported_OS6900">OmniSwitch 6900</span></p></td><td><p class="CellBody" id="1343773" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343775" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343777" style="text-align:center;">Yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1343793"><span data-keyref="Platforms Supported_OS6900-V72/C32">OmniSwitch 6900-V72&#47;C32</span></p></td><td><p class="CellBody" id="1343795" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343797" style="text-align:center;">Yes</p></td><td><p class="CellBody" id="1343799" style="text-align:center;">Yes</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1343815"><span data-keyref="Platforms Supported_OS6900-X48C6/X48C4E/T48C6/V48C8/C32E">OmniSwitch 6900-X48C6&#47;X48C4E&#47;T48C6&#47;V48C8&#47;C32E</span>&#x2A;</p></td><td><p class="CellBody" id="1343817" style="text-align:center;">Yes</p></td><td><p class="CellBody" id="1343819" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343821" style="text-align:center;">Yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1343826"><span data-keyref="Platforms Supported_OS9900">OmniSwitch 9900</span></p></td><td><p class="CellBody" id="1343828" style="text-align:center;">Yes</p></td><td><p class="CellBody" id="1343830" style="text-align:center;">No</p></td><td><p class="CellBody" id="1343832" style="text-align:center;">Yes</p></td></tr></table></div></p><p class="Indented" id="1381255">&#x2A; The availability of switch resources (such as the number of Layer 3 interfaces, next hops, etc.) is reduced to support service&#x2D;based inline routing. See <a  href="#XREF_17772__L3_VPN_Inline_Routing_Interface_(OmniSwitch_9900)163" style="font-kerning:none;color:#0000ff;background-color:transparent;">L3 VPN Interface&#58; Inline Routing (Service-Based IP Interface)</a> for more information.</p><p class="heading4" id="1343835"><a id="XREF_68509__In-line_Routing163" name="XREF_68509__In-line_Routing163">L3 VPN Interface&#x3A; Inline Routing</a></p><p class="text" id="1263667"><a id="163_text_1263667" name="163_text_1263667"></a>The following methods for defining an L3 VPN inline routing interface are supported&#x3A;</p><p class="bullet" id="1333941"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Service based inline routing.</span> This method processes encapsulated SPB and IP packets in a single&#x2D;pass through an IP interface that is bound to an SPB service. The L3 VPN interface is defined by configuring an IP service&#x2D;based interface within a VRF instance. This connects routes within the VRF instance to an SPB service instance (I&#x2D;SID).</p><p class="bullet" id="1334397"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Front&#x2D;panel port inline routing</span>. This method utilizes front&#x2D;panel ports to implement two&#x2D;pass processing of encapsulated SPB and IP packets. The L3 VPN interface is defined by configuring a loopback port that will forward traffic between an SPB service and VLAN domain. Loopback ports can also be combined into a static link aggregate.</p><p class="text" id="1335450">Using the inline routing mechanism simplifies the configuration in that a physical cable is not required to form an external loopback.</p><p class="text" id="1335451">The following diagram shows a logical depiction of an inline routing configuration that defines an L3 VPN service&#x2D;based interface&#x3A;</p><p class="text" id="1343870"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_134.svg" height="226.267904" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1268788">Figure 7&#x2D;8 &#x3A;  L3 VPN Interface&#x3A; Inline Routing (Service&#x2D;Based IP Interface)</p><p class="text" id="1318938">The following diagram shows a logical depiction of an inline routing configuration that defines an L3 VPN front&#x2D;panel port interface&#x3A;</p><p class="text" id="1348434"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_140.svg" height="219.486979" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1264314">Figure 7&#x2D;9 &#x3A;  L3 VPN Interface&#x3A; Inline Routing (Front&#x2D;Panel Ports)</p><p class="heading4" id="1264156">L3 VPN Interface&#x3A; External Loopback</p><p class="text" id="1319119">External loopback is a two&#x2D;pass processing mechanism that requires a physical cable to connect a regular port to a service access port. The regular port is tagged with an IP interface VLAN; the service access port is associated with an SPB Service Access Point (SAP). The VLAN&#x2D;based IP interface serves as the L3 VPN interface. </p><p class="text" id="1319120">A regular switch port or a static link aggregate can serve as a loopback port in an external loopback configuration. In addition, multiple loopback port pairs are allowed and can be shared between different VRFs. </p><p class="text" id="1230937">An L3 VPN loopback interface configuration consists of the following components&#x3A;</p><p class="bullet" id="1230938"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An IP interface created in a specific VRF instance and bound to a VLAN ID.</p><p class="bullet" id="1230939"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A regular switch port or link aggregate tagged with the IP interface VLAN.</p><p class="bullet" id="1230502"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A service access port that is assigned to an SPB SAP. The SAP encapsulation is configured with the VLAN ID that is tagged on the regular switch port or link aggregate.</p><p class="bullet" id="1230659"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical cable that connects the VLAN port with the service access port to form the loopback configuration.&#160;The service access port handles Layer 2 bridging into the service domain and the VLAN port handles the Layer 3 routing into the VLAN domain.</p><p class="text" id="1258830">The loopback configuration connects a VRF to an SPB SAP and can carry traffic from different VRFs tagged with different VLANs. The following diagram shows a logical depiction of an L3 VPN loopback interface&#x3A;<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_146.svg" height="231.944071" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1218344">Figure 7&#x2D;1&#x30; &#x3A;  L3 VPN Interface&#x3A; External Loopback</p><p class="heading3" id="1219524">How it Works</p><p class="text" id="1136923">This section describes the VPN&#x2D;Lite and L3 VPN control and data plane operations in an IP over SPB network configuration. Although both approaches use an L3 VPN interface configuration, they differ in how routing protocol control packets are exchanged and processed to support IP over SPB.</p><p class="heading4" id="1136932"><a id="XREF_10326__VPN-Lite_Control_Plane163" name="XREF_10326__VPN-Lite_Control_Plane163">VPN&#x2D;Lite Control Plane Operations</a></p><p class="text" id="1136931"><a id="163_text_1136931" name="163_text_1136931"></a>When routing protocols or static routes are running on the L3 VPN interface, the interface can exchange IP routes with other L3 VPN interfaces that are running the same routing protocols and are associated with the same I&#x2D;SID. By exchanging routes with other L3 VPN interfaces, VRFs on different BEBs can learn remote networks from each other.</p><p class="bullet" id="1238830"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If inline routing is used in this scenario, the routing protocol control packets are sent from the L3 VPN interface and carried on SDPs into the SPBM backbone. The control packets received from the SPBM backbone travel from SDPs to the VRF following the same process but in reverse.</p><p class="bullet" id="1136975"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If a physical loopback port configuration is used in this scenario, the routing protocol control packets sent from the L3 VPN interface travel though the tagged VLAN port, enter the service access port, where the packets are then distributed into different services by SAPs associated with the access port and carried on SDPs into the SPBM backbone. The control packets received from the SPBM backbone travel from SDPs to the VRF following the same process but in reverse. </p><p class="heading4" id="1137063">L3 VPN Control Plane Operations</p><p class="text" id="1137153">The ISIS&#x2D;SPB support of the IPVPN TLV, IPv4 sub&#x2D;TLV, and IPv6 sub&#x2D;TLV provides a different method for exchanging L3 routes between VRFs. Instead of running routing protocols on the L3 VPN interfaces, IP routes are imported into ISIS&#x2D;SPB from VRFs. ISIS&#x2D;SPB then carries these routes in the TLVs through the SPBM cloud to other SPBM BEBs. When ISIS&#x2D;SPB receives IPVPN TLVs from the cloud, ISIS&#x2D;SPB will export the routes to the appropriate VRFs. </p><p class="text" id="1139728">The L3 VPN approach implements the importing and exporting of routes between ISIS&#x2D;SPB and VRF instances and the transport of these routes using the supported TLVs. The administrator does not have to configure routing protocols on the L3 VPN interface. Implementing the L3 VPN approach requires careful consideration to avoid routing loops.</p><p class="heading4" id="1137069">VPN&#x2D;Lite and L3 VPN Data Plane Operations</p><p class="text" id="1137075">Data is moved in the same manner for both VPN&#x2D;Lite and L3 VPN traffic, and the existing data plane forwarding mechanisms for SPB and IP are used without modification&#x3A;</p><p class="bullet" id="1137076"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An L3 VPN interface serves as an IP gateway to access remote networks. The network administrator has to ensure the IP subnet reachability of the L3 VPN addresses on the same SPBM I&#x2D;SID.</p><p class="bullet" id="1137077"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>IPv4 L3 VPN interfaces use dynamic ARP and IPv6 L3 VPN interfaces use neighbor discovery to learn the MAC addresses of other L3 VPN interfaces and provide next&#x2D;hop forwarding information to the switch. </p><p class="bullet" id="1137085"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>IP data plane packets travel the same path as VPN&#x2D;Lite control packets (see <a  href="#XREF_10326__VPN-Lite_Control_Plane163" style="color:#0000ff;background-color:transparent;">VPN-Lite Control Plane Operations</a> for more information). </p><p class="bullet" id="1137094"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Data in the SPBM cloud is encapsulated into the Provider Backbone Bridge (PBB) format (see <a  href="#XREF_16431__SPB_Services163" style="color:#0000ff;background-color:transparent;">SPB Services</a> for more information).</p><p class="text" id="1291712">For more information and configuration examples, see <a  href="#XREF_26416__Configuring_IP_over_SPB163" style="color:#0000ff;background-color:transparent;">Configuring IP over SPB</a> and <a  href="#XREF_23405__Configuration_Examples163" style="color:#0000ff;background-color:transparent;">IP over SPB Configuration Examples</a>.</p><p class="heading2" id="1291715"><a id="XREF_79553__SPB_over_a_Shared_Network163" name="XREF_79553__SPB_over_a_Shared_Network163">SPB Over Shared Ethernet</a></p><p class="text" id="1329634"><a id="163_text_1329634" name="163_text_1329634"></a>By default, ISIS&#x2D;SPB operates over point&#x2D;to&#x2D;point (P2P) links which allows only one adjacency on an SPB network interface. However, an SPB network interface can be configured to allow multiple adjacencies to form on the interface. This is particularly useful for extending an SPB backbone over a shared Ethernet domain, such as a service provider network or even connect to another ISIS&#x2D;SPB domain.</p><p class="text" id="1329720">An SPB multiple access (multi&#x2D;access) network interface is configured on SPB Backbone Edge Bridges (BEBs) that connect directly to a shared network instead of to SPB Backbone Core Bridges (BCBs). Each BEB forms ISIS&#x2D;SPB adjacencies over the shared network with all the other BEBs on the multi&#x2D;access network interfaces.</p><p>Participating BEBs elect one of the multi&#x2D;access network interfaces to serve as the Designated Intermediate System (DIS). The DIS represents all of the multi&#x2D;access links as a virtual SPB node (pseudo&#x2D;node).<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="70.00px"><td><p class="CellBody_note_text" id="1345957"><span class="Times_Bold">Note.  </span>Software releases prior to AOS Release 8.7R1 do not process pseudo&#x2D;node LSPs. As a result, SPB nodes running such software may experience inconsistent connectivity to destinations beyond the shared Ethernet network segment. If such network reachability is desired, those SPB nodes must be upgraded to AOS Release 8.7R1.</p></td></tr></table></div></p><p class="text" id="1297839">The following diagram shows an example of an SPB backbone extended over a service provider network.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_152.svg" height="362.444702" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="585.943502"></object></p><p class="FigureTitle" id="1292476">Figure 7&#x2D;11 &#x3A;  <a id="XREF_91667__SPB_Backbone_over_a_Service_Provider_Network163" name="XREF_91667__SPB_Backbone_over_a_Service_Provider_Network163"></a>SPB Backbone over a Service Provider Network</p><p class="text" id="1292286">In order for the BEBs in this diagram to communicate, they need to form adjacencies with each of the other BEBs over the service provider network. This is not possible with a P2P configuration, so each SPB network interface port is configured as a multi&#x2D;access LAN interface to allow multiple adjacencies to form across the broadcast network domain.</p><p class="heading3" id="1293662">How it Works</p><p class="text" id="1299716">The manner in which the SPB network backbone is built on multi&#x2D;access interfaces is similar to how the network backbone is built on P2P interfaces. However, there are some differences.</p><p class="bullet" id="1295234"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Multi&#x2D;access interfaces exchange LAN Intermediate System&#x2D;to&#x2D;Intermediate System Hello (IIH) packets, which contain a priority value and a LAN ID (combination of System ID and a unique local Circuit ID); information that is not needed in P2P IIH packets.</p><p class="bullet" id="1295235"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>During the LAN IS&#x2D;IS Hello packet exchange, an election process is triggered to select a Designated Intermediate System (DIS) for the LAN. Election of the DIS is based on the highest interface priority, which can also be manually configured. In case of a tie, the router with the highest backbone MAC address (BMAC) for that interface is elected as the DIS. This process is similar to how ISIS&#x2D;IP operates in a multi&#x2D;access, broadcast network.</p><p class="bullet" id="1295781"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>After adjacencies are formed and the DIS is elected, link state packets (LSPs) are exchanged. To ensure efficient LSP exchange and minimize bandwidth usage, all multi&#x2D;access interfaces report their adjacencies to the DIS.</p><p class="bullet" id="1317088"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The DIS represents all of the multi&#x2D;access links as a virtual SPB node (pseudo&#x2D;node) to IS&#x2D;IS by generating a pseudo&#x2D;node LSP. This type of LSP contains a list of all the switches connected to the multi&#x2D;access network, including the DIS, that comprise the virtual SPB node.</p><p class="bullet" id="1300066"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The LSP database synchronization over multi&#x2D;access links differs somewhat from how the database is synchronized over P2P links as follows&#x3A;</p><p class="bullet_sub" id="1317302"><span class="bold">&#x2013;&#160;&#160;&#160; </span>P2P links synchronize the LSP database by sending a Complete Sequence Number PDUs (CSNP) once when an adjacency is initialized and before LSP exchange begins. LSPs are then exchanged over P2P links in a way that ensures that all LSPs sent over the link from one end to the other are received.</p><p class="bullet_sub" id="1317306"><span class="bold">&#x2013;&#160;&#160;&#160; </span>With multi&#x2D;access links, the DIS is responsible for synchronizing the LSP database across the shared network. On multi&#x2D;access links, CSNPs are flooded periodically by the DIS to coordinate database synchronization.</p><p class="bullet" id="1317307"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The DIS pseudo&#x2D;node LSP is used to calculate the shortest path tree over the multi&#x2D;access links. The regular LSP generated by each SPB node lists the pseudo&#x2D;node as its neighbor on multi&#x2D;access links; the pseudo&#x2D;node LSP lists all the other nodes as it neighbors on a multi&#x2D;access link. As a result, the shortest path between any two nodes on a multi&#x2D;access link goes through the DIS.</p><p class="bullet" id="1294914"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>ISIS&#x2D;SPB records a list of hops (SPB nodes) during the shortest path first (SPF) calculations from one node to the other. However, the SPB pseudo&#x2D;node is not counted in the list of hops, so it is not used as a tie breaker for ECMP calculations.</p><p class="text" id="1304174">To the rest of the network, the SPB multi&#x2D;access links are seen as a virtual node that is defined and represented by the DIS through pseudo&#x2D;node LSPs. The following diagram provides a logical depiction of how the SPB pseudo&#x2D;node<span class="blue_text" style="color:#0000ff;background-color:transparent;">&#160;</span>is interpreted by IS&#x2D;IS with a DIS&#x3A;</p><p class="text" id="1329776"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_158.svg" height="215.246521" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="411.545634"></object></p><p class="FigureTitle" id="1303410">Figure 7&#x2D;12 &#x3A;  Network Interpretation of SPB Pseudo&#x2D;Node</p><p class="text" id="1330290">For more information and configuration examples, see <a  href="#XREF_27091__Configuring_SPB_over_a_Multiple_Access_Domain163" style="color:#0000ff;background-color:transparent;">Configuring SPB Over Shared Ethernet</a> and <a  href="#XREF_63452__SPB_over_a_Multi-Access_Domain_Configuration_Examp163" style="color:#0000ff;background-color:transparent;">SPB Over Shared Ethernet Configuration Examples</a>.</p><p class="heading2" id="1362693"><a id="XREF_52604__SPB_In-Band_Management163" name="XREF_52604__SPB_In-Band_Management163">SPB In&#x2D;Band Management</a></p><p class="text" id="1362694"><a id="163_text_1362694" name="163_text_1362694"></a>In an SPBM network, Backbone Edge Bridges (BEBs) and Backbone Core Bridges (BCBs) can be directly managed within the SPBM bridging domain by configuring a single IP interface on a Control BVLAN. This avoids having to set up a separate VLAN domain to provide IP connectivity across the SPBM domain.</p><p class="text" id="1369136">In addition to configuring an IP interface on a Control BVLAN, use one of the following methods to advertise the reachability of the management network to the SPB nodes&#x3A;</p><p class="bullet_sub" id="1363755"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Configure static routes to route packets to destinations outside of the IP BVLAN subnet.</p><p class="bullet_sub" id="1363839"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Configure the redistribution of management network routes into ISIS&#x2D;SPB at one or more BEBs that connect to a management station. ISIS&#x2D;SPB then advertises the management network routes, along with the locally configured IP Looback&#x30; address and IP BVLAN address, to all SPB nodes in the network.</p><p class="text" id="1365677">The redistribution of management network routes into ISIS&#x2D;SPB provides a simpler method for SPB in&#x2D;band management by not requiring the configuration of static routes on every SPB node.</p><p class="text" id="1362615">A BEB that connects to a management station on the customer side is referred to as a manager BEB. A managed SPB node is a BEB without management stations on the customer side or a BCB that does not access the customer side. The manager BEB serves as a gateway to the management networks.</p><p class="text" id="1362617">When a managed SPB node receives the advertised management network route information, the network route and the IP Looback&#x30; route are injected with the IP BVLAN address as the gateway into the management VRF instance as SPB management (SPB&#x2D;MGMT) routes. The managed SPB node then knows how to reach the manager BEB. In turn, the managed SPB node advertises its Loopback&#x30; address along with the already received IP BVLAN address, so that the manager BEB knows how to reach the managed SPB node.</p><p class="text" id="1368188">The following diagram shows an example of advertising reachability to management networks, SPB nodes, and remote switches by redistributing routes into ISIS&#x2D;SPB. </p><p class="bullet" id="1369090"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The management network routes are configured or learned on BEB&#x2D;1 and BEB&#x2D;3. The routes are then redistributed into ISIS&#x2D;SPB, which then propagates the management network route, the locally configured IP Looback&#x30; address, and the IP BVLAN address in an LSP that is sent to all SPB nodes in the network. </p><p class="bullet" id="1369112"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The receiving SPB nodes send the advertised information to the management VRF routing table. Persistent ARP entries are then added to map the sender&#x2019;s system MAC address to the sender&#x2019;s IP BVLAN interface address. All SPB nodes can now be accessed by the management stations.</p><p class="bullet" id="1369091"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>In addition, the route to a remote switch network is redistributed into ISIS&#x2D;SPB on BEB&#x2D;3 and then propagated to all SPB nodes. The learned SPB&#x2D;MGMT routes on BEB&#x2D;3 can then be redistributed into the remote network so that remote switches can also be managed.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_163.svg" height="457.777364" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="614.609945"></object></p><p class="FigureTitle" id="1373233">Figure 7&#x2D;13 &#x3A;  <a id="XREF_55107__SPB_In-Band_Management_-_Route_Redistribution163" name="XREF_55107__SPB_In-Band_Management_-_Route_Redistribution163">SPB In&#x2D;Band Management &#x2D; Route Redistribution</a></p><p class="text" id="1372592"><a id="163_text_1372592" name="163_text_1372592"></a>In this sample SPB network configuration,</p><p class="bullet" id="1369075"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>On BEB&#x2D;1, route 128.251.1.&#x30;&#47;24 &#x2D;&#x3E; 2&#x30;.&#x30;.&#x30;.254 is installed and redistributed into SPB. BEB&#x2D;1 then advertises the following information to all of the other SPB nodes&#x3A;</p><p class="bullet_sub" id="1366510"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Management network route 128.251.1.&#x30;&#47;24.</p><p class="bullet_sub" id="1366539"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Loopback&#x30; route 1&#x30;.&#x30;.&#x30;.1&#47;32.</p><p class="bullet_sub" id="1366584"><span class="bold">&#x2013;&#160;&#160;&#160; </span>BVLAN IP address 1&#x30;&#x30;.&#x30;.&#x30;.1</p><p class="bullet" id="1366619"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>On BEB&#x2D;3, route 128.251.2.&#x30;&#47;24 &#x2D;&#x3E; 2&#x30;.&#x30;.&#x30;.253 is installed and redistributed into SPB. BEB&#x2D;3 then advertises the following information to all of the other SPB nodes&#x3A;</p><p class="bullet_sub" id="1366620"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Management network route 128.251.2.&#x30;&#47;24.</p><p class="bullet_sub" id="1366621"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Loopback&#x30; route 1&#x30;.&#x30;.&#x30;.3&#47;32.</p><p class="bullet_sub" id="1366622"><span class="bold">&#x2013;&#160;&#160;&#160; </span>BVLAN IP address 1&#x30;&#x30;.&#x30;.&#x30;.3</p><p class="bullet" id="1366178"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When the two BCBs and all the other BEBs receive the information advertised by BEB&#x2D;1 and BEB&#x2D;3, the following occurs&#x3A;</p><p class="bullet_sub" id="1367003"><span class="bold">&#x2013;&#160;&#160;&#160; </span>SPB routes 128.251.1.&#x30;&#47;24 &#x2D;&#x3E; 1&#x30;&#x30;.&#x30;.&#x30;.1 and 128.251.2.&#x30;&#47;24 &#x2D;&#x3E; 1&#x30;&#x30;.&#x30;.&#x30;.3 are installed.</p><p class="bullet_sub" id="1367105"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Routes 1&#x30;.&#x30;.&#x30;.1&#47;32 &#x2D;&#x3E; 1&#x30;&#x30;.&#x30;.&#x30;.1 and 1&#x30;.&#x30;.&#x30;.3&#47;32 &#x2D;&#x3E; 1&#x30;&#x30;.&#x30;.&#x30;.3 are installed.</p><p class="bullet_sub" id="1367182"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Static ARP entries are added to map 1&#x30;&#x30;.&#x30;.&#x30;.1 to the system MAC address of BEB&#x2D;1 and 1&#x30;&#x30;.&#x30;.&#x30;.3 to the system MAC address of BEB&#x2D;3.</p><p class="bullet" id="1366613"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>To manage the switch on a remote network accessed through BEB&#x2D;2, </p><p class="bullet_sub" id="1368066"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Route 3&#x30;.&#x30;.&#x30;.&#x30;&#47;24 &#x2D;&#x3E; 2&#x30;.&#x30;.&#x30;.252 is installed and redistributed into SPB. </p><p class="bullet_sub" id="1368072"><span class="bold">&#x2013;&#160;&#160;&#160; </span>BEB&#x2D;2 advertises the remote network route 3&#x30;.&#x30;.&#x30;.&#x30;&#47;24, the Loopback&#x30; route 1&#x30;.&#x30;.&#x30;.2&#47;32, and the BVLAN IP address 1&#x30;&#x30;.&#x30;.&#x30;.2 to all of the other SPB nodes.</p><p class="bullet_sub" id="1368075"><span class="bold">&#x2013;&#160;&#160;&#160; </span>BEB&#x2D;2 redistributes the learned SPB&#x2D;MGMT routes into the remote network.</p><p class="heading3" id="1369583">Configuring SPB In&#x2D;Band Management</p><p class="text" id="1370330">Consider the following guidelines when configuring SPB in&#x2D;band management access&#x3A;</p><p class="bullet" id="1369909"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A single IPv4 interface can be configured on a Control BVLAN to provide in&#x2D;band management access in the SPBM domain. When creating an IPv4 interface for a Control BVLAN, consider the following&#x3A;</p><p class="bullet_sub" id="1370163"><span class="bold">&#x2013;&#160;&#160;&#160; </span>ISIS&#x2D;SPB is the only protocol supported in the IP BVLAN domain for exchanging or advertising IP routing information. No other routing protocol (including VRRP) is supported. However, SPB&#x2D;MGMT routes can be redistributed into dynamic routing protocols.</p><p class="bullet_sub" id="1370270"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The IP interface is considered operationally active when the underlying Control BVLAN becomes operationally up and all the underlying configuration is considered valid.</p><p class="bullet_sub" id="1370280"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Multi&#x2D;netting of IP interfaces on a BVLAN is not supported. Only one IP interface per Control BVLAN is allowed.</p><p class="bullet_sub" id="1370285"><span class="bold">&#x2013;&#160;&#160;&#160; </span>STP is not allowed on BVLANs, and all broadcast packets will be restricted on this IP interface. As a result, explicit ARP&#47;ND resolution is not supported. ISIS&#x2D;SPB will provide the MAC&#x2D;to&#x2D;IP address mappings to avoid broadcast packets in the SPBM backbone domain.</p><p class="bullet_sub" id="1371375"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The IP BVLAN domain will operate in IP unicast mode; IP Multicast is not supported.</p><p class="bullet" id="1371801"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Any VRF instance can be used to redistribute management routes into ISIS&#x2D;SPB. However, only one VRF can be used and it must be the VRF where the management IP interface resides.</p><p class="bullet" id="1371706"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB management route information is represented as the protocol SPB&#x2D;MGMT, which is used as a source and destination protocol for route redistribution. For example, <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ip redist spb&#x2D;mgmt into ospf</span> or <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ip redist ospf into spb&#x2D;mgmt</span>. In addition, <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show</span> commands used to verify IP routing information and display SPB LSPs provide an <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb&#x2D;mgmt</span> parameter or include SPB&#x2D;MGMT information (see <a  href="#XREF_38099__Verifying_the_In-Band_Management_Configuration163" style="color:#0000ff;background-color:transparent;">Verifying the In-Band Management Configuration</a>).</p><p><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB&#x2D;MGMT routes are assigned a default route preference of 15&#x30;, which is configurable using the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ip route&#x2D;pref</span> command. Make sure this value does not conflict with the route preference configured for any other protocols.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="70.00px"><td><p class="CellBody_note_text" id="1371709"><span class="Times_Bold">Note.  </span>When using ISSU to upgrade the switch, ISSU will automatically change the SPB&#x2D;MGMT route preference to the next lowest value below 15&#x30; if there is a conflict with another protocol previously configured with the same route preference value. After an ISSU upgrade, use the <span class="Times_Bold" style="font-weight:Bold;font-kerning:none;background-color:transparent;">write memory</span> command to ensure any changes are retained.</p></td></tr></table></div></p><p class="heading4" id="1372097">Sample Command Configuration</p><p class="text" id="1372106">This section provides the sequence of commands used on each switch to configure in&#x2D;band management for the example shown in <a  href="#XREF_55107__SPB_In-Band_Management_-_Route_Redistribution163" style="color:#0000ff;background-color:transparent;">SPB In-Band Management - Route Redistribution</a>. </p><p class="text" id="1372420">BEB&#x2D;1&#x3A;</p><p class="screen" id="1373293">&#x2D;&#x3E; system name BEB&#x2D;1</p><p class="screen2" id="1373294">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373295">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="screen2" id="1373296">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="screen2" id="1373297">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="screen2" id="1373298">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373299">&#x2D;&#x3E; spb interface port 1&#47;1&#47;3</p><p class="screen2" id="1373300">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1373301">&#x2D;&#x3E; ip interface bvlan&#x2D;intf address 1&#x30;&#x30;.&#x30;.&#x30;.1 vlan 4&#x30;&#x30;1</p><p class="screen2" id="1373259">&#x2D;&#x3E; ip interface Loopback&#x30; 1&#x30;.&#x30;.&#x30;.1</p><p class="screen2" id="1373392">&#x2D;&#x3E; ip static&#x2D;route 128.251.1.&#x30;&#47;24 gateway 2&#x30;.&#x30;.&#x30;.254</p><p class="screen2" id="1373393">&#x2D;&#x3E; ip route&#x2D;map spb&#x2D;mgmt&#x2D;route sequence&#x2D;number 1&#x30; action permit</p><p class="screen2" id="1373394">&#x2D;&#x3E; ip route&#x2D;map spb&#x2D;mgmt&#x2D;route sequence&#x2D;number 1&#x30; match ip&#x2D;address 128.251.1.&#x30;&#47;24 redist&#x2D;control no&#x2D;subnets</p><p class="screen2" id="1373395">&#x2D;&#x3E; ip redist static into spb&#x2D;mgmt route&#x2D;map spb&#x2D;mgmt&#x2D;route</p><p class="screen2" id="1373360">&#x2D;&#x3E; ip route&#x2D;pref spb&#x2D;mgmt 155</p><p class="text" id="1373366">BEB&#x2D;2&#x3A;</p><p class="screen" id="1373367">&#x2D;&#x3E; system name BEB&#x2D;2</p><p class="screen2" id="1373368">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373369">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="screen2" id="1373370">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="screen2" id="1373371">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="screen2" id="1373372">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373373">&#x2D;&#x3E; spb interface port 1&#47;1&#47;3</p><p class="screen2" id="1373374">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1373375">&#x2D;&#x3E; ip interface bvlan&#x2D;intf address 1&#x30;&#x30;.&#x30;.&#x30;.2 vlan 4&#x30;&#x30;1</p><p class="screen2" id="1373376">&#x2D;&#x3E; ip interface Loopback&#x30; 1&#x30;.&#x30;.&#x30;.2</p><p class="screen2" id="1373437">&#x2D;&#x3E; ip redist ospf into spb&#x2D;mgmt all&#x2D;routes</p><p class="screen2" id="1373362">&#x2D;&#x3E; ip redist spb&#x2D;mgmt into ospf all&#x2D;routes</p><p class="text" id="1373465">BEB&#x2D;3&#x3A;</p><p class="screen" id="1373466">&#x2D;&#x3E; system name BEB&#x2D;3</p><p class="screen2" id="1373467">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373468">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="screen2" id="1373469">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="screen2" id="1373470">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="screen2" id="1373471">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373472">&#x2D;&#x3E; spb interface port 1&#47;1&#47;3</p><p class="screen2" id="1373473">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1373474">&#x2D;&#x3E; ip interface bvlan&#x2D;intf address 1&#x30;&#x30;.&#x30;.&#x30;.3 vlan 4&#x30;&#x30;1</p><p class="screen2" id="1376976">&#x2D;&#x3E; ip interface Loopback&#x30; 1&#x30;.&#x30;.&#x30;.3</p><p class="screen2" id="1376977">&#x2D;&#x3E; ip static&#x2D;route 128.251.2.&#x30;&#47;24 gateway 2&#x30;.&#x30;.&#x30;.253</p><p class="screen2" id="1376978">&#x2D;&#x3E; ip route&#x2D;map spb&#x2D;mgmt&#x2D;route sequence&#x2D;number 1&#x30; action permit</p><p class="screen2" id="1373478">&#x2D;&#x3E; ip route&#x2D;map spb&#x2D;mgmt&#x2D;route sequence&#x2D;number 1&#x30; match ip&#x2D;address 128.251.2.&#x30;&#47;24 redist&#x2D;control no&#x2D;subnets</p><p class="screen2" id="1373479">&#x2D;&#x3E; ip redist static into spb&#x2D;mgmt route&#x2D;map spb&#x2D;mgmt&#x2D;route</p><p class="screen2" id="1373480">&#x2D;&#x3E; ip route&#x2D;pref spb&#x2D;mgmt 155</p><p class="text" id="1373622">BEB&#x2D;4&#x3A;</p><p class="screen" id="1373623">&#x2D;&#x3E; system name BEB&#x2D;4</p><p class="screen2" id="1373624">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373625">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="screen2" id="1373626">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="screen2" id="1373627">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="screen2" id="1373628">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373629">&#x2D;&#x3E; spb interface port 1&#47;1&#47;3</p><p class="screen2" id="1373630">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1373631">&#x2D;&#x3E; ip interface bvlan&#x2D;intf address 1&#x30;&#x30;.&#x30;.&#x30;.4 vlan 4&#x30;&#x30;1</p><p class="screen2" id="1373632">&#x2D;&#x3E; ip interface Loopback&#x30; 1&#x30;.&#x30;.&#x30;.4</p><p class="text" id="1373651">BCB&#x2D;1&#x3A;</p><p class="screen" id="1373652">&#x2D;&#x3E; system name BCB&#x2D;1</p><p class="screen2" id="1373653">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373654">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="screen2" id="1373655">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="screen2" id="1373656">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="screen2" id="1373657">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373658">&#x2D;&#x3E; spb interface port 1&#47;1&#47;3</p><p class="screen2" id="1373659">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1373660">&#x2D;&#x3E; ip interface bvlan&#x2D;intf address 1&#x30;&#x30;.&#x30;.&#x30;.5 vlan 4&#x30;&#x30;1</p><p class="screen2" id="1373661">&#x2D;&#x3E; ip interface Loopback&#x30; 1&#x30;.&#x30;.&#x30;.5</p><p class="text" id="1373689">BCB&#x2D;2&#x3A;</p><p class="screen" id="1373690">&#x2D;&#x3E; system name BCB&#x2D;2</p><p class="screen2" id="1373691">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373692">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="screen2" id="1373693">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="screen2" id="1373694">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="screen2" id="1373695">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1373696">&#x2D;&#x3E; spb interface port 1&#47;1&#47;3</p><p class="screen2" id="1373697">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1373698">&#x2D;&#x3E; ip interface bvlan&#x2D;intf address 1&#x30;&#x30;.&#x30;.&#x30;.6 vlan 4&#x30;&#x30;1</p><p class="screen2" id="1373699">&#x2D;&#x3E; ip interface Loopback&#x30; 1&#x30;.&#x30;.&#x30;.6</p><p class="heading4" id="1366615"><a id="XREF_38099__Verifying_the_In-Band_Management_Configuration163" name="XREF_38099__Verifying_the_In-Band_Management_Configuration163">Verifying the In&#x2D;Band Management Configuration</a></p><p class="text" id="1374415"><a id="163_text_1374415" name="163_text_1374415"></a>Configuring a single IPv4 interface for an SPB Control BVLAN provides in&#x2D;band management access to the SPB domain. If the underlying configuration is not valid (more than one IP interface, the Control BVLAN is not operational), the <a href="../c_ip/c_ip.htm#XREF_49582__show_ip_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show ip interface</a> command will display the &#x201c;Operational State Reason&#x201d; as &#x201c;invalid&#x2D;cfg&#x201d;. For example&#x3A;</p><p class="screen" id="1374793">&#x2D;&#x3E; show ip interface bvlan&#x2D;intf</p><p class="screen2" id="1374794">Interface Name &#x3D; spb&#x2D;mgmt</p><p class="screen2" id="1374795">  SNMP Interface Index           &#x3D;   136&#x30;&#x30;&#x30;&#x30;3,</p><p class="screen2" id="1374796">  IP Address                     &#x3D;   11.&#x30;.&#x30;.47,</p><p class="screen2" id="1374797">  Subnet Mask                    &#x3D;   255.&#x30;.&#x30;.&#x30;,</p><p class="screen2" id="1374798">  Broadcast Address              &#x3D;   11.255.255.255,</p><p class="screen2" id="1374799">  Device                         &#x3D;   vlan 4&#x30;&#x30;&#x30;,</p><p class="screen2" id="1374800">  Encapsulation                  &#x3D;   eth2,</p><p class="screen2" id="1374801">  Forwarding                     &#x3D;   disabled,</p><p class="screen2" id="1374802">  Administrative State           &#x3D;   enabled,</p><p class="screen2" id="1374803">  Operational State              &#x3D;   down,</p><p class="screen2" id="1374804">  Operational State Reason       &#x3D;   invalid&#x2D;cfg,</p><p class="screen2" id="1374805">  Maximum Transfer Unit          &#x3D;   1524,</p><p class="screen2" id="1374806">  ARP Count                      &#x3D;   &#x30;,</p><p class="screen2" id="1374807">  Router MAC                     &#x3D;   e8&#x3A;e7&#x3A;32&#x3A;a4&#x3A;63&#x3A;21,</p><p class="screen2" id="1374808">  Local Proxy ARP                &#x3D;   disabled,</p><p class="screen2" id="1374789">  Primary (config&#47;actual)        &#x3D;   no&#47;yes</p><p class="text" id="1374958">ISIS&#x2D;SPB generates static ARP entries that map the system MAC address to the Control BVLAN IP address of the advertising manager BEB. The <a href="../c_ip/c_ip.htm#XREF_72296__show_arp" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show arp</a> command displays these entries with the ARP flag set to &#x201c;M&#x201d; (Managed). For example&#x3A;</p><p class="screen" id="1375464">&#x2D;&#x3E; show arp</p><p class="screen2" id="1375465"><br/></p><p class="screen2" id="1375466">Total 2 arp entries</p><p class="screen2" id="1375467"> Flags (P&#x3D;Proxy, A&#x3D;Authentication, V&#x3D;VRRP, B&#x3D;BFD, H&#x3D;HAVLAN, I&#x3D;INTF, M&#x3D;Managed)</p><p class="screen2" id="1375468">&#160;</p><p class="screen2" id="1375469"> IP Addr           Hardware Addr     Type   Flags  Port         Interface   Name</p><p class="screen2" id="1375470">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1375482"> 1&#x30;&#x30;.&#x30;.&#x30;.1       e8&#x3A;e7&#x3A;32&#x3A;1e&#x3A;4c&#x3A;88  STATIC     M          1&#47;1&#47;3  v4&#x30;&#x30;1</p><p class="screen2" id="1375460"> 1&#x30;&#x30;.&#x30;.&#x30;.3       e2&#x3A;e7&#x3A;32&#x3A;1e&#x3A;4b&#x3A;f8  STATIC     M          1&#47;1&#47;3  v4&#x30;&#x30;1</p><p class="text" id="1375583">To verify the SPB&#x2D;MGMT route redistribution configuration, use the <a href="../c_ip/c_ip.htm#XREF_50846__show_ipv6_rip_debug" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show ip redist</a> command. For example&#x3A;</p><p class="screen" id="1375815">&#x2D;&#x3E; show ip redist</p><p class="screen2" id="1375816"><br/></p><p class="screen2" id="1375817">Source       Destination</p><p class="screen2" id="1375818">Protocol     Protocol     Admin State  Route Map</p><p class="screen2" id="1375819">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1375820">LOCAL4       OSPF         Enabled     auto&#x2D;configure</p><p class="screen2" id="1375821">STATIC4      SPB&#x2D;MGMT     Enabled     spb&#x2D;mgmt&#x2D;route</p><p class="screen2" id="1375822">OSPF         SPB&#x2D;MGMT     Enabled     none (all&#x2D;routes)</p><p class="screen2" id="1375704">SPB&#x2D;MGMT     OSPF         Enabled     none (all&#x2D;routes)</p><p class="text" id="1375870">To verify the route preference assigned to SPB&#x2D;MGMT routes (default is 15&#x30;), use the <a href="../c_ip/c_ip.htm#XREF_98634__show_ip_router_database" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show ip route-pref</a> command. For example&#x3A;</p><p class="screen" id="1376007">&#x2D;&#x3E; show ip route&#x2D;pref</p><p class="screen2" id="1376008">  Protocol    Route Preference Value</p><p class="screen2" id="1376009">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1376010">  Local                 1</p><p class="screen2" id="1376011">  Static                2</p><p class="screen2" id="1376012">  OSPF                11&#x30;</p><p class="screen2" id="1376013">  ISISL1              115</p><p class="screen2" id="1376014">  ISISL2              118</p><p class="screen2" id="1376015">  RIP                 12&#x30;</p><p class="screen2" id="1376016">  SPB&#x2D;MGMT            15&#x30;</p><p class="screen2" id="1376017">  EBGP                19&#x30;</p><p class="screen2" id="1376018">  IBGP                2&#x30;&#x30;</p><p class="screen2" id="1376019">  Import              21&#x30;</p><p class="text" id="1376003">SPB&#x2D;MGMT route information is also included in the <a href="../c_ip/c_ip.htm#XREF_26467__show_ip_router_database" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show ip router database</a> and <a href="../c_ip/c_ip.htm#XREF_21987__show_ip_route" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show ip routes</a> commands. For example&#x3A;</p><p class="screen" id="1376781">&#x2D;&#x3E; show ip router database protocol spb&#x2D;mgmt</p><p class="screen2" id="1376782">Legend&#x3A; + indicates routes in&#x2D;use</p><p class="screen2" id="1376783">        b indicates BFD&#x2D;enabled static route</p><p class="screen2" id="1376784">        i indicates interface static route</p><p class="screen2" id="1376785">        r indicates recursive static route, with following address in brackets</p><p class="screen2" id="1376786"><br/></p><p class="screen2" id="1376850">Destination      Gateway       Interface   Protocol   Metric  Tag   Misc&#x2D;Info</p><p class="screen2" id="1376791">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1376236">+ 128.251.2.&#x30;&#47;24  2&#x30;.&#x30;.&#x30;.253   bvlan&#x2D;intf   SPB&#x2D;MGMT   11      &#x30;</p><p class="screen2" id="1377049"><br/></p><p class="screen" id="1377010">&#x2D;&#x3E; show ip routes</p><p class="screen2" id="1377011"><br/></p><p class="screen2" id="1377012">+ &#x3D; Equal cost multipath routes</p><p class="screen2" id="1377013"> Total 7 routes</p><p class="screen2" id="1377014"><br/></p><p class="screen2" id="1377015">  Dest Address       Gateway Addr        Age        Protocol</p><p class="screen2" id="1377016">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1377017">  1.1.1.1&#47;32           1.1.1.1           4d 5h      LOCAL</p><p class="screen2" id="1377018">  128.251.2.&#x30;&#47;24       2&#x30;.&#x30;.&#x30;.253        &#x30;&#x30;&#x3A;1&#x30;&#x3A;52   SPB&#x2D;MGMT</p><p class="screen2" id="1377019">  2&#x30;.&#x30;.&#x30;.&#x30;&#47;8           2&#x30;.&#x30;.&#x30;.1          4d 5h      LOCAL</p><p class="screen2" id="1377020">  24.&#x30;.&#x30;.&#x30;&#47;8           &#x30;.&#x30;.&#x30;.&#x30;           4d 5h      STATIC</p><p class="screen2" id="1377021">  4&#x30;.&#x30;.&#x30;.&#x30;&#47;8           4&#x30;.&#x30;.&#x30;.1          4d 5h      LOCAL</p><p class="screen2" id="1377022">  44.&#x30;.&#x30;.&#x30;&#47;8           2&#x30;.44.44.44       4d 5h      STATIC</p><p class="screen2" id="1377023">  127.&#x30;.&#x30;.1&#47;32         127.&#x30;.&#x30;.1         4d 5h      LOCAL</p><p class="text" id="1376496">The learned SPB&#x2D;MGMT routes are advertised in an SPB LSP under the TLV list heading &#x201c;IPv4 Reach Routes&#x201d;. Use the <span style="font-family : Courier New ; font-size : 9.00pt;"><a href="../c_spb/c_spb.htm#XREF_86288__show_ip_isis_database" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis database</a></span><span style="font-family : Courier New ; font-size : 9.00pt;">&#160;</span>command to display the LSP information. For example&#x3A;</p><p class="screen" id="1376497">&#x2D;&#x3E; show spb isis database lsp&#x2D;id &#x30;&#x30;d&#x30;.95&#x30;1.&#x30;84c.&#x30;&#x30;&#x2D;&#x30;&#x30;</p><p class="screen2" id="1376498">Legends &#x3A; P    &#x3D; The Partition repair bit is set</p><p class="screen2" id="1376499">          OV   &#x3D; The overload bit is set</p><p class="screen2" id="1376500">          ATT  &#x3D; The Attach bit is set</p><p class="screen2" id="1376501">          L1   &#x3D; Specifies a Level 1 IS type</p><p class="screen2" id="1376502">          L2   &#x3D; Specifies a Level 2 IS type</p><p class="screen2" id="1376503">SPB ISIS LSP Database&#x3A;</p><p class="screen2" id="1376504">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1376505">LSP ID        &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.&#x30;84c.&#x30;&#x30;&#x2D;&#x30;&#x30;                    Level     &#x3A; L1</p><p class="screen2" id="1376506">Sequence      &#x3A; &#x30;x&#x30;4             Checksum  &#x3A; &#x30;xc7f1     Lifetime  &#x3A; 763</p><p class="screen2" id="1376507">Version       &#x3A; 1                Pkt Type  &#x3A; 18         Pkt Ver   &#x3A; 1</p><p class="screen2" id="1376508">Attributes    &#x3A; L1               Max Area  &#x3A; 3</p><p class="screen2" id="1376509">SysID Len     &#x3A; 6                Used Len  &#x3A; 145        Alloc Len &#x3A; 1492</p><p class="screen2" id="1376510"><br/></p><p class="screen2" id="1376511">TLVs &#x3A;</p><p class="screen2" id="1376512">Area Addresses          &#x3A;</p><p class="screen2" id="1376513">   Area Address         &#x3A; (&#x30;1) &#x30;&#x30;</p><p class="screen2" id="1376514">   Area Address         &#x3A; (&#x30;3) &#x30;&#x30;.&#x30;&#x30;.&#x30;&#x30;</p><p class="screen2" id="1376515">Supp Protocols          &#x3A;</p><p class="screen2" id="1376516">   Protocols            &#x3A; SPB</p><p class="screen2" id="1376517">IPv4 I&#47;F Addresses      &#x3A;</p><p class="screen2" id="1376518">   IPv4 Address         &#x3A; 1&#x30;&#x30;.&#x30;.&#x30;.1</p><p class="screen2" id="1376519">IPv4 Reach Routes       &#x3A;</p><p class="screen2" id="1376520">   SPB&#x2D;MGMT route       &#x3A; 1&#x30;.&#x30;.&#x30;.1&#47;32</p><p class="screen2" id="1376521">   SPB&#x2D;MGMT route       &#x3A; 128.251.1.&#x30;&#47;24</p><p class="screen2" id="1376522">IS&#x2D;Hostname             &#x3A;</p><p class="screen2" id="1376523">   Hostname             &#x3A; DUT1</p><p class="screen2" id="1376524">TE IS Neighbors         &#x3A;</p><p class="screen2" id="1376525">   Neighbor             &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.b89c SPB Metric 1&#x30; Num of Ports 1 Port&#x2D;Id &#x30;x12&#x30;(1&#47;3&#47;32)</p><p class="screen2" id="1376526">MT Capability           &#x3A;</p><p class="screen2" id="1376527">   MT&#x2D;ID &#x3A; &#x30;x&#x30;</p><p class="screen2" id="1376528">   SPB INSTANCE         &#x3A;</p><p class="screen2" id="1376529">     CIST Root&#x2D;ID&#x3A; &#x30;x&#x30; &#x30;x&#x30;</p><p class="screen2" id="1376530">     CIST Ext Root Path Cost&#x3A; &#x30;x&#x30;&#x30;&#x30;&#x30;&#x30;&#x30;&#x30;&#x30; Bridge Priority&#x3A; &#x30;x8&#x30;&#x30;&#x30;</p><p class="screen2" id="1376531">     SPSourceID&#x3A; &#x30;x&#x30;&#x30;11&#x30;84c (Auto) Number of Trees&#x3A; 2</p><p class="screen2" id="1376532">     [&#x23;1 ] ECT&#x2D;algo&#x3A;&#x30;x&#x30;&#x30;8&#x30;c2&#x30;1 baseVid&#x3A; 4&#x30;&#x30;1 spVid&#x3A; &#x30; usedByISID&#x3A; 1(I&#x2D;SID) mode&#x3A; 1(SPBM)</p><p class="screen2" id="1376533">     [&#x23;2 ] ECT&#x2D;algo&#x3A;&#x30;x&#x30;&#x30;8&#x30;c2&#x30;2 baseVid&#x3A; 4&#x30;&#x30;2 spVid&#x3A; &#x30; usedByISID&#x3A; &#x30;() mode&#x3A; 1(SPBM)</p><p class="screen2" id="1376534">MT Capability &#x3A;</p><p class="screen2" id="1376535">   MT&#x2D;ID &#x3A; &#x30;x&#x30;</p><p class="screen2" id="1376536">   SPB SVCID&#x2D;UCAST&#x2D;ADDR &#x3A;</p><p class="screen2" id="1376537">     B&#x2D;MAC &#x30;&#x30;.d&#x30;.95.&#x30;1.&#x30;8.4c Base&#x2D;VID 4&#x30;&#x30;1</p><p class="screen2" id="1376538">     [ISID&#x23; 1] 16776961 (T&#x3D;1&#47;R&#x3D;1)</p><p class="heading1" id="1363142"><a id="XREF_69468__Quick_Steps_for_Configuring_a_VLAN_Stacking_Service163" name="XREF_69468__Quick_Steps_for_Configuring_a_VLAN_Stacking_Service163">Interaction With Other Features</a></p><p class="text" id="1119427"><a id="163_text_1119427" name="163_text_1119427"></a>This section contains important information about Shortest Path Bridging MAC (SPBM) interaction with other OmniSwitch features. Refer to the specific chapter for each feature to get more detailed information about how to configure and use the feature. </p><p class="heading2" id="1134254">Backbone VLANs (VLAN Manager)</p><p class="text" id="1134255">VLAN Manager CLI commands are used to create an SPB <a id="index_1135447" name="index_1135447"></a><a data-indexterm="backbone%20VLAN" id="backbone_VLAN" name="backbone_VLAN"></a><a data-indexterm="%3C$nopage%3EBVLAN%3Csee%20also%3E%20see%20%3Cdefault%20para%20font%3E%20backbone%20VLAN" id="%3C$nopage%3EBVLAN%3Csee_also%3E_see_%3Cdefault_para_font%3E_backbone_VLAN" name="%3C$nopage%3EBVLAN%3Csee_also%3E_see_%3Cdefault_para_font%3E_backbone_VLAN"></a><a data-indexterm="Shortest%20Path%20Bridging:BVLAN" id="Shortest_Path_Bridging_BVLAN" name="Shortest_Path_Bridging_BVLAN"></a>backbone VLAN (BVLAN). Although a BVLAN is created in a similar manner as a standard VLAN, BVLANs differ from standard VLANs as follows&#x3A;</p><p class="bullet" id="1134256"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>No Spanning Tree control&#x2014;the Spanning Tree protocol is automatically disabled on each BVLAN and all ports associated with each BVLAN will remain in a forwarding state. However, Spanning Tree can remain operational on other types of VLANs.</p><p class="bullet" id="1134257"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>No source MAC address learning&#x2014;normal hardware learning is disabled on BVLANs. Instead, the forwarding database (FDB) is populated by the ISIS&#x2D;SPB protocol.</p><p class="bullet" id="1134258"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>There is no flooding of unknown destination or multicast frames.</p><p class="bullet" id="1202215"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Ingress filtering based on the source MAC address&#x2014;frames received on ports that do not have an incoming source MAC address pre&#x2D;programmed by ISIS&#x2D;SPB are discarded.</p><p class="bullet" id="1202220"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>IP interfaces are not supported on BVLANs, except for the Control BVLAN to provide in&#x2D;band management support for the SPB domain.</p><p class="heading3" id="1322427">Automatic Fabric BVLANs</p><p class="text" id="1322470"><span style="font-kerning:normal;">In previous releases, Automatic Fabric created 16 BVLANs during the SPB discovery phase. The current implementation creates 4 BVLANs. When upgrading from a previous release or using an SPB network with some switches running the current release and others running a previous release, pruning unused BVLANs is recommended to improve SPB scalability and convergence time.</span><span style="font-kerning:normal;">&#160;</span><span style="font-kerning:normal;">Refer to <a  href="#XREF_10241__SPB_Network_Scalability_and_Convergence163" style="color:#0000ff;background-color:transparent;">SPB Network Scalability and Convergence</a></span><span style="font-kerning:normal;"> for more information.</span></p><p class="heading2" id="1202344">IP Multicast Switching</p><p class="text" id="1213980">In a networking environment where IP multicast traffic is used, destination hosts signal their intent to receive a specific IP multicast stream by sending an Internet Group Management Protocol (IGMP) request to a nearby switch. This process is referred to as IGMP Snooping. The switch then learns on which ports multicast group subscribers are attached and can intelligently deliver traffic only to the respective ports. The OmniSwitch implementation of IGMP Snooping is called IP Multicast Switching (IPMS).</p><p class="text" id="1213981">IGMP Snooping for SPB services is essentially the same. An SPB Backbone Edge Bridge (BEB) will apply the logic of IGMP Snooping on a per&#x2D;service basis to limit the traffic going out of each Service Access Point (SAP) port, as well as limit traffic going out across each backbone port. The SPB bridge will monitor the IGMP queries and requests from SAPs and Service Distribution Point (SDP) ports (also referred to as network virtual ports) to build the stream membership association logic and timing in the same manner as is done on a standard IGMP Snooping bridge.</p><p class="text" id="1213982">When traffic arrives on a SAP port, the switch will examine the packet to see if there are any known receivers. If there are any such receivers, then only ports (including network virtual ports) will have a copy of that frame sent on them. When traffic arrives from the core on a network virtual port, the same logic is applied so that a copy of the frame is only sent out on a port where a listener has requested membership to the stream. However, traffic from the core is never sent back into the core (split horizon protection).</p><p class="text" id="1214001">IPMS is configurable in both the VLAN and service domains. Enabling IPMS functionality specifically for SPB services is required to activate IGMP Snooping in an SPB network. See the &#x201c;Configuring IP Multicast Switching&#x201d; chapter in the <span class="Times_italics" data-keyref="Network Config Guide" style="font-family : Times New Roman ; font-weight:normal;font-style:Italic;font-size : 10.50pt;text-decoration:none;font-kerning:none;text-transform:none;font-stretch:normal;color:#000000;background-color:transparent;letter-spacing : 0.00em;">OmniSwitch AOS Release 8 Network Configuration Guide</span> for more information.</p><p class="heading2" id="1202225">Link Aggregation</p><p class="bullet" id="1119429"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Both static and dynamic link aggregates are configurable as SPBM service access ports and as SPBM network interfaces. </p><p class="bullet" id="1119430"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Note that a link aggregate must consist of all access ports or all network ports. SPBM functionality is not supported on link aggregates that consist of a mixture of SPBM ports and standard switch ports.</p><p class="bullet" id="1199633"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When creating a link aggregate that will serve as an SPBM service access port or network interface, specify the Tunnel Protocol hashing option for the aggregate. This will ensure that hashing is done on the payload of encapsulated SPB packets. See the &#x201c;Link Aggregation Commands&#x201d; chapter in the <span class="Times_italics" data-keyref="CLI Reference Guide" style="font-family : Times New Roman ; font-weight:normal;font-style:Italic;font-size : 10.50pt;text-decoration:none;font-kerning:none;text-transform:none;font-stretch:normal;color:#000000;background-color:transparent;letter-spacing : 0.00em;">OmniSwitch AOS Release 8 CLI Reference Guide</span> for more information.</p><p class="heading2" id="1121331">OAM</p><p class="bullet" id="1123802"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>OAM support per the IEEE 8&#x30;2.1ah standard for Provider Backbone Bridging (PBB) is applied at the customer VLAN (CVLAN) and the backbone VLAN (BVLAN) level. Support at the service instance (I&#x2D;SID) level is provided through Remote Fault Propagation on SPB.</p><p class="bullet" id="1123806"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The OmniSwitch Ethernet OAM feature is required to support RFP for SPB. When an RFP local end point is created on the switch, the following reserved maintenance domain and maintenance association is created&#x3A;</p><p class="bullet_sub" id="1153922"><span class="bold">&#x2013;&#160;&#160;&#160; </span>RFP_OVER_SPB_DOMAIN_LEVEL<span class="Times_italics" style="font-style:Italic;background-color:transparent;">x</span> (where <span class="Times_italics" style="font-style:Italic;background-color:transparent;">x</span> is the level number specified when a local RFP end point is created)</p><p class="bullet_sub" id="1153941"><span class="bold">&#x2013;&#160;&#160;&#160; </span>RFP_OVER_SPB_ASSOCIATION</p><p class="bullet" id="1153619"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>In addition, the OmniSwitch proprietary Layer 2 ping and traceroute features are available to troubleshoot CVLAN and BVLAN domains, including an I&#x2D;SID check.</p><p class="heading2" id="1123801">Quality of Service (QoS)</p><p class="bullet" id="1121345"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The priority assignment of a user frame is determined at an access point. A Service Access Point (SAP) on an SPB access port can be configured as trusted or un&#x2D;trusted. If a SAP is configured as trusted, then internal priority for ingress traffic on that SAP is derived from tagged or NULL tagged ingress packet priority or from default port priority if ingress packet is untagged. If a SAP is untrusted then internal priority can be configured by the user.</p><p class="bullet" id="1386200"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>In the case of an inline routing configuration, for traffic ingressing through SAP ports and destined to the switch, QoS may not be applied.</p><p class="bullet" id="1121350"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>QoS performs the following actions on ports configured as access ports&#x3A;</p><p class="bullet_sub" id="1121351"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Access ports are automatically trusted and the default classification is set to 8&#x30;2.1p. </p><p class="bullet_sub" id="1121354"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The trust status and classification are not user&#x2D;configurable on access ports.</p><p class="bullet_sub" id="1123436"><span class="bold">&#x2013;&#160;&#160;&#160; </span>All QoS CLI configuration is blocked on access ports.This includes physical ports and ports that are members of a link aggregate.</p><p class="bullet_sub" id="1257839"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Untagged L2 control packets (such as BPDU, GVRP, AMAP) are tunneled (if enabled) through the SPB domain with the priority value set to &#x30;. Trusted and untrusted SAPs configured on access ports will not affect the priority assignment for Layer 2 control packets. </p><p><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>QoS priority (8&#x30;2.1p) is applied as follows to trusted and untrusted SAPs&#x3A;<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="168.00px"/><col width="72.00px"/><col width="264.00px"/><thead><tr height="28.00px"><th><p class="CellHeading_small" id="1142906">SAP Configuration</p></th><th colspan="2"><p class="CellHeading_small" id="1142908">Allowed Configuration</p></th></tr></thead><tr height="22.00px"><td><p class="CellBody_small" id="1142912">Tagged (VLAN 1&#x2013;4&#x30;94)</p></td><td><p class="CellBody_small" id="1142914">Trusted</p></td><td><p class="CellBody_small" id="1142916">Tagged traffic priority derived from tags.</p></td></tr><tr height="22.00px"><td/><td><p class="CellBody_small" id="1142920">Untrusted</p></td><td><p class="CellBody_small" id="1142922">Tagged traffic priority configured by user.</p></td></tr><tr height="22.00px"><td><p class="CellBody_small" id="1142924">QinQ (outer VLAN 1&#x2013;4&#x30;94)</p></td><td><p class="CellBody_small" id="1142926">Trusted</p></td><td><p class="CellBody_small" id="1142928">Tagged traffic priority derived from outer tags.</p></td></tr><tr height="22.00px"><td/><td><p class="CellBody_small" id="1142932">Untrusted</p></td><td><p class="CellBody_small" id="1142934">Tagged traffic priority configured by user.</p></td></tr><tr height="35.33px"><td><p class="CellBody_small" id="1142936">Wild Card</p></td><td><p class="CellBody_small" id="1142939">Trusted</p></td><td><p class="CellBody_small" id="1142941">Tagged traffic priority derived from tags.</p><p class="CellBody_small" id="1142942">Untagged traffic Port default (PRI &#x30;).</p></td></tr><tr height="22.00px"><td/><td><p class="CellBody_small" id="1142946">Untrusted</p></td><td><p class="CellBody_small" id="1142948">Tagged&#47; traffic priority configured by user</p></td></tr><tr height="22.00px"><td><p class="CellBody_small" id="1142950">Untagged</p></td><td><p class="CellBody_small" id="1142952">Trusted</p></td><td><p class="CellBody_small" id="1142954">Untagged Traffic Port default (PRI &#x30;)</p></td></tr><tr height="22.00px"><td/><td><p class="CellBody_small" id="1142958">Untrusted</p></td><td><p class="CellBody_small" id="1142960">Priority configured by user.</p></td></tr></table></div></p><p class="bullet_sub" id="1123694"><span class="bold">&#x2013;&#160;&#160;&#160; </span>By default, a SAP is trusted with best effort priority (&#x30;).</p><p class="bullet_sub" id="1123683"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A SAP can be dynamically changed to trusted&#47;untrusted without administratively taking down the SAP.</p><p class="bullet_sub" id="1123684"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A SAP priority may only be set when a SAP is untrusted.</p><p class="bullet_sub" id="1123685"><span class="bold">&#x2013;&#160;&#160;&#160; </span>When a SAP is changed from untrusted to trusted, any previously assigned priority is reset with best effort priority (&#x30;).</p><p class="bullet_sub" id="1123686"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A trusted SAP that defines a double&#x2D;tagged encapsulation (QinQ) will use the outer VLAN tag to determine the priority of the frame.</p><p class="bullet" id="1123711"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Priority handling at the edge and core components of an SPBM topology&#x3A;</p><p class="bullet_sub" id="1123713"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On a ingress Backbone Edge Bridge (BEB), a frame is classified to a SAP. The internal priority is determined based on the QoS settings of the SAP (for example, trusted vs. untrusted, default priority). This internal priority is mapped to the backbone VLAN (BVLAN) tag of the tunnel encapsulation.</p><p class="bullet_sub" id="1123719"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The Backbone Core Bridge (BCB) acts as a Layer 2 device that switches the frame across ingress to egress ports in the BVLAN domain. The BVLAN tag is used to determine the internal priority queue on the egress port where the frame is enqueued.</p><p class="bullet_sub" id="1145179"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On an egress BEB, the internal priority is determined from the BVLAN tag. The frame is de&#x2D;encapsulated and enqueued to the egress queue(s) of the access port(s) based on this internal priority.</p><p class="heading2" id="1145190">Universal Network Profiles (UNP)</p><p class="text" id="1145191">Integration with Virtual Machine Network Profiles (vNPs) to support device discovery and mobility. The UNP feature supports two types of profiles&#x3A; VLAN and service. A service profile can be configured to classify traffic for SPB or VXLAN tunneling.</p><p class="text" id="1145192">The OmniSwitch supports both a VLAN and service domain for traffic classification. </p><p class="bullet" id="1145193"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The VLAN domain is identified by a VLAN ID. In the VLAN domain, each VLAN is accessed through a physical port. Each physical port can have more than one VLAN attached. UNP VLAN classification associates a MAC address to a specific VLAN on a physical UNP bridge port.</p><p class="bullet" id="1145194"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The service domain is identified by one of the following&#x3A; </p><p class="bullet_sub" id="1145196"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A Shortest Path Bridging (SPB) service instance identifier (I&#x2D;SID), which is associated with a Service Manger service ID to represent a virtual forwarding instance (VFI).</p><p class="bullet_sub" id="1194062"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A VXLAN Network Identifier (VNI), which is associated with a Service Manager service ID to represent a VFI.</p><p class="text" id="1145197">In the service domain, each VFI is accessed through a virtual port, referred to as a Service Access Point (SAP). UNP service classification associates a device MAC address to a SAP.</p><p class="heading3" id="1145239">Dynamic Service Access Points</p><p class="text" id="1145240">A UNP service profile can trigger the dynamic creation of a SAP when traffic received on a UNP access port is classified and assigned to that profile. If the service (SPB or VXLAN) that the SAP is associated with does not exist, the service is also dynamically created. </p><p class="text" id="1145186">Allowing incoming traffic to trigger dynamic SAP creation reduces the amount of manual configuration required. In addition, no other protocols are required on the switch or host device to support this functionality.</p><p class="heading2" id="1197721">UniDirectional Link Detection (UDLD)</p><p>UDLD protocol control frames (destination MAC address is &#x30;1&#x3A;&#x30;&#x30;&#x3A;&#x30;c&#x3A;cc&#x3A;cc&#x3A;cc) are processed as follows&#x3A;<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;margin-bottom:12.00pt;"><col width="115.20px"/><col width="96.00px"/><col width="96.00px"/><col width="96.00px"/><col width="96.00px"/><thead><tr height="45.33px"><th><p class="CellHeading" id="1198789">UDLD Status</p></th><th><p class="CellHeading" id="1198791" style="text-align:center;">User Access</p><p class="CellHeading" id="1198862" style="text-align:center;">Port</p></th><th><p class="CellHeading" id="1198793" style="text-align:center;">Network Port (Tagged)</p></th><th><p class="CellHeading" id="1198795" style="text-align:center;">Network Port (Untagged)</p></th><th><p class="CellHeading" id="1198797" style="text-align:center;">Legacy</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1198799" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">Globally disabled</span></p></td><td><p class="CellBody" id="1198801" style="text-align:center;">tunnel</p></td><td><p class="CellBody" id="1198803" style="text-align:center;">tunnel</p></td><td><p class="CellBody" id="1198805" style="text-align:center;">discard</p></td><td><p class="CellBody" id="1198807" style="text-align:center;">tunnel</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1198809" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">Globally enabled</span></p></td><td><p class="CellBody" id="1198811" style="text-align:center;">tunnel</p></td><td><p class="CellBody" id="1198813" style="text-align:center;">tunnel</p></td><td><p class="CellBody" id="1198815" style="text-align:center;">discard</p></td><td><p class="CellBody" id="1198817" style="text-align:center;">drop</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1198819" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">Enabled on port</span></p></td><td><p class="CellBody" id="1198821" style="text-align:center;">peer</p></td><td><p class="CellBody" id="1198823" style="text-align:center;">tunnel</p></td><td><p class="CellBody" id="1198825" style="text-align:center;">peer</p></td><td><p class="CellBody" id="1198827" style="text-align:center;">peer</p></td></tr></table></div>&#160;</p><p class="heading2" id="1145180">VRF</p><p class="text" id="1145181">IP over SPB uses Virtual Routing and Forwarding (VRF) instances to exchange routes with I&#x2D;SIDs. This is accomplished via the Global Route Manager (GRM). VRF routes are exported to the GRM table and imported into I&#x2D;SIDs; I&#x2D;SID routes are exported to the GRM table and imported into VRFs.</p><p class="bullet" id="1138996"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A binding is created between a VRF and the I&#x2D;SIDs to identify which I&#x2D;SIDs will export routes to the GRM for the specified VRF (see <a  href="#XREF_26416__Configuring_IP_over_SPB163" style="color:#0000ff;background-color:transparent;">Configuring IP over SPB</a> for more information).</p><p class="bullet" id="1139000"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ip import </span>command has an optional <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">isid</span> parameter that notifies GRM to import the routes from the specified I&#x2D;SID into the requesting VRF.</p><p class="heading2" id="1385719">DHCP Snooping</p><p class="text" id="1385721">DHCP Snooping is not supported in SPB services domain.</p><p class="heading1" id="1119600"><a id="XREF_34328__Quick_Steps_for_Configuring_Service-Based_VLAN_Stacking163" name="XREF_34328__Quick_Steps_for_Configuring_Service-Based_VLAN_Stacking163">Quick Steps for Configuring SPBM</a></p><p class="text" id="1119601"><a id="163_text_1119601" name="163_text_1119601"></a>This section provides a quick tutorial for configuring the SPBM network backbone (control plane) and the service encapsulation path (data plane). The Command Line Interface (CLI) commands provided in this section are used to configure the <a  href="#XREF_23286__Sample_SPBM_Network_Topology163" style="color:#0000ff;background-color:transparent;">Sample SPBM Network Topology</a>.</p><p class="heading2" id="1129500">Quick Steps for Configuring the SPBM Backbone</p><p class="text" id="1129501">The following quick steps are used on each switch in the SPBM backbone that will participate in the <a  href="#XREF_23286__Sample_SPBM_Network_Topology163" style="color:#0000ff;background-color:transparent;">Sample SPBM Network Topology</a>. This includes both edge and transit (core) switches.</p><p class="step_first" id="1129505"><span class="Futura_Bold">1&#160;&#160;&#160; </span>Use the <a href="../c_chassis/c_chassis.htm#XREF_28038__system_name" style="font-weight:Bold;color:#0000ff;background-color:transparent;">system name</a> command to assign a unique system name to each SPB switch in the domain.</p><p class="example1" id="1125566">&#x2D;&#x3E; system name BEB&#x2D;1</p><p class="example2" id="1129423">&#x2D;&#x3E; system name BEB&#x2D;2</p><p class="example2" id="1129424">&#x2D;&#x3E; system name BCB&#x2D;1</p><p class="example2" id="1129425">&#x2D;&#x3E; system name BCB&#x2D;2</p><p class="example2" id="1129426">&#x2D;&#x3E; system name BCB&#x2D;3</p><p class="example2" id="1129427">&#x2D;&#x3E; system name BCB&#x2D;4</p><p class="example2" id="1130961">&#x2D;&#x3E; system name BCB&#x2D;5</p><p class="example2" id="1130962">&#x2D;&#x3E; system name BCB&#x2D;6</p><p class="step_next" id="1119607"><span class="Futura_Bold">2&#160;&#160;&#160; </span>Use the <a href="../c_spb/c_spb.htm#XREF_44597__vlan" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb bvlan</a> command to create BVLANs 4&#x30;&#x30;1 and 4&#x30;&#x30;2 on each switch (edge and core switches) that will participate in the SPBM topology. </p><p class="example1" id="1119608">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="example2" id="1129395">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="step_next" id="1119617"><span class="Futura_Bold">3&#160;&#160;&#160; </span>Use the <a href="../c_spb/c_spb.htm#XREF_40021__spb_isis_bvlan_ect-id" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis bvlan ect-id</a> command to change the equal cost tree (ECT) algorithm ID for the specified BVLAN, if necessary, to make sure that the same ECT ID is assigned to the same BVLAN ID on each switch (edge and core switches) in the SPBM topology. </p><p class="example1" id="1129405">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="example2" id="1129411">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="step_next" id="1125575"><span class="Futura_Bold">4&#160;&#160;&#160; </span>Use the <a href="../c_spb/c_spb.htm#XREF_48955__spb_isis_control-bvlan" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis control-bvlan</a> command to designate one of the BVLANs on each SPB switch (edge and core switches) as the Control BVLAN for the SPB instance. The Control BVLAN is used to exchange ISIS&#x2D;SPB control packets with neighboring SPB switches.</p><p class="example1" id="1119618">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="step_next" id="1119622"><span class="Futura_Bold">5&#160;&#160;&#160; </span>Use the <a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a> command to configure a port or link aggregate as an SPB interface. This type of interface sends PDUs to detect neighboring SPB switches and form adjacencies and also serves as a network port that is used to carry encapsulated service traffic through the SPBM backbone network.</p><p class="example1" id="1216296">&#x2D;&#x3E; spb isis interface port 1&#47;1&#x2D;4</p><p class="example2" id="1216312">&#x2D;&#x3E; spb isis interface port 1&#47;1&#x2D;3</p><p class="text" id="1216033">In the <a  href="#XREF_23286__Sample_SPBM_Network_Topology163" style="color:#0000ff;background-color:transparent;">Sample SPBM Network Topology</a>, ports 1&#47;1&#x2D;4 are configured as SPB interfaces on the core switches (BCB&#x2D;1, BCB&#x2D;2) and ports 1&#47;1&#x2D;3 are configured as SPB interfaces on all other switches.</p><p class="step_next" id="1119627"><span class="Futura_Bold">6&#160;&#160;&#160; </span>Use the <a href="../c_spb/c_spb.htm#XREF_74387__spb_isis_status" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis admin-state</a> command to enable the SPB instance for the switch. Enabling ISIS&#x2D;SPB on the switch triggers the transmission of hello packets from the SPB interfaces, which starts the process of defining the SPB infrastructure and calculating the shortest path trees (SPTs) through the topology.</p><p class="example1" id="1119628">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="heading2" id="1119629">Quick Steps for Configuring SPB Services</p><p class="text" id="1119630">The following quick steps use the OmniSwitch Service Manager commands to configure the logical entities that comprise the SPB services in the <a  href="#XREF_23286__Sample_SPBM_Network_Topology163" style="color:#0000ff;background-color:transparent;">Sample SPBM Network Topology</a>.</p><p class="step_first" id="1119634"><span class="Futura_Bold">1&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_50401__service_access" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service access</a> command to configure a port or link aggregate on which customer traffic is received as an SPB service access port.</p><p class="example1" id="1119635">&#x2D;&#x3E; service access port 1&#47;12</p><p class="example2" id="1130972">&#x2D;&#x3E; service access port 2&#47;1</p><p class="step_next" id="1146077"><span class="Futura_Bold">2&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_95469__service_spb" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service spb</a> command to create an SPB service and associate that service with a backbone service instance identifier (I&#x2D;SID) and BVLAN.</p><p class="example1" id="1146078">&#x2D;&#x3E; service 1 spb isid 5&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="example2" id="1146079">&#x2D;&#x3E; service 2 spb isid 5&#x30;1 bvlan 4&#x30;&#x30;2 admin&#x2D;state enable</p><p class="step_next" id="1119644"><span class="Futura_Bold">3&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_73897__service_spb_sap" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap</a> command to create a service access point (SAP) by associating an SPB service with SAP ID. A SAP ID is comprised of a port or link aggregate and an encapsulation value that identifies the customer traffic to associate with the service.</p><p class="example1" id="1119645">&#x2D;&#x3E; service 1 sap port 1&#47;12&#x3A;1&#x30; admin&#x2D;state enable</p><p class="example2" id="1129459">&#x2D;&#x3E; service 1 sap port 2&#47;1&#x3A;1&#x30; admin&#x2D;state enable</p><p class="example2" id="1130988">&#x2D;&#x3E; service 2 sap port 1&#47;12&#x3A;&#x30; admin&#x2D;state enable</p><p class="example2" id="1130989">&#x2D;&#x3E; service 2 sap port 2&#47;1&#x3A;all admin&#x2D;state enable</p><p class="text" id="1119646">In this example, </p><p class="bullet" id="1216061"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 1 (I&#x2D;SID&#x3D; 5&#x30;&#x30;, BVLAN&#x3D;4&#x30;&#x30;1) is assigned to SAPs 1&#47;12&#x3A;1&#x30; and 2&#47;1&#x3A;1&#x30;. Traffic received on the SAP access ports (1&#47;12, 2&#47;1) that has an outer tag (customer VLAN tag) equal to 1&#x30; is mapped to SPB service 1. </p><p class="bullet" id="1215610"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 2 (I&#x2D;SID&#x3D;5&#x30;1, BVLAN&#x3D;4&#x30;&#x30;2) is assigned to SAPs 1&#47;12&#x3A;&#x30; and 2&#47;1&#x3A;all. All tagged traffic (except for VLAN 1&#x30; tagged traffic, which is mapped to service 1) and untagged traffic received on the SAP access ports (1&#47;12, 2&#47;1) is mapped to SPB service 2.</p><p class="heading2" id="1129486">Sample Command Configuration</p><p class="text" id="1129524">This section provides the sequence of commands used on each switch to configure the <a  href="#XREF_23286__Sample_SPBM_Network_Topology163" style="color:#0000ff;background-color:transparent;">Sample SPBM Network Topology</a>. Note that the SPBM backbone is configured on every switch first, then the SPBM service architecture is configured second. Following this order of configuration is highly recommended to ensure proper switch participation in ISIS&#x2D;SPB adjacencies and shortest path tree calculations.</p><p class="heading3" id="1129689">SPBM Backbone Commands</p><p>The <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">system name</span> and Shortest Path Bridging (<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb</span>) commands are used to configure the SPBM backbone infrastructure for the sample topology, as shown&#x3A;<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="192.00px"/><col width="192.00px"/><col width="192.00px"/><tr height="126.67px"><td><p class="CellHeading_small" id="1129696">BEB&#x2D;1</p><p class="CellBody_cli_cmd" id="1129697" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BEB&#x2D;1</p><p class="CellBody_cli_cmd" id="1129698" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129699" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129700" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129701" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129702" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143328" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;3</p><p class="CellBody_cli_cmd" id="1143331" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td><td><p class="CellHeading_small" id="1129824">BEB&#x2D;2</p><p class="CellBody_cli_cmd" id="1129825" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BEB&#x2D;2</p><p class="CellBody_cli_cmd" id="1129826" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129827" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129828" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129829" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129830" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143322" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;3</p><p class="CellBody_cli_cmd" id="1143325" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td><td><p class="CellHeading_small" id="1129838">BCB&#x2D;1</p><p class="CellBody_cli_cmd" id="1129839" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BCB&#x2D;1</p><p class="CellBody_cli_cmd" id="1129840" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129841" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129842" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129843" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129844" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143316" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;4</p><p class="CellBody_cli_cmd" id="1143319" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td></tr><tr height="126.67px"><td><p class="CellHeading_small" id="1129852">BCB&#x2D;2</p><p class="CellBody_cli_cmd" id="1129853" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BCB&#x2D;2</p><p class="CellBody_cli_cmd" id="1129854" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129855" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129856" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129857" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129858" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143334" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;4</p><p class="CellBody_cli_cmd" id="1143337" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td><td><p class="CellHeading_small" id="1129866">BCB&#x2D;3</p><p class="CellBody_cli_cmd" id="1129867" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BCB&#x2D;3</p><p class="CellBody_cli_cmd" id="1129868" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129869" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129870" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129871" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129872" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143340" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;3</p><p class="CellBody_cli_cmd" id="1143343" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td><td><p class="CellHeading_small" id="1129880">BCB&#x2D;4</p><p class="CellBody_cli_cmd" id="1129881" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BCB&#x2D;4</p><p class="CellBody_cli_cmd" id="1129882" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129883" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129884" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129885" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129886" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143346" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;3</p><p class="CellBody_cli_cmd" id="1143349" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td></tr><tr height="126.67px"><td><p class="CellHeading_small" id="1129809">BCB&#x2D;5</p><p class="CellBody_cli_cmd" id="1129810" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BCB&#x2D;5</p><p class="CellBody_cli_cmd" id="1129811" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129812" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129813" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129814" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129815" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143358" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;3</p><p class="CellBody_cli_cmd" id="1143361" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td><td><p class="CellHeading_small" id="1129791">BCB&#x2D;6</p><p class="CellBody_cli_cmd" id="1129792" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; system name BCB&#x2D;6</p><p class="CellBody_cli_cmd" id="1129793" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1129794" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1129795" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 1</p><p class="CellBody_cli_cmd" id="1129796" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2</p><p class="CellBody_cli_cmd" id="1129797" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1143352" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb interface port 1&#47;1&#x2D;3</p><p class="CellBody_cli_cmd" id="1143355" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p></td><td/></tr></table></div>&#160;</p><p class="heading3" id="1130221">SPBM Service Commands</p><p>The Service Manager (<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service</span>) commands are used to build the SPBM services architecture for the sample topology, as shown. Note that services are only configured on designated BEB switches.<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="288.00px"/><col width="288.00px"/><tr height="102.67px"><td><p class="CellHeading_small" id="1135223">BEB&#x2D;1</p><p class="CellBody_cli_cmd" id="1135224" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service access port 1&#47;12</p><p class="CellBody_cli_cmd" id="1135225" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 1 spb isid 5&#x30;&#x30; bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1135226" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 2 spb isid 5&#x30;1 bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1135227" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 1 sap port 1&#47;12&#x3A;1&#x30; admin&#x2D;state enable</p><p class="CellBody_cli_cmd" id="1135228" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 2 sap port 1&#47;12&#x3A;&#x30; admin&#x2D;state enable</p><p class="CellBody_cli_cmd" id="1135229" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 2 sap port 1&#47;12&#x3A;all admin&#x2D;state enable</p></td><td><p class="CellHeading_small" id="1135231">BEB&#x2D;2</p><p class="CellBody_cli_cmd" id="1135232" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service access port 2&#47;1</p><p class="CellBody_cli_cmd" id="1135233" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 1 spb isid 5&#x30;&#x30; bvlan 4&#x30;&#x30;1</p><p class="CellBody_cli_cmd" id="1135234" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 2 spb isid 5&#x30;1 bvlan 4&#x30;&#x30;2</p><p class="CellBody_cli_cmd" id="1135235" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 1 sap 2&#47;1&#x3A;1&#x30; admin&#x2D;state enable</p><p class="CellBody_cli_cmd" id="1135236" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 2 sap 2&#47;1&#x3A;&#x30; admin&#x2D;state enable</p><p class="CellBody_cli_cmd" id="1135237" style="font-weight:normal;font-size : 9.00pt;">&#x2D;&#x3E; service 2 sap 2&#47;1&#x3A;all admin&#x2D;state enable</p></td></tr></table></div></p><p class="heading1" id="1130309"><a id="XREF_30935__Configuring_SPBM163" name="XREF_30935__Configuring_SPBM163">Configuring SPBM</a></p><p class="text" id="1118434"><a id="163_text_1118434" name="163_text_1118434"></a>Configuring the SPBM backbone and service layers requires several steps. These steps are outlined here and further described throughout this section. For a brief tutorial on configuring SPBM, see <a  href="#XREF_34328__Quick_Steps_for_Configuring_Service-Based_VLAN_Stacking163" style="color:#0000ff;background-color:transparent;">Quick Steps for Configuring SPBM</a>.</p><p class="heading2" id="1118438">Configure the SPBM Backbone (ISIS&#x2D;SPB)</p><p class="text" id="1124887">Only switches that are SPB capable can participate in the SPBM network topology. The following configuration steps are required to make an OmniSwitch an SPB&#x2D;capable node&#x3A;</p><p class="step_first" id="1125324"><span class="Futura_Bold">1&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Create a BVLAN</span>. The BVLAN provides the foundation of the SPBM infrastructure. A BVLAN is associated with an equal cost tree (ECT) algorithm ID and an SPB service instance ID that is used to carry customer traffic through the backbone network. See <a  href="#XREF_52388__Configuring_VLAN_Bridge_Priority163" style="color:#0000ff;background-color:transparent;">Backbone VLANs</a>.</p><p class="step_next" id="1118446"><span class="Futura_Bold">2&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Configure SPB interfaces.</span> An SPB interface is associated with each BVLAN that is configured on the switch. At the ISIS&#x2D;SPB level, this type of interface sends and receives ISIS Hello packets and link state PDU (LSP) to discover adjacent SPB switches and calculate the shortest path trees through the SPBM network topology. At the services level, the SPB interfaces serve as network ports that are used to carry encapsulated customer traffic through the network. See <a  href="#XREF_64170__Configuring_SPB_Interfaces163" style="color:#0000ff;background-color:transparent;">Configuring SPB Interfaces</a>.</p><p class="step_next" id="1127255"><span class="Futura_Bold">3&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Configure global ISIS&#x2D;SPB parameters. </span>In addition to enabling&#47;disabling the ISIS&#x2D;SPB instance for the switch, global configuration includes settings such as a system name for the switch, global bridge parameters, and various wait time intervals. When ISIS&#x2D;SPB is enabled for the switch, default settings for these global bridge parameters and wait time intervals are active. It is only necessary to change these values if the default settings are not sufficient. See <a  href="#XREF_47017__Configuring_Global_ISIS-SPB_Parameters163" style="color:#0000ff;background-color:transparent;">Configuring Global ISIS-SPB Parameters</a>.</p><p class="text" id="1125540">For more information about SPBM commands, see <a href="../c_spb/c_spb.htm#XREF_87962__24_Shortest_Path_Bridging_Commands" style="color:#0000ff;background-color:transparent;">Chapter 9&#44; Shortest Path Bridging Commands&#44;</a> in the <span class="Times_italics" data-keyref="CLI Reference Guide" style="font-family : Times New Roman ; font-weight:normal;font-style:Italic;font-size : 10.50pt;text-decoration:none;font-kerning:none;text-transform:none;font-stretch:normal;color:#000000;background-color:transparent;letter-spacing : 0.00em;">OmniSwitch AOS Release 8 CLI Reference Guide</span>.</p><p class="heading2" id="1124920"><a id="XREF_91075__Configure_SPBM_Services163" name="XREF_91075__Configure_SPBM_Services163">Configure SPBM Services</a></p><p class="text" id="1125344"><a id="163_text_1125344" name="163_text_1125344"></a>The OmniSwitch Service Manager application is used to configure the services layer of the SPBM network topology. A service is defined by a specific set of logical entities that are configured only on the backbone edge bridges (BEBs) of the network. The following configuration steps are required to define a service&#x2D;based architecture for an SPBM network&#x3A;</p><p class="step_first" id="1124910"><span class="Futura_Bold">1&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Create an SPBM service. </span>A Service Manager service ID is associated with a BVLAN, a backbone service instance identifier (I&#x2D;SID), and a service access point (SAP) to identify the customer traffic that the service will tunnel through the provider network. See <a  href="#XREF_91138__Creating_a_VPLS_Service163" style="color:#0000ff;background-color:transparent;">Creating an SPB Service</a>.</p><p class="step_next" id="1125405"><span class="Futura_Bold">2&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Configure access (customer&#x2D;facing) ports. </span>One or more access ports are associated with a service access point (SAP) to identify to the service which ports will receive customer traffic that the service will process for tunneling through the provider network. When an access port is associated with a SAP, the SAP parameter attributes are applied to traffic received on the access port. See <a  href="#XREF_39304__Configuring_Service_Access_Ports163" style="color:#0000ff;background-color:transparent;">Configuring Service Access Ports</a>.</p><p class="step_next" id="1125409"><span class="Futura_Bold">3&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Define access port profile attributes</span>. A default Layer 2 profile is automatically assigned to an access port at the time the port is configured as an access port. This profile determines how control frames received on the port are processed. It is only necessary to configure a Layer 2 profile if the default attribute values are not sufficient. See <a  href="#XREF_64148__Configuring_Layer_2_Profiles_for_Access_Ports163" style="color:#0000ff;background-color:transparent;">Configuring Layer 2 Profiles for Access Ports</a>.</p><p class="step_next" id="1118450"><span class="Futura_Bold">4&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Configure an SPB service access point (SAP). </span>A SAP binds an SPB service to an access (customer&#x2D;facing) port and defines which customer traffic to tunnel through the service. Each SAP is associated to one service name, but a single service can have multiple SAPs to which it is associated. See <a  href="#XREF_75835__Configuring_Service_Access_Points_(SAPs)163" style="color:#0000ff;background-color:transparent;">Configuring Service Access Points (SAPs)</a>.</p><p class="text" id="1125435">To define a Remote Fault Propagation (RFP) domain to monitor SPB services, see <a  href="#XREF_32410__Configuring_Remote_Fault_Propagation_for_SPBM163" style="color:#0000ff;background-color:transparent;">Configuring Remote Fault Propagation for SPBM</a>.</p><p class="text" id="1164733">For more information about Service Manager commands, see <a href="../c_svcmgr/c_svcmgr.htm#XREF_48407__50_Service_Manager_Commands" style="color:#0000ff;background-color:transparent;">Chapter 10&#44; Service Manager Commands&#44;</a> in the <span class="Times_italics" data-keyref="CLI Reference Guide" style="font-family : Times New Roman ; font-weight:normal;font-style:Italic;font-size : 10.50pt;text-decoration:none;font-kerning:none;text-transform:none;font-stretch:normal;color:#000000;background-color:transparent;letter-spacing : 0.00em;">OmniSwitch AOS Release 8 CLI Reference Guide</span>.</p><p class="heading2" id="1125520">SPB Configuration Guidelines</p><p class="text" id="1126009">Configuring an SPBM network topology involves setting up two layers of functionality&#x3A; the ISIS&#x2D;SPB backbone infrastructure and the Provider Backbone Bridge (8&#x30;2.1ah) services layer for MAC&#x2D;in&#x2D;MAC encapsulation. Review the guidelines in this section before attempting to configure the various components of the SPBM infrastructure and services.</p><p class="heading3" id="1120091">ISIS&#x2D;SPB</p><p class="text" id="1120096">This implementation of the ISIS&#x2D;SPB protocol supports only a single topology with a multi&#x2D;topology identifier (MT&#x2D;ID) of zero. </p><p class="bullet" id="1128452"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The ISIS&#x2D;SPB protocol instance is independent of IP IS&#x2D;IS, or other network layer protocol identifiers (NLPIDs) riding in the same IS&#x2D;IS implementation. However, ISIS&#x2D;SPB and IP IS&#x2D;IS can coexist on the same switch.</p><p class="bullet" id="1128454"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>ISIS&#x2D;SPB interfaces, link state packet databases (LSPDB), and forwarding information are all created and maintained within the single ISIS&#x2D;SPB instance.</p><p class="bullet" id="1128487"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>IS&#x2D;IS Level 1 point&#x2D;to&#x2D;point adjacencies are supported; Level 2 is not supported at this time.</p><p class="bullet" id="1135273"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB interfaces are associated with a link metric cost that is configurable, thus providing the ability to change the logical topology created by the ISIS&#x2D;SPB instance. However, if different metric values are configured on each side of a link, ISIS&#x2D;SPB will choose the higher&#x2D;valued one as the metric to use for both sides. This is necessary to enforce the symmetry of SPT calculations in both directions across the link.</p><p class="bullet" id="1135276"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Enabling SPB for the switch automatically triggers the transmission of Hello packets from the SPB interfaces, thus starting the process of discovery and forming adjacencies to build shortest path trees.</p><p class="heading3" id="1127041"><span style="font-size : 14.00pt;"><a id="XREF_52388__Configuring_VLAN_Bridge_Priority163" name="XREF_52388__Configuring_VLAN_Bridge_Priority163" style="font-size : 14.00pt;"></a></span>Backbone VLANs</p><p class="bullet" id="1127042"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The backbone VLAN (BVLAN) configuration must be the same on each SPB switch within the PBB network.For example, if BVLAN 1&#x30; with an ECT ID of 1 is configured on one switch, then BVLAN 1&#x30; with an ECT ID of 1 must exist on all other SPB bridges in the network to ensure proper calculation of the ISIS&#x2D;SPB shortest path trees through the backbone.</p><p class="bullet" id="1319956"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>In most cases, one BVLAN is sufficient for virtualizing traffic through the network backbone. However, configuring more than one BVLAN provides alternate routes for tunneling customer traffic. This can also provide a form of load balancing by distributing traffic over different BVLAN segments. </p><p><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If more than one BVLAN is needed, configure each BVLAN with a different ECT algorithm ID. For example, if two BVLANs (BVLAN 4&#x30;&#x30;1 and BVLAN 4&#x30;&#x30;2) are needed for a specific SPBM topology, then create BVLAN 4&#x30;&#x30;1 with ECT ID 1 and BVLAN 4&#x30;&#x30;2 with ECT ID 2 on each switch that is going to participate in the topology.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="124.00px"><td><p class="CellBody_note_text" id="1319960"><span class="Bold">Notes&#x3A;  </span><br/></p><p class="CellBody_note_bullet" id="1319965"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When adding another BVLAN to an existing SPBM topology instance, create the new BVLAN and its associated ECT ID on every switch first, then configure the SPB service association for the BVLAN. Creating SPB services before the BVLAN configuration is complete on all switches can cause problems with forming adjacencies or may even cause an SPB switch to drop existing adjacencies.</p><p class="CellBody_note_bullet" id="1319974"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Limiting the number of BVLANs to a maximum of four is highly recommended to improve SPB network scalability and convergence time.</p></td></tr></table></div></p><p class="bullet" id="1127046"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>All encapsulated traffic within the BVLAN domain is unicast with resolved source and destination BMAC addresses. Frames received on BVLAN ports that do not have an incoming source MAC address pre&#x2D;programmed by ISIS&#x2D;SPB are discarded.</p><p class="heading3" id="1322781"><a id="XREF_10241__SPB_Network_Scalability_and_Convergence163" name="XREF_10241__SPB_Network_Scalability_and_Convergence163">SPB Network Scalability and Convergence</a></p><p class="text" id="1322782"><a id="163_text_1322782" name="163_text_1322782"></a>Typically, the number of BVLANs configured is determined by the number of ECT paths required. Although multiple BVLANs can be created, it is highly recommended to limit the number BVLANs to a maximum of four. Doing so reduces the scale of address updates across the control plane and improves network scalability, stability, and convergence.</p><p class="text" id="1322783">If there are more than four BVLANs configured in the SPB network, the number of BVLANs can be reduced by removing unused BVLANs and, if necessary, consolidating SPB services that are distributed across more than four BVLANs.</p><p class="heading4" id="1322786">Removing Unused BVLANs</p><p class="text" id="1323678">Removing unused BVLANs is not a local task that is done on just one specific switch, as a BVLAN is configured on all participating SPB switches in the network. To remove a BVLAN, first check to see if the BVLAN is idle or active. This is done by checking to see if the BVLAN is attached to an SPB service. </p><p class="text" id="1324372">If the BVLAN is attached to a service on the local switch or through any other switch in the network, it is considered active and cannot be deleted. The service attachment does not have to be to the local BVLAN ID. It can be to the same BVLAN ID on any other SPB switch. </p><p class="text" id="1323894">To check whether a BVLAN is active or idle, use the <a href="../c_spb/c_spb.htm#XREF_92652__show_spb_isis_bvlans" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis bvlans</a> command. For example&#x3A;</p><p class="screen" id="1324411">&#x2D;&#x3E; show spb isis bvlans</p><p class="screen2" id="1324412">SPB ISIS BVLANS&#x3A;</p><p class="screen2" id="1324413">                                   Services  Num    Tandem     Root Bridge</p><p class="screen2" id="1324414"> BVLAN   ECT&#x2D;algorithm     In Use  mapped    ISIDS  Multicast  (Name &#x3A; MAC Address)</p><p class="screen2" id="1324415">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1324416">  4&#x30;&#x30;&#x30;  &#x30;&#x30;&#x2D;8&#x30;&#x2D;c2&#x2D;&#x30;1       YES     YES           1  SGMODE</p><p class="screen2" id="1324417">  4&#x30;&#x30;1  &#x30;&#x30;&#x2D;8&#x30;&#x2D;c2&#x2D;&#x30;2       YES     YES           1  SGMODE</p><p class="screen2" id="1324418">  4&#x30;&#x30;2  &#x30;&#x30;&#x2D;8&#x30;&#x2D;c2&#x2D;&#x30;3       NO      NO            &#x30;  SGMODE</p><p class="screen2" id="1324407">  4&#x30;&#x30;3  &#x30;&#x30;&#x2D;8&#x30;&#x2D;c2&#x2D;&#x30;4       NO      NO            &#x30;  SGMODE</p><p class="screen2" id="1324456"><br/></p><p class="screen2" id="1324441">BVLANs&#x3A;    4</p><p class="text" id="1324745">If a &#x201c;YES&#x201d; appears in the &#x201c;In Use&#x201d; column, a service is attached to the BVLAN ID. Because this is a network&#x2D;wide view, the BVLAN is active even if the service is not configured locally on the switch. A remote switch may have a service attached to the same BVLAN ID, while the local switch serves as a transit switch for the active BVLAN. </p><p class="text" id="1323446">If a &#x201c;NO&#x201d; appears in the &#x201c;In Use&#x201d; column, the BVLAN is idle and can be deleted without having to remove any associated SPB service objects. In the above <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show spb isis bvlans</span> example, BVLANs 4&#x30;&#x30;2 and 4&#x30;&#x30;3 are idle. To delete one or both of these BVLANs, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <a href="../c_spb/c_spb.htm#XREF_44597__vlan" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb bvlan</a> command. For example&#x3A;</p><p class="example1" id="1325965">&#x2D;&#x3E; no spb bvlan 4&#x30;&#x30;2</p><p class="example2" id="1326001">&#x2D;&#x3E; no spb bvlan 4&#x30;&#x30;3</p><p class="text" id="1327547">Removing idle BVLANs will not have any effect on the SPB network.</p><p class="heading4" id="1326139">Consolidating SPB Services</p><p>If SPB services are distributed across more than four BVLANs, consolidating the services across four or less BVLANs is recommended. This process involves deleting active BVLANs, which cannot be done without first removing the service objects (service IDs, SAPs) that are associated with the BVLAN.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="54.00px"><td><p class="CellBody_note_text" id="1327385"><span class="Times_Bold">Note.  </span>The SPB service association with a BVLAN cannot be changed on the fly, so the service ID and SAP have to be completely removed. As a result, there will be service down time until the service ID and SAP are configured again on a different BVLAN.</p></td></tr></table></div></p><p class="text" id="1326754">Refer to <a  href="#XREF_91075__Configure_SPBM_Services163" style="color:#0000ff;background-color:transparent;">Configure SPBM Services</a> for more information about creating and removing SPB service objects.</p><p class="heading2" id="1078503"><a id="XREF_68262__Configuring_BVLANs163" name="XREF_68262__Configuring_BVLANs163">Configuring BVLANs</a></p><p class="text" id="1126388"><a id="163_text_1126388" name="163_text_1126388"></a>The SPBM <a id="index_1135448" name="index_1135448"></a><a data-indexterm="backbone%20VLAN" id="backbone_VLAN" name="backbone_VLAN"></a><a data-indexterm="Shortest%20Path%20Bridging:BVLAN" id="Shortest_Path_Bridging_BVLAN" name="Shortest_Path_Bridging_BVLAN"></a>backbone VLAN (BVLAN) provides the foundation on which ISIS&#x2D;SPB shortest path trees are built and SPBM services tunnel encapsulated customer data through the Provider Backbone Bridge network (PBBN). Configuring a BVLAN on a switch is also the first step in setting up the ISIS&#x2D;SPB infrastructure and in making an OmniSwitch an SPB&#x2D;capable node.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="54.00px"><td><p class="CellBody_note_text" id="1143401"><span class="Bold">Note.  </span>The BVLAN configuration must be the same on each OmniSwitch that is going to participate in the SPBM network topology. So if BVLAN 4&#x30;&#x30;1 is created on one switch, then BVLAN 4&#x30;&#x30;1 must be created on all other switches in the SPBM network. </p></td></tr></table></div></p><p class="text" id="1126392">To create a BVLAN, use the <a id="index_1192877" name="index_1192877"></a><a data-indexterm="%3Cindex%3Espb%20bvlan%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_bvlan%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_bvlan%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_44597__vlan" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb bvlan</a> command with the optional <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">name</span> parameter. For example&#x3A;</p><p class="example1" id="1126396">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1 name spb&#x2D;4&#x30;&#x30;1</p><p class="text" id="1126415">If the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">name</span> parameter is not specified with this command, the VLAN ID is used for the name by default. For example, the following command creates BVLAN 4&#x30;&#x30;1 with &#x201c;VLAN 4&#x30;&#x30;1&#x201d; as the name&#x3A;</p><p class="example1" id="1126456">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="text" id="1132025">To remove a BVLAN, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb bvlan</span> command. For example&#x3A;</p><p class="example1" id="1132026">&#x2D;&#x3E; no spb bvlan 4&#x30;&#x30;1</p><p class="heading3" id="1126611">Assigning the Equal Cost Tree ID</p><p class="text" id="1126615">ISIS&#x2D;SPB calculations may result in multiple paths of equal costs. The Equal Cost Tree (ECT) ID specifies a tie&#x2D;breaking algorithm that is used when ISIS&#x2D;SPB is calculating a set of shortest path trees from one switch to all other switches in the SPB domain. When a BVLAN is created, an ECT ID is automatically assigned to the BVLAN. If it is the first BVLAN created on the switch, ECT ID 1 is assigned, otherwise the next available ID number is used. </p><p class="text" id="1127081">Each BVLAN created must be duplicated on all other participating switches in the SPBM network and must use the same ECT ID number for that BVLAN on each switch. A BVLAN created on one switch may not be automatically assigned the same ECT ID on another switch. As a result, it may be necessary to modify the ECT ID number using the<a id="index_1192882" name="index_1192882"></a><a data-indexterm="%3Cindex%3Espb%20isis%20bvlan%20ect-id%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_bvlan_ect-id%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_bvlan_ect-id%3Cdefault_para_font%3E_command"></a>&#160;<a href="../c_spb/c_spb.htm#XREF_40021__spb_isis_bvlan_ect-id" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis bvlan ect-id</a> command. For example&#x3A;</p><p>&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 ect&#x2D;id 2<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="70.00px"><td><p class="CellBody_note_text" id="1290381"><span class="Bold">Note.  </span>When adding another BVLAN to an existing SPBM topology instance, create the new BVLAN and its associated ECT ID on every switch first, then configure the SPB service association for the BVLAN. Creating SPB services before the BVLAN configuration is complete on all switches can cause problems with forming adjacencies or may even cause an SPB switch to drop existing adjacencies.</p></td></tr></table></div></p><p class="heading3" id="1126416">Configuring the Control BVLAN</p><p class="text" id="1126682">One of the BVLANs configured on each switch serves as the Control BVLAN for the ISIS&#x2D;SPB instance. The Control BVLAN exchanges ISIS&#x2D;SPB control packets with neighboring SPB switches on behalf of all BVLANs configured on the local switch. The control packets are tagged with the Control BVLAN ID.</p><p class="text" id="1127114">To designate a BVLAN as the Control BVLAN, use the <a id="index_1192887" name="index_1192887"></a><a data-indexterm="%3Cindex%3Espb%20isis%20control-bvlan%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_control-bvlan%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_control-bvlan%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_48955__spb_isis_control-bvlan" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis control-bvlan</a> command. For example&#x3A;</p><p class="example1" id="1127110">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;2</p><p class="text" id="1127116">A Control BVLAN also carries regular encapsulated SPB domain traffic in addition to ISIS&#x2D;SPB control packets. In other words, a VLAN can serve as both a regular BVLAN and a Control BVLAN at the same time. </p><p class="heading4" id="1256750">Configuring an IP Interface on the Control BVLAN</p><p class="text" id="1256751">To configure an IP interface on the Control BVLAN to support in&#x2D;band management access in the SPBM domain, use the <span class="blue_bold" style="font-weight:Bold;color:#0000ff;background-color:transparent;">ip interface</span> command. (See <a  href="#XREF_52604__SPB_In-Band_Management163" style="color:#0000ff;background-color:transparent;">SPB In-Band Management</a> for more information.)</p><p class="text" id="1256752">In the following example, an IP interface is configured for Control BVLAN 4&#x30;&#x30;2&#x3A;</p><p class="example1" id="1256753">&#x2D;&#x3E; ip interface &quot;spb&#x2D;mgmt&quot; address 1&#x30;.1.1.1&#47;24 vlan 4&#x30;&#x30;2</p><p class="text" id="1256746">Only one Control BVLAN can be configured on a switch, and only IPv4 interface is supported. ISIS&#x2D;SPB is the only protocol supported in the IP BVLAN domain for exchanging or advertising IP routing information. No other routing protocol (including VRRP) is supported.</p><p class="heading3" id="1126681">Configuring the Tandem Multicast Mode</p><p class="text" id="1127124">The tandem multicast mode (&#x2A;,G) or (S,G) of a BVLAN is applied only to SPB services associated with the BVLAN that are using tandem replication for multicast traffic. When a BVLAN is created, the (S,G) tandem multicast mode is applied by default. </p><p class="text" id="1127131">To change the tandem multicast mode for a BVLAN, use the <a id="index_1192892" name="index_1192892"></a><a data-indexterm="%3Cindex%3Espb%20isis%20bvlan%20tandem-multicast-mode%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_bvlan_tandem-multicast-mode%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_bvlan_tandem-multicast-mode%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_32089__spb_isis_bvlan_tandem-multicast-mode" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis bvlan tandem-multicast-mode</a> command and specify either <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">gmode</span> (&#x2A;,G) or <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">sgmode</span> (S,G). For example&#x3A;</p><p class="example1" id="1127135">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 tandem&#x2D;multicast&#x2D;mode sgmode</p><p class="example2" id="1321445">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;2 tandem&#x2D;multicast&#x2D;mode gmode</p><p class="heading3" id="1321452">Verifying the BVLAN Configuration</p><p class="text" id="1131987">To view the BVLAN configuration for the switch, use the <a id="index_1192897" name="index_1192897"></a><a data-indexterm="%3Cindex%3Eshow%20spb%20isis%20bvlans%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_spb_isis_bvlans%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_spb_isis_bvlans%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_92652__show_spb_isis_bvlans" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis bvlans</a> command. For example&#x3A;</p><p class="screen" id="1151196">&#x2D;&#x3E; show spb isis bvlans</p><p class="screen2" id="1131989">SPB ISIS BVLANS&#x3A;</p><p class="screen2" id="1131990">                                   Services  Num    Tandem     Root Bridge</p><p class="screen2" id="1131991"> BVLAN   ECT&#x2D;algorithm     In Use  mapped    ISIDS  Multicast  (Name &#x3A; MAC Address)</p><p class="screen2" id="1131992">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1131993">  4&#x30;&#x30;1  &#x30;&#x30;&#x2D;8&#x30;&#x2D;c2&#x2D;&#x30;1       YES     YES          52  SGMODE</p><p class="screen2" id="1131994">  4&#x30;&#x30;2  &#x30;&#x30;&#x2D;8&#x30;&#x2D;c2&#x2D;&#x30;2       YES     YES          51  GMODE</p><p class="screen2" id="1256984"><br/></p><p class="screen2" id="1131998">BVLANs&#x3A; 2</p><p class="text" id="1131999">The BVLAN is a special type of VLAN that is created and maintained by VLAN Manager. As a result, it also appears in the VLAN Manager <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show</span> command displays. For example, in the following <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show vlan</span> output display, VLANs 4&#x30;&#x30;1 through 4&#x30;&#x30;4 are included and &#x201c;spb&#x201d; appears in the &#x201c;type&#x201d; column&#x3A;</p><p class="screen2" id="1151206">&#x2D;&#x3E; show vlan</p><p class="screen2" id="1132001"> vlan  type  admin  oper  ip   mtu   name</p><p class="screen2" id="1132002">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1132003">   1   std    Dis   Dis   Dis  15&#x30;&#x30;   VLAN 1</p><p class="screen2" id="1132004">1&#x30;&#x30;&#x30;   std    Ena   Ena   Ena  15&#x30;&#x30;   VLAN 1&#x30;&#x30;&#x30;</p><p class="screen2" id="1132005">4&#x30;&#x30;1   spb    Ena   Ena   Dis  1524   VLAN 4&#x30;&#x30;1</p><p class="screen2" id="1132006">4&#x30;&#x30;2   spb    Ena   Ena   Dis  1524   VLAN 4&#x30;&#x30;2</p><p class="screen2" id="1132007">4&#x30;&#x30;3   spb    Ena   Ena   Dis  1524   VLAN 4&#x30;&#x30;3</p><p class="screen2" id="1132008">4&#x30;&#x30;4   spb    Ena   Ena   Dis  1524   VLAN 4&#x30;&#x30;4</p><p class="screen2" id="1132009">4&#x30;94   mcm    Ena   Dis   Dis  9198   MCM IPC</p><p class="text" id="1131982">To view configuration information for an individual BVLAN, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show vlan</span> command and specify the BVLAN ID. For example&#x3A;</p><p class="screen2" id="1132039"><br/></p><p class="screen2" id="1151212">&#x2D;&#x3E; show vlan 4&#x30;&#x30;1</p><p class="screen2" id="1132040">Name                     &#x3A; VLAN 4&#x30;&#x30;1,</p><p class="screen2" id="1132041">Type                     &#x3A; Backbone vlan,</p><p class="screen2" id="1132042">Administrative State     &#x3A; enabled,</p><p class="screen2" id="1132043">Operational State        &#x3A; disabled,</p><p class="screen2" id="1132044">IP Router Port           &#x3A; disabled,</p><p class="screen2" id="1132037">IP MTU                   &#x3A; 1524</p><p class="heading2" id="1131220"><a id="XREF_64170__Configuring_SPB_Interfaces163" name="XREF_64170__Configuring_SPB_Interfaces163">Configuring SPB Interfaces</a></p><p class="text" id="1131221"><a id="163_text_1131221" name="163_text_1131221"></a>A port or link aggregate is configurable as an SPB interface. Each switch in the SPBM topology should have at least one SPB interface configured. The SPB interface serves more than one purpose&#x3A;</p><p class="bullet" id="1131222"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Advertises IS&#x2D;IS Hello packets to discover SPB neighbors and establish adjacencies.</p><p class="bullet" id="1131223"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>After adjacencies are established, exchanges link state packets (LSPs) with SPB neighbors to build a local LSP database (LSPDB). A switch&#x2019;s adjacencies are reflected in the contents of its link state packets. This relationship between adjacencies and link state allows the protocol to detect downed routers in a timely fashion.</p><p class="bullet" id="1131224"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Serves as a network port by forwarding encapsulated SPB service traffic on backbone VLANs (BVLANs) through the SPBM Provider Backbone Bridge (PBB) network.</p><p class="text" id="1131228">To configure a port or link aggregate as SPB interface, use the <a id="index_1192902" name="index_1192902"></a><a data-indexterm="%3Cindex%3Espb%20isis%20interface%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_interface%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_interface%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a> command. For example&#x3A;</p><p class="example1" id="1131229">&#x2D;&#x3E; spb isis interface port 1&#47;1&#x30;</p><p class="example2" id="1131230">&#x2D;&#x3E; spb isis interface linkagg 5</p><p class="text" id="1131231">When a port is converted to an SPB interface, the interface is automatically assigned to all existing BVLANs. There is one ISIS&#x2D;SPB instance per switch, and each BVLAN and SPB interface is associated with that instance. However, it is also possible to tag SPB interfaces to carry traffic for standard VLANs.</p><p class="text" id="1131232">The <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis interface </span>command is also used to optionally configure the following parameter values&#x3A;</p><p class="bullet" id="1131233"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">admin&#x2D;state&#x2014;</span>Administratively enables or disables the SPB interface. By default, the interface is enabled when the SPB interface is created.</p><p class="bullet" id="1131234"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">hello&#x2D;interval&#x2014;</span>Specifies the amount of time, in seconds, to wait between each transmission of a hello packet from this interface. By default, the hello time interval is set to nine seconds.</p><p class="bullet" id="1131235"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">hello&#x2D;multiplier&#x2014;</span>Specifies an integer value that is multiplied by the hello interval time to determine the amount of time, in seconds, a receiving bridge holds onto the hello packets transmitted from this interface. By default, the hello multiplier is set to three.</p><p class="bullet" id="1131236"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">metric</span>&#x2014;An integer value that specifies the link cost to reach the destination backbone MAC (BMAC), By default, the link cost is set to ten. Changing the link metric value provides a method for changing the logical topology as calculated by ISIS&#x2D;SPB. </p><p class="bullet" id="1288917"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">type</span>&#x2014;Specifies whether the SPB interface will operate as a point&#x2D;to&#x2D;point (P2P) network interface on which a single adjacency is formed or as a multiple access network interface on which multiple adjacencies are formed. By default, the interface type is set to P2P. Changing the interface type to multiple access facilitates extending an SPB network across a shared network.</p><p class="bullet" id="1288919"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">priority</span>&#x2014;Specifies a priority value that is used in a multiple access configuration to determine which interface will serve as a Designated Intermediate System (DIS). This value is only used when the SPB interface type is set to operate as a multiple access network interface. By default, the priority value is set to 64.</p><p class="text" id="1131237">The following command examples change the default parameter values for the SPB interface&#x3A;</p><p class="example1" id="1131238">&#x2D;&#x3E; spb isis interface port 1&#47;1&#47;7 hello&#x2D;interval 6&#x30;</p><p class="example2" id="1131239">&#x2D;&#x3E; spb isis interface linkagg 3 hello&#x2D;multiplier 1&#x30;</p><p class="example2" id="1131240">&#x2D;&#x3E; spb isis interface port 2&#47;1&#47;1 metric 1&#x30;&#x30;</p><p class="example2" id="1131241">&#x2D;&#x3E; spb isis interface linkagg 5 hello&#x2D;interval 2&#x30; hello&#x2D;multiplier 5 metric 2&#x30;&#x30;</p><p class="example2" id="1289954"><br/></p><p class="example2" id="1289956">&#x2D;&#x3E; spb isis interface port 2&#47;1&#47;7 type multi&#x2D;access priority 5&#x30;</p><p class="example2" id="1290092">&#x2D;&#x3E; spb isis interface port 2&#47;1&#47;7 type p2p</p><p class="example2" id="1290026">&#x2D;&#x3E; spb isis interface linkagg 1&#x30; type multi&#x2D;access priority 1&#x30;&#x30;</p><p class="example2" id="1290137">&#x2D;&#x3E; spb isis interface linkagg 1&#x30; type p2p</p><p class="heading3" id="1131218">Verifying the SPB Interface Configuration</p><p class="text" id="1132095">To view the SPB interface configuration for the switch, use the <a id="index_1192907" name="index_1192907"></a><a data-indexterm="%3Cindex%3Eshow%20spb%20isis%20interface%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_spb_isis_interface%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_spb_isis_interface%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_79870__show_ip_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis interface</a> command. For example&#x3A;</p><p class="screen2" id="1143480"><br/></p><p class="screen2" id="1151217">&#x2D;&#x3E; show spb isis interface</p><p class="screen2" id="1132102">SPB ISIS Interfaces&#x3A;</p><p class="screen2" id="1290261">                               Oper   Admin   Link     Hello   Hello   Circ</p><p class="screen2" id="1290189"> Interface      Level  CircID  state  state   Metric   Intvl   Mult    Type</p><p class="screen2" id="1290190">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1290191"> 1&#47;1&#47;1          L1      1       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1290192"> 1&#47;1&#47;2          L1      2       UP     UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1290193"> 1&#47;1&#47;3          L1      3       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1290194"> 1&#47;1&#47;4          L1      4       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1290195"> 1&#47;1&#47;5          L1      5       UP     UP      1&#x30;      3       3       multi&#x2D;access</p><p class="screen2" id="1290196"> 1&#47;1&#47;6          L1      6       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1290197"> 1&#47;1&#47;7          L1      7       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1290198"> 1&#47;1&#47;1&#x30;         L1      9       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1290184"><br/></p><p class="screen2" id="1132099">Interfaces &#x3A; 8</p><p class="heading2" id="1126647"><a id="XREF_47017__Configuring_Global_ISIS-SPB_Parameters163" name="XREF_47017__Configuring_Global_ISIS-SPB_Parameters163">Configuring Global ISIS&#x2D;SPB Parameters</a></p><p class="text" id="1127267"><a id="163_text_1127267" name="163_text_1127267"></a>This section describes the global configuration for the ISIS&#x2D;SPB instance, which includes the following&#x3A;</p><p class="bullet" id="1128354"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_71765__Enabling/Disabling_the_QoS_Manager163" style="color:#0000ff;background-color:transparent;">Configuring the System Name</a>.</p><p class="bullet" id="1127343"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_32630__Configuring_the_Bridge_Priority163" style="color:#0000ff;background-color:transparent;">Configuring the SPB Bridge Priority</a>.</p><p class="bullet" id="1127348"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_60948__Configuring_VLAN_Bridge_Hello_Time163" style="color:#0000ff;background-color:transparent;">Configuring the ISIS-SPB Area Address</a>.</p><p class="bullet" id="1127352"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_14106__Configuring_the_Multicast_Source_ID163" style="color:#0000ff;background-color:transparent;">Configuring the Shortest Path Source ID</a>.</p><p class="bullet" id="1139541"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_63598__Configuring_the_Control_MAC_Address163" style="color:#0000ff;background-color:transparent;">Configuring the Control MAC Address</a>.</p><p class="bullet" id="1128361"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_43110__Configuring_the_Shortest_Path_First_Wait_Time163" style="color:#0000ff;background-color:transparent;">Configuring the Shortest Path First Wait Time</a>.</p><p class="bullet" id="1128366"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_81292__Configuring_the_Link_State_Packet_Wait_Time163" style="color:#0000ff;background-color:transparent;">Configuring the Link State Packet Wait Time</a>.</p><p class="bullet" id="1131189"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_44432__Configuring_the_Overload_State163" style="color:#0000ff;background-color:transparent;">Configuring the Overload State</a>.</p><p class="bullet" id="1131179"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_31537__Configuring_Redundant_CMMs_for_Graceful_Restart163" style="color:#0000ff;background-color:transparent;">Configuring Redundant Switches for Graceful Restart</a>.</p><p class="bullet" id="1133980"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_67628__Enabling/Disabling_ISIS-SPB163" style="color:#0000ff;background-color:transparent;">Enabling&#47;Disabling ISIS-SPB</a>.</p><p class="text" id="1131183">To verify the global configuration parameter values for the switch, use the <a href="../c_spb/c_spb.htm#XREF_61081__show_ip_isis_status" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis info</a> command. For example&#x3A;</p><p class="screen2" id="1143499"><br/></p><p class="screen2" id="1151222">&#x2D;&#x3E; show spb isis info</p><p class="screen2" id="1127565">SPB ISIS Bridge Info&#x3A;</p><p class="screen2" id="1127566">  System Id             &#x3D; e8e7.3233.1831,</p><p class="screen2" id="1127567">  System Hostname       &#x3D; BEB&#x2D;1,</p><p class="screen2" id="1127568">  SPSourceID            &#x3D; &#x30;3&#x2D;18&#x2D;31,</p><p class="screen2" id="1127569">  SPBM System Mode      &#x3D; auto,</p><p class="screen2" id="1127570">  BridgePriority        &#x3D; 32768 (&#x30;x8&#x30;&#x30;&#x30;),</p><p class="screen2" id="1127571">  MT ID                 &#x3D; &#x30;,</p><p class="screen2" id="1127572">  Control BVLAN         &#x3D; 4&#x30;&#x30;1,</p><p class="screen2" id="1127573">  Area Address          &#x3D; &#x30;.&#x30;.&#x30;,</p><p class="screen2" id="1127574">  Level Capability      &#x3D; L1,</p><p class="screen2" id="1127575">  Admin State           &#x3D; UP,</p><p class="screen2" id="1127576">  LSDB Overload         &#x3D; Disabled,</p><p class="screen2" id="1127577">  Last Enabled          &#x3D; Thu Aug  2 22&#x3A;43&#x3A;19 2&#x30;12,</p><p class="screen2" id="1127578">  Last SPF              &#x3D; Fri Aug  3 18&#x3A;15&#x3A;51 2&#x30;12,</p><p class="screen2" id="1127579">  SPF Wait              &#x3D; Max&#x3A; 1&#x30;&#x30;&#x30; ms, Initial&#x3A; 1&#x30;&#x30; ms, Second&#x3A; 3&#x30;&#x30; ms,</p><p class="screen2" id="1127580">  LSP Lifetime          &#x3D; 12&#x30;&#x30;,</p><p class="screen2" id="1127581">  LSP Wait              &#x3D; Max&#x3A; 1&#x30;&#x30;&#x30; ms, Initial&#x3A; &#x30; ms, Second&#x3A; 3&#x30;&#x30; ms,</p><p class="screen2" id="1127582">  Graceful Restart      &#x3D; Disabled,</p><p class="screen2" id="1127583">  GR helper&#x2D;mode        &#x3D; Disabled,</p><p class="screen2" id="1127562">  &#x23; of L1 LSPs          &#x3D; 8</p><p class="screen2" id="1139536">  Control Address       &#x3D; &#x30;1&#x3A;8&#x30;&#x3A;C2&#x3A;&#x30;&#x30;&#x3A;&#x30;&#x30;&#x3A;14 (AllL1)</p><p class="heading3" id="1127337"><a id="XREF_71765__Enabling/Disabling_the_QoS_Manager163" name="XREF_71765__Enabling_Disabling_the_QoS_Manager163">Configuring the System Name</a></p><p class="text" id="1127541"><a id="163_text_1127541" name="163_text_1127541"></a>Configuring a system name is required on each switch that is going to participate in the SPBM topology. To configure a system name for the switch, use the <a href="../c_chassis/c_chassis.htm#XREF_28038__system_name" style="font-weight:Bold;color:#0000ff;background-color:transparent;">system name</a> command. For example&#x3A;</p><p class="example1" id="1127545">&#x2D;&#x3E; system name BEB&#x2D;1</p><p class="text" id="1127546">ISIS&#x2D;SPB advertises the system name to identify the switch to other SPB peer switches.</p><p class="heading3" id="1126642"><a id="XREF_32630__Configuring_the_Bridge_Priority163" name="XREF_32630__Configuring_the_Bridge_Priority163">Configuring the SPB Bridge Priority</a></p><p class="text" id="1078505"><a id="163_text_1078505" name="163_text_1078505"></a>A bridge is ranked within the SPB topology by its <a id="index_1078504" name="index_1078504"></a><a data-indexterm="Shortest%20Path%20Bridging:bridge%20ID" id="Shortest_Path_Bridging_bridge_ID" name="Shortest_Path_Bridging_bridge_ID"></a>bridge ID (an eight byte hex number). The <a id="index_1135420" name="index_1135420"></a><a data-indexterm="Shortest%20Path%20Bridging:bridge%20priority" id="Shortest_Path_Bridging_bridge_priority" name="Shortest_Path_Bridging_bridge_priority"></a>bridge priority value makes up the upper two bytes of the eight&#x2D;byte SPB bridge ID. The lower six bytes of the Bridge ID contain the <a id="index_1135428" name="index_1135428"></a><a data-indexterm="Shortest%20Path%20Bridging:system%20ID" id="Shortest_Path_Bridging_system_ID" name="Shortest_Path_Bridging_system_ID"></a>system ID, which is the dedicated bridge MAC address of the SPB bridge. </p><p class="text" id="1078507">The bridge priority is used in shortest path tree calculations. The lower the priority value, the higher the priority. Setting a different bridge priority value on different SPB bridges will override the system ID significance during the shortest path tree (SPT) calculation.</p><p class="text" id="1078514">By default, all SPB switches are assigned a priority value of 32768. To change the bridge priority value for a switch, use the <a id="index_1094791" name="index_1094791"></a><a data-indexterm="%3Cindex%3Espb%20isis%20bridge-priority%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_bridge-priority%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_bridge-priority%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_14166__spb_isis_bridge-priority" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis bridge-priority</a> command. For example&#x3A;</p><p class="example1" id="1078515">&#x2D;&#x3E; spb isis bridge&#x2D;priority 2559&#x30;</p><p class="heading3" id="1078547"><a id="XREF_60948__Configuring_VLAN_Bridge_Hello_Time163" name="XREF_60948__Configuring_VLAN_Bridge_Hello_Time163">Configuring the ISIS&#x2D;SPB Area Address</a></p><p class="text" id="1127688"><a id="163_text_1127688" name="163_text_1127688"></a>By default, the IS&#x2D;IS area address for the ISIS&#x2D;SPB instance is set to &#x30;.&#x30;.&#x30;, which is typically sufficient for this implementation of SPBM. Both ISIS&#x2D;SPB and ISIS&#x2D;IP instances may coexist on the same switch as long as they don&#x2019;t use the same area address. </p><p class="text" id="1127696">If changing the area address is necessary, use the <a id="index_1135450" name="index_1135450"></a><a data-indexterm="%3Cindex%3Espb%20isis%20area-address%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_area-address%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_area-address%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_30834__spb_isis_area-address" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis area-address</a> command. For example&#x3A;</p><p class="example1" id="1127700">&#x2D;&#x3E; spb isis area&#x2D;address 1.1.1</p><p><div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="38.00px"><td><p class="CellBody_note_text" id="1143511"><span class="Bold">Note.  </span>Each switch that is going to participate in the SPB topology must use the same area address and must use an address that is different from the ISIS&#x2D;IP area address.</p></td></tr></table></div></p><p class="heading3" id="1127190"><a id="XREF_14106__Configuring_the_Multicast_Source_ID163" name="XREF_14106__Configuring_the_Multicast_Source_ID163">Configuring the Shortest Path Source ID</a></p><p class="text" id="1127798"><a id="163_text_1127798" name="163_text_1127798"></a>The shortest path (SP) source ID, identifies the source of multicast frames and is relevant only in multicast tandem replication mode. By default, the last three least significant bytes of the system ID (local bridge MAC address) is used for the source ID value.</p><p class="text" id="1127803">To change the source ID value, use the <a id="index_1135451" name="index_1135451"></a><a data-indexterm="%3Cindex%3Espb%20isis%20source-id%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_source-id%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_source-id%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_29867__spb_isis_source-id" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis source-id</a> command. For example&#x3A;</p><p class="example1" id="1127761">&#x2D;&#x3E; spb isis source&#x2D;id &#x30;7&#x2D;&#x30;b&#x2D;d3</p><p class="text" id="1127767">To set the source ID back to the default value, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis source&#x2D;id</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">auto</span> parameter. For example&#x3A;</p><p class="example1" id="1127773">&#x2D;&#x3E; spb isis source&#x2D;id auto</p><p class="heading3" id="1139415"><a id="XREF_63598__Configuring_the_Control_MAC_Address163" name="XREF_63598__Configuring_the_Control_MAC_Address163">Configuring the Control MAC Address</a></p><p class="text" id="1139416"><a id="163_text_1139416" name="163_text_1139416"></a>The control MAC address is the destination MAC address used for ISIS&#x2D;SPB control packets. Changing this address can enhance interoperability between an SPB&#x2D;capable OmniSwitch and other third&#x2D;party SPB&#x2D;capable devices. </p><p class="text" id="1139436">By default, the control MAC address is set to &#x30;1&#x3A;8&#x30;&#x3A;C2&#x3A;&#x30;&#x30;&#x3A;&#x30;&#x30;&#x3A;14 (all Level 1 Intermediate Systems). The following parameters are used with the <a id="index_1192912" name="index_1192912"></a><a data-indexterm="%3Cindex%3Espb%20isis%20control-address%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_control-address%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_control-address%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_39787__spb_isis_control-address" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis control-address</a> command to change the control MAC address&#x3A;</p><p class="bullet" id="1139457"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">alll1</span>&#x2014;All Level 1 Intermediate Systems (&#x30;1&#x3A;8&#x30;&#x3A;C2&#x3A;&#x30;&#x30;&#x3A;&#x30;&#x30;&#x3A;14).</p><p class="bullet" id="1139474"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">alll2</span>&#x2014;All Level 2 Intermediate Systems (&#x30;1&#x3A;8&#x30;&#x3A;C2&#x3A;&#x30;&#x30;&#x3A;&#x30;&#x30;&#x3A;15).</p><p class="bullet" id="1139479"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">allis</span>&#x2014;All Intermediate Systems (&#x30;9&#x3A;&#x30;&#x30;&#x3A;2B&#x3A;&#x30;&#x30;&#x3A;&#x30;&#x30;&#x3A;&#x30;5).</p><p class="text" id="1139449">For example, the following command changes the default control MAC address from AllL1 to AllL2&#x3A;</p><p class="example1" id="1139422">&#x2D;&#x3E; spb isis control&#x2D;address alll2</p><p class="heading3" id="1127784"><a id="XREF_43110__Configuring_the_Shortest_Path_First_Wait_Time163" name="XREF_43110__Configuring_the_Shortest_Path_First_Wait_Time163">Configuring the Shortest Path First Wait Time</a></p><p class="text" id="1127831"><a id="163_text_1127831" name="163_text_1127831"></a>The <a id="index_1135452" name="index_1135452"></a><a data-indexterm="%3Cindex%3Espb%20isis%20spf-wait%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_spf-wait%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_spf-wait%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_57297__spb_isis_spf-wait" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis spf-wait</a> command is used to configure the time intervals between the first, second, and subsequent ISIS&#x2D;SPB shortest path first (SPF) calculations. </p><p class="text" id="1127993">Subsequent SPF calculations, if required, are generated at exponentially increasing intervals of the SPF second wait time interval until the maximum wait time interval value is reached. For example, if the second&#x2D;wait interval value is set to 1&#x30;&#x30;&#x30; milliseconds, then the next SPF calculation is triggered after 2&#x30;&#x30;&#x30; milliseconds and the next SPF calculation after that is triggered at 4&#x30;&#x30;&#x30; milliseconds, and so on, until the maximum&#x2D;wait interval value is reached.</p><p class="text" id="1127994">When the maximum interval value is reached, the SPF wait interval will stay at the maximum value until there are no more SPF calculations scheduled during that interval. After a full interval without any SPF calculations, the SPF wait interval will reset back to the initial wait time interval value.</p><p class="text" id="1127991">The following <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis spf&#x2D;wait </span>command parameters are used to configure the SPF timers&#x3A;</p><p class="bullet" id="1127885"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">max&#x2D;wait&#x2014;</span>The <span class="Times_italics" style="font-style:normal;background-color:transparent;">maximum number of milliseconds to wait </span>between two consecutive SPF calculations. The default maximum wait time value is set to 1&#x30;&#x30;&#x30; milliseconds. Specify a maximum value that is the same or greater than the second wait time value.</p><p class="bullet" id="1127886"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">initial&#x2D;wait&#x2014;</span>The number of milliseconds to wait before triggering an initial SPF calculation after a topology change. The default initial wait time value is set to 1&#x30;&#x30; milliseconds. Specify a value that is the same or less than the maximum wait time value.</p><p class="bullet" id="1127845"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">second&#x2D;wait&#x2014;</span>The number of milliseconds to wait between the first and second SPF calculation. The default second wait time value is set to 3&#x30;&#x30; milliseconds. Specify a value that is the same or less than the maximum wait time value.</p><p class="text" id="1127788">For example, the following command changes the SPF wait time values for the local SPB instance&#x3A;</p><p class="example1" id="1128009">&#x2D;&#x3E; spb isis spf&#x2D;wait max&#x2D;wait 25&#x30;&#x30; initial&#x2D;wait 1&#x30;&#x30;&#x30; second&#x2D;wait 15&#x30;&#x30;</p><p class="text" id="1128015">To change one or more of the wait time values, it is only necessary to specify the parameter for the desired change. For example&#x3A;</p><p class="example1" id="1128021">&#x2D;&#x3E; spb isis spf&#x2D;wait max&#x2D;wait 5&#x30;&#x30;&#x30;</p><p class="example2" id="1128022">&#x2D;&#x3E; spb isis spf&#x2D;wait initial&#x2D;wait 1&#x30;&#x30;&#x30;</p><p class="example2" id="1128023">&#x2D;&#x3E; spb isis spf&#x2D;wait second&#x2D;wait 2&#x30;&#x30;&#x30;</p><p class="text" id="1128034">To set the wait time values back to the default settings. use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis spf&#x2D;wait</span> command without specifying any of the parameters. For example&#x3A;</p><p class="example1" id="1128038">&#x2D;&#x3E; spb isis spf&#x2D;wait</p><p class="heading3" id="1128063"><a id="XREF_81292__Configuring_the_Link_State_Packet_Wait_Time163" name="XREF_81292__Configuring_the_Link_State_Packet_Wait_Time163">Configuring the Link State Packet Wait Time</a></p><p class="text" id="1128067"><a id="163_text_1128067" name="163_text_1128067"></a>The <a id="index_1135453" name="index_1135453"></a><a data-indexterm="%3Cindex%3Espb%20isis%20lsp-wait%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_lsp-wait%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_lsp-wait%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_37596__spb_isis_lsp-wait" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis lsp-wait</a> command is used to configure the time intervals between the first, second, and subsequently <span class="Times_Bold" style="font-weight:normal;background-color:transparent;">generated link state packets (LSPs)</span>. </p><p class="text" id="1128102">Subsequent LSP, if required, are generated at exponentially increasing intervals of the LSP second wait time interval until the maximum value is reached. For example, if the second&#x2D;wait interval value is set to 1&#x30; seconds, then the next LSP is generation is triggered after 2&#x30; seconds and the next LSP generated after that is triggered at 4&#x30; seconds, and so on, until the maximum wait time interval value is reached.</p><p class="text" id="1128103">When the maximum interval value is reached, the LSP wait interval will stay at the maximum value until there are no more LSP generations during that interval. After a full interval without any LSP generations, the LSP wait interval will reset back to the initial wait time interval value.</p><p class="text" id="1128070">The following <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis lsp&#x2D;wait </span>command parameters are used to configure the SPF timers&#x3A;</p><p class="bullet" id="1128071"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">max&#x2D;wait&#x2014;</span><span class="Times_italics" style="font-style:normal;background-color:transparent;">The maximum number of seconds to wait </span>between two consecutively generated LSPs. The default maximum wait time value is set to 1&#x30;&#x30;&#x30; milliseconds. Specify a maximum value that is the same or greater than the second wait time value.</p><p class="bullet" id="1128072"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">initial&#x2D;wait&#x2014;</span>The number of seconds to wait before triggering an initial LSP generation after a topology change. The default initial wait time value is set to &#x30; milliseconds. Specify a value that is the same or less than the maximum wait time value.</p><p class="bullet" id="1128073"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">second&#x2D;wait&#x2014;</span>The minimum number of seconds to wait between the first and second generated LSPs. The default second wait time value is set to 3&#x30;&#x30; milliseconds. Specify a value that is the same or less than the maximum wait time value.</p><p class="text" id="1128074">For example, the following command changes the LSP wait time values for the local SPB instance&#x3A;</p><p class="example1" id="1128158">&#x2D;&#x3E; spb isis lsp&#x2D;wait max&#x2D;wait 2&#x30;&#x30;&#x30; initial&#x2D;wait 1&#x30;&#x30;&#x30; second&#x2D;wait 15&#x30;&#x30;</p><p class="text" id="1128076">To change one or more of the wait time values, it is only necessary to specify the parameter for the desired change. For example&#x3A;</p><p class="example1" id="1128168">&#x2D;&#x3E; spb isis lsp&#x2D;wait max&#x2D;wait 5&#x30;&#x30;&#x30;</p><p class="example2" id="1128169">&#x2D;&#x3E; spb isis lsp&#x2D;wait initial&#x2D;wait 25&#x30;&#x30;</p><p class="example2" id="1128170">&#x2D;&#x3E; spb isis lsp&#x2D;wait second&#x2D;wait 3&#x30;&#x30;&#x30;</p><p class="text" id="1128080">To set the wait time values back to the default settings. use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis lsp&#x2D;wait</span> command without specifying any of the parameters. For example&#x3A;</p><p class="example1" id="1128081">&#x2D;&#x3E; spb isis lsp&#x2D;wait</p><p class="heading3" id="1132684"><a id="XREF_44432__Configuring_the_Overload_State163" name="XREF_44432__Configuring_the_Overload_State163">Configuring the Overload State</a></p><p class="text" id="1132775"><a id="163_text_1132775" name="163_text_1132775"></a>This implementation of ISIS&#x2D;SPB supports the overload state mechanism, which allows an instance of ISIS&#x2D;SPB to inform its neighbors that the instance is nearing or exceeding its capabilities. When peers see that a switch is advertising in this state, they will select an alternate path around the overloaded switch.</p><p class="text" id="1133904">The ISIS&#x2D;SPB instance for a switch may dynamically trigger the overload state condition when the instance detects that it is nearing or has reached resource limits. However, it is also possible to manually trigger the overload state condition using the <a id="index_1135454" name="index_1135454"></a><a data-indexterm="%3Cindex%3Espb%20isis%20overload%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_overload%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_overload%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_29160__ip_isis_overload" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis overload</a> command. For example&#x3A;</p><p class="example1" id="1133905">&#x2D;&#x3E; spb isis overload</p><p class="text" id="1133891">Some advantages of manually triggering the overload state condition, even if the instance is no where near its resource limits, are as follows&#x3A;</p><p class="bullet" id="1133920"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The switch is designated as &#x201c;leaf node&#x201d; that should never carry transit traffic. Configuring the link metric value for the SPB interfaces on the switch and attached peers is another method for preventing the switch from receiving transit traffic, but enabling the overload state is a much quicker way to achieve the same results and requires less configuration.</p><p class="bullet" id="1133929"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When there is a need to remove the switch from service (temporarily or permanently). In this scenario, network availability is increased because peer switches will detect the overload state of the switch and gracefully transition to alternate paths, while the &#x201c;manually overloaded&#x201d; switch continues to forward packets. Just simply shutting the switch down would cause more disruption to network traffic.</p><p class="text" id="1258767">When the overload state is either dynamically or manually enabled for the switch, the overload bit is set in LSP &#x30; to indicate that this ISIS&#x2D;SPB instance is not available to accept transit traffic. </p><p class="text" id="1258775">When the overload state is enabled, the switch will operate in this state for an infinite amount of time. To configure the switch to remain in the overload state for only a specific amount of time (in seconds), use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis overload</span> command with the optional <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">timeout</span> parameter. For example&#x3A;</p><p class="example1" id="1132723">&#x2D;&#x3E; spb isis overload timeout 5&#x30;&#x30;</p><p class="text" id="1132732">To disable the overload state, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis overload</span> command. For example&#x3A;</p><p class="example1" id="1132802">&#x2D;&#x3E; no spb isis overload</p><p class="text" id="1132793">It is also possible to specify that the overload state is enabled for the switch after every system bootup. This is done using the <a id="index_1135455" name="index_1135455"></a><a data-indexterm="%3Cindex%3Espb%20isis%20overload-on-boot%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_overload-on-boot%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_overload-on-boot%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_37698__spb_isis_overload-on-boot" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis overload-on-boot</a> command, which also has an optional <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">timeout</span> parameter. For example&#x3A;</p><p class="example1" id="1132764">&#x2D;&#x3E; spb isis overload&#x2D;on&#x2D;boot timeout 5&#x30;&#x30;</p><p class="text" id="1132770">To disable the overload&#x2D;on&#x2D;boot option, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis overload&#x2D;on&#x2D;boot</span> command. For example&#x3A;</p><p class="example1" id="1132816">&#x2D;&#x3E; no spb isis overload&#x2D;on&#x2D;boot timeout 5&#x30;&#x30;</p><p class="text" id="1132814">Note that the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no spb isis overload</span> command does not disable the overload&#x2D;on&#x2D;bootup option. </p><p class="heading3" id="1132151"><span style="font-size : 18.00pt;"><a id="XREF_31537__Configuring_Redundant_CMMs_for_Graceful_Restart163" name="XREF_31537__Configuring_Redundant_CMMs_for_Graceful_Restart163" style="font-size : 18.00pt;"></a></span>Configuring Redundant Switches for Graceful Restart</p><p class="text" id="1132152">By default, ISIS&#x2D;SPB graceful restart is enabled. When graceful restart is enabled, the switch can either be a helper (which helps a neighbor router to restart) or a restarting router, or both. When graceful restart is enabled on the switch, the helper mode is automatically enabled by default. </p><p class="text" id="1132159">To configure ISIS&#x2D;SPB graceful restart support on an OmniSwitch, use the <a id="index_1192917" name="index_1192917"></a><a data-indexterm="%3Cindex%3Espb%20isis%20graceful-restart%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_graceful-restart%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_graceful-restart%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_11235__spb_isis_graceful-restart" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis graceful-restart</a> command. For example, to configure graceful restart on the router, enter&#x3A;</p><p class="example1" id="1132160">&#x2D;&#x3E; spb isis graceful&#x2D;restart</p><p class="text" id="1132164">The helper mode can be disabled on the switch with the <a id="index_1192922" name="index_1192922"></a><a data-indexterm="%3Cindex%3Espb%20isis%20graceful-restart%20helper%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_graceful-restart_helper%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_graceful-restart_helper%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_16646__spb_isis_graceful-restart_helper" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis graceful-restart helper</a><span style="font-weight:Bold;">&#160;</span>command. For example, to disable the helper support for neighboring switches, enter the following&#x3A;</p><p class="example1" id="1132165">&#x2D;&#x3E; ip isis graceful&#x2D;restart helper disable</p><p class="text" id="1132166">To disable support for graceful restart, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span style="font-weight:Bold;">spb isis graceful&#x2D;restart</span> command. For example&#x3A; </p><p class="example1" id="1132167">&#x2D;&#x3E; no spb isis graceful&#x2D;restart</p><p class="heading3" id="1127607"><a id="XREF_67628__Enabling/Disabling_ISIS-SPB163" name="XREF_67628__Enabling_Disabling_ISIS-SPB163">Enabling&#47;Disabling ISIS&#x2D;SPB</a></p><p class="text" id="1127612"><a id="163_text_1127612" name="163_text_1127612"></a>By default ISIS&#x2D;SPB is disabled on the switch. To enable ISIS&#x2D;SPB, use the <a id="index_1127608" name="index_1127608"></a><a data-indexterm="%3Cindex%3Espb%20isis%20admin-state%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Espb_isis_admin-state%3Cdefault_para_font%3E_command" name="%3Cindex%3Espb_isis_admin-state%3Cdefault_para_font%3E_command"></a><a href="../c_spb/c_spb.htm#XREF_74387__spb_isis_status" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis admin-state</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">enable</span> option. For example&#x3A;</p><p class="example1" id="1127613" style="line-height : 9.00pt;">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="text" id="1127614">To disable the ISIS&#x2D;SPB instance on the switch, enter the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis admin&#x2D;state </span>command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">disable</span> option. When the ISIS&#x2D;SPB status s disabled for the switch, the related configuration settings and statistics are retained.</p><p class="example1" id="1127615">&#x2D;&#x3E; spb isis admin&#x2D;state disable</p><p><div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="54.00px"><td><p class="CellBody_note_text" id="1143549"><span class="Bold">Note.  </span>Enabling ISIS&#x2D;SPB on a switch starts the process of ISIS&#x2D;SPB discovery, adjacency building, and shortest path tree calculations. Make sure that the SPBM configuration is set up first, then enable ISIS&#x2D;SPB on each switch that will participate in the SPBM network.</p></td></tr></table></div></p><p class="heading2" id="1126032"><a id="XREF_91138__Creating_a_VPLS_Service163" name="XREF_91138__Creating_a_VPLS_Service163">Creating an SPB Service</a></p><p class="text" id="1126033"><a id="163_text_1126033" name="163_text_1126033"></a>An SPB service is identified by a service ID number, which represents an association between a backbone service instance identifier (I&#x2D;SID) and an existing BVLAN. Basically, creating an SPB service binds the backbone I&#x2D;SID to a BVLAN ID. All traffic mapped to the specific I&#x2D;SID is then encapsulated and forwarded on the associated BVLAN to the intended destination.</p><p class="text" id="1128720">The <a id="index_1135456" name="index_1135456"></a><a data-indexterm="%3Cindex%3Eservice%20spb%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_spb%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_spb%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_95469__service_spb" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service spb</a> command is used to create an SPB service. For example, the following command creates SPB service 1 and binds I&#x2D;SID 1&#x30;&#x30; to BVLAN 4&#x30;&#x30;1&#x3A;</p><p class="example1" id="1126037">&#x2D;&#x3E; service 1 spb isid 5&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p>The BVLAN ID specified with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service spb</span> command must already exist in the switch configuration. However, the I&#x2D;SID number specified creates a new I&#x2D;SID that is bound to the BVLAN for this service. <div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="70.00px"><td><p class="CellBody_note_text" id="1386085"><span class="Bold">Note.  </span>When adding another BVLAN to an existing SPBM topology instance, create the new BVLAN and its associated ECT ID on every switch first, then configure the SPB service association for the BVLAN. Creating SPB services before the BVLAN configuration is complete on all switches can cause problems with forming adjacencies or may even cause an SPB switch to drop existing adjacencies.</p></td></tr></table></div></p><p class="text" id="1386066">Use <a id="index_1386061" name="index_1386061"></a><a data-indexterm="%3Cindex%3Eservice%20spb%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_spb%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_spb%3Cdefault_para_font%3E_command"></a><span style="font-weight:Bold;">e&#x2D;tree</span> option in the <a id="index_1386062" name="index_1386062"></a><a data-indexterm="%3Cindex%3Eservice%20spb%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_spb%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_spb%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_95469__service_spb" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service spb</a> command to enable E&#x2D;Tree service on the SPB service. Configuring E&#x2D;Tree enables point&#x2D;to&#x2D;multipoint services, that is, allows traffic to flow only between Leaf to Root SAPs.</p><p class="text" id="1386067">For example&#x3A;</p><p class="text" id="1386026"><span style="font-family : Courier New ; font-size : 9.00pt;">&#x2D;&#x3E; service 1&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;1 e&#x2D;tree enable</span></p><p class="heading3" id="1126050">Modifying Default SPB Service Parameters</p><p>The following SPB service parameter values are set by default at the time the service is created. If necessary, use the specified commands to change the default values.<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="211.20px"/><col width="192.00px"/><col width="110.40px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1129120">Parameter Description</p></th><th><p class="CellHeading" id="1129122">Command</p></th><th><p class="CellHeading" id="1129124">Default</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1129126">Service description.</p></td><td><p class="CellBody" id="1129131" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_10587__service_spb_description" style="background-color:transparent;">service description</a></p></td><td><p class="CellBody" id="1129133">None</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1129135">Administrative status for statistics collection.</p></td><td><p class="CellBody" id="1129140" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_32744__service_spb_stats" style="background-color:transparent;">service stats</a></p></td><td><p class="CellBody" id="1129142">Disabled</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1129144">Multicast replication mode</p></td><td><p class="CellBody" id="1129149" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_69846__service_spb_multicast-mode" style="background-color:transparent;">service multicast-mode</a></p></td><td><p class="CellBody" id="1129151">head&#x2D;end</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1129153">VLAN translation</p></td><td><p class="CellBody" id="1129158" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_57097__service_spb_vlan-xlation" style="background-color:transparent;">service vlan-xlation</a></p></td><td><p class="CellBody" id="1129160">Disabled</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1132601">Administrative status of the service</p></td><td><p class="CellBody" id="1132603" style="font-weight:Bold;color:#0000ff;"><span style="font-weight:normal;color:#000000;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_55074__service_spb_admin-state" style="background-color:transparent;">service admin-state</a></span></p></td><td><p class="CellBody" id="1132605">Disabled</p></td></tr></table></div></p><p class="text" id="1126086">Refer to the <span class="Times_italics" data-keyref="CLI Reference Guide" style="font-family : Times New Roman ; font-weight:normal;font-style:Italic;font-size : 10.50pt;text-decoration:none;font-kerning:none;text-transform:none;font-stretch:normal;color:#000000;background-color:transparent;letter-spacing : 0.00em;">OmniSwitch AOS Release 8 CLI Reference Guide</span> for more information about the above parameters and related commands.</p><p class="heading4" id="1128959"><a id="XREF_65701__Using_VLAN_Translation163" name="XREF_65701__Using_VLAN_Translation163">Using VLAN Translation</a></p><p class="text" id="1128963"><a id="163_text_1128963" name="163_text_1128963"></a>VLAN translation refers to the egress translation of VLAN tags on service access points (SAPs). When enabled for a service, the VLAN tags for outgoing customer frames on SAPs associated with that service are processed according to the local SAP configuration (the SAP on which the frames will egress) and not according to the configuration of the SAP on which the frames were received.</p><p class="bullet" id="1128985"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If the local SAP is configured for untagged traffic (<span class="Times_italics" style="font-style:Italic;background-color:transparent;">slot&#47;port</span>&#x3A;&#x30;), the egress traffic is always sent out as untagged.</p><p class="bullet" id="1128997"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If the local SAP is configured for 8&#x30;2.1q&#x2D;tagged traffic (<span class="Times_italics" style="font-style:Italic;background-color:transparent;">slot&#47;port&#x3A;ctag</span>), the egress traffic is single&#x2D;tagged with the tag value specified by the <span class="Times_italics" style="font-style:Italic;background-color:transparent;">ctag</span> (customer VLAN tag) value.</p><p class="bullet" id="1128999"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If the local SAP is configured for double&#x2D;tagged traffic (<span class="Times_italics" style="font-style:Italic;background-color:transparent;">slot&#47;port&#x3A;outer_tag.&#x3A; inner_tag</span>), the egress traffic is double&#x2D;tagged with the tag values specified by the <span class="Times_italics" style="font-style:Italic;background-color:transparent;">outer_tag</span> and <span class="Times_italics" style="font-style:Italic;background-color:transparent;">inner_tag</span> values.</p><p class="text" id="1129337">When VLAN translation is disabled, frames simply egress without any modification of the VLAN tags. In other words, the frames are transparently bridged without tag modification.</p><p>The following table shows the required translation (tag is added or replaced) that takes place when the egress SAP configuration is applied to the possible frame types (untagged, tagged, double&#x2D;tagged). Note that in this table the terms &#x201c;ITAG&#x201d; and &#x201c;OTAG&#x201d; refer to inner tag and outer tag, respectively.<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="110.40px"/><col width="143.04px"/><col width="172.80px"/><col width="172.80px"/><thead><tr height="28.67px"><th rowspan="2"/><th colspan="3"><p class="CellHeading" id="1143623" style="text-align:center;">Egress SAP (action required based on SAP type)</p></th></tr><tr height="28.67px"><th style="border-left-width:0;border-left-style:hidden;border-left-color:0;border-bottom-width:0.5pt;border-bottom-style:solid;border-bottom-color:#000000;border-right-width:0;border-right-style:hidden;border-right-color:0;border-top-width:0.5pt;border-top-style:solid;border-top-color:#000000;"><p class="CellHeading" id="1143631">Untagged SAP</p></th><th style="border-left-width:0;border-left-style:hidden;border-left-color:0;border-bottom-width:0.5pt;border-bottom-style:solid;border-bottom-color:#000000;border-right-width:0;border-right-style:hidden;border-right-color:0;border-top-width:0.5pt;border-top-style:solid;border-top-color:#000000;"><p class="CellHeading" id="1143633">Single Tagged SAP</p></th><th style="border-left-width:0;border-left-style:hidden;border-left-color:0;border-bottom-width:0.5pt;border-bottom-style:solid;border-bottom-color:#000000;border-right-width:0;border-right-style:hidden;border-right-color:0;border-top-width:0.5pt;border-top-style:solid;border-top-color:#000000;"><p class="CellHeading" id="1143635">Double&#x2D;Tagged SAP</p></th></tr></thead><tr height="55.33px"><td style="border-bottom-width:2pt;border-bottom-style:solid;border-bottom-color:#000000;border-top-width:0.5pt;border-top-style:solid;border-top-color:#000000;"><p class="CellBody" id="1143637"><br/></p><p class="CellBody" id="1143638"><br/></p><p class="CellBody" id="1143639" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">Incoming Frame</span></p></td><td style="border-bottom-width:2pt;border-bottom-style:solid;border-bottom-color:#000000;border-top-width:0.5pt;border-top-style:solid;border-top-color:#000000;"><p class="CellBody" id="1143641"><br/></p><p class="CellBody" id="1143642">Remove OTAG</p><p class="CellBody" id="1143643">Remove ITAG</p></td><td style="border-bottom-width:2pt;border-bottom-style:solid;border-bottom-color:#000000;border-top-width:0.5pt;border-top-style:solid;border-top-color:#000000;"><p class="CellBody" id="1143645">Replace OTAG</p><p class="CellBody" id="1143646"><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Note</span>&#x3A; Replace &#x3D; implicit add</p><p class="CellBody" id="1143647">Remove ITAG</p></td><td style="border-bottom-width:2pt;border-bottom-style:solid;border-bottom-color:#000000;border-top-width:0.5pt;border-top-style:solid;border-top-color:#000000;"><p class="CellBody" id="1143649">Replace OTAG</p><p class="CellBody" id="1143650"><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">Note</span>&#x3A; Replace &#x3D; implicit add</p><p class="CellBody" id="1143651">Add&#47;Replace ITAG</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1143653">Untagged</p></td><td><p class="CellBody" id="1143655">No tags, no action taken</p></td><td><p class="CellBody" id="1143657">Add the SAP OTAG</p></td><td><p class="CellBody" id="1143659">Add the SAP OTAG </p><p class="CellBody" id="1143660">Add the SAP ITAG.</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1143662">Single&#x2D;tagged</p></td><td><p class="CellBody" id="1143664">Remove the OTAG</p></td><td><p class="CellBody" id="1143666">Replace the OTAG</p></td><td><p class="CellBody" id="1143668">Add ITAG</p><p class="CellBody" id="1143669">Replace OTAG</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1143671">Double&#x2D;tagged</p></td><td><p class="CellBody" id="1143673">Remove the ITAG</p><p class="CellBody" id="1143674">Remove the ITAG</p></td><td><p class="CellBody" id="1143676">Remove the ITAG</p><p class="CellBody" id="1143677">Replace the OTAG</p></td><td><p class="CellBody" id="1143679">Replace ITAG</p><p class="CellBody" id="1143680">Replace OTAG</p></td></tr></table></div></p><p>Enabling VLAN translation is required at two different levels&#x3A; first at the access port level and then at the service level. This activates VLAN translation for all of the SAPs on an access port that belong to the same service. The exception to this is on the OmniSwitch 99&#x30;&#x30;, where enabling VLAN translation is required only at the service level.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="86.00px"><td><p class="CellBody_note_text" id="1379885"><span class="Times_Bold">Note.  </span>Mixing switches with VLAN translation enabled on some and disabled on other switches in the same network is not recommended. When VLAN translation is enabled on a service, all the frames forwarded by the service are treated as untagged within the service domain; the tag is inserted only during egress. As a result, VLAN translation should be enabled for the service across all of the participating switches to prevent frames from egressing the service domain as untagged frames.</p></td></tr></table></div></p><p class="text" id="1144640">To enable translation at the service level, use the <a id="index_1135457" name="index_1135457"></a><a data-indexterm="%3Cindex%3Eservice%20vlan-xlation%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_vlan-xlation%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_vlan-xlation%3Cdefault_para_font%3E_command"></a><span style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_57097__service_spb_vlan-xlation" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service vlan-xlation</a></span><span style="font-weight:Bold;color:#0000ff;">&#160;</span>command. For example&#x3A;</p><p class="example1" id="1131091">&#x2D;&#x3E; service 1 vlan&#x2D;xlation enable</p><p class="text" id="1129061">To enable VLAN translation for all services, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">all</span> parameter with the service spb command. For example&#x3A;</p><p class="example1" id="1129070">&#x2D;&#x3E; service all vlan&#x2D;xlation enable</p><p class="text" id="1129068">To disable VLAN translation, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service vlan&#x2D;xlation</span> command with the disable parameter. For example&#x3A;</p><p class="example1" id="1129092">&#x2D;&#x3E; service 1 vlan&#x2D;xlation disable</p><p class="example2" id="1129098">&#x2D;&#x3E; service all vlan&#x2D;xlation disable</p><p class="text" id="1129084">To enable VLAN translation at the access port level, use the <a id="index_1135458" name="index_1135458"></a><a data-indexterm="%3Cindex%3Eservice%20access%20vlan-xlation%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_89704__service_access_vlan-xlation" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service access vlan-xlation</a> command. For example&#x3A;</p><p class="example1" id="1135046">&#x2D;&#x3E; service access port 1&#47;11 vlan&#x2D;xlation enable</p><p class="text" id="1135050">See <a  href="#XREF_39304__Configuring_Service_Access_Ports163" style="color:#0000ff;background-color:transparent;">Configuring Service Access Ports</a> for more information.</p><p class="heading3" id="1135051">Enable the Service</p><p class="text" id="1126088">By default, the SPB service is disabled when the service is created. Once the service is created and any optional service parameters are configured, use the <a id="index_1135459" name="index_1135459"></a><a data-indexterm="%3Cindex%3Eservice%20admin-state%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_admin-state%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_admin-state%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_55074__service_spb_admin-state" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service admin-state</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">enable</span> option to enable the service. For example&#x3A;</p><p class="example1" id="1126092">&#x2D;&#x3E; service 1 admin&#x2D;state enable</p><p class="text" id="1126093">To disable the service, enter the following command&#x3A;</p><p class="example1" id="1126094">&#x2D;&#x3E; service 1 admin&#x2D;state disable</p><p class="heading3" id="1126095">Deleting an SPB Service</p><p class="text" id="1126096">Before deleting a service from the switch configuration, disable the administrative status of the service. Once this is done, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <a href="../c_svcmgr/c_svcmgr.htm#XREF_95469__service_spb" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service spb</a> command to delete the service. For example&#x3A;</p><p class="example1" id="1126100">&#x2D;&#x3E; service 1 admin&#x2D;state disable</p><p class="example2" id="1379560">&#x2D;&#x3E; no service 1 spb</p><p class="heading3" id="1126111"><a id="XREF_67147__Configuring_a_VLAN_Stacking_Service_Access_Point_(SAP)163" name="XREF_67147__Configuring_a_VLAN_Stacking_Service_Access_Point_(SAP)163">Verifying the SPB Service Configuration</a></p><p class="text" id="1132179"><a id="163_text_1132179" name="163_text_1132179"></a>To view the SPB service configuration for the switch, use the <a id="index_1192931" name="index_1192931"></a><a data-indexterm="%3Cindex%3Eshow%20service%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_service%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_service%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_82323__show_service" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb</span> parameter option. For example&#x3A;</p><p class="screen2" id="1143695"><br/></p><p class="screen2" id="1151242">&#x2D;&#x3E; show service spb</p><p class="screen2" id="1132193">Legend&#x3A; &#x2A; denotes a dynamic object</p><p class="screen2" id="1132194">SPB Service Info</p><p class="screen2" id="1132195">  SystemId &#x3A; &#x30;&#x30;e&#x30;.b1e7.&#x30;188,   SrcId &#x3A; &#x30;x7&#x30;188,    SystemName &#x3A; BEB&#x2D;1</p><p class="screen2" id="1132196"><br/></p><p class="screen2" id="1132197">                            SAP     Bind                    MCast</p><p class="screen2" id="1132198">ServiceId   Adm  Oper Stats Count   Count   Isid      BVlan Mode     (T&#47;R)</p><p class="screen2" id="1132199">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1132200">1           Up   Up    N    4       1       1&#x30;&#x30;&#x30;      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132201">2           Up   Up    N    4       1       1&#x30;&#x30;1      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132202">3           Up   Up    N    4       1       1&#x30;&#x30;2      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132203">4           Up   Up    N    4       1       1&#x30;&#x30;3      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132204">5           Up   Up    N    4       1       1&#x30;&#x30;4      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132205">6           Up   Up    N    4       1       1&#x30;&#x30;5      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132206">7           Up   Up    N    4       1       1&#x30;&#x30;6      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132207">8           Up   Up    N    4       1       1&#x30;&#x30;7      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132208">9           Up   Up    N    4       1       1&#x30;&#x30;8      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="screen2" id="1132183">1&#x30;          Up   Up    N    4       1       1&#x30;&#x30;9      4&#x30;&#x30;1  Headend  (&#x30;&#47;&#x30;)</p><p class="text" id="1132175">To view the configuration for an individual service, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show service spb </span>command and specify the SPB service ID. For example&#x3A;</p><p class="screen2" id="1143701"><br/></p><p class="screen2" id="1151247">&#x2D;&#x3E; show service spb 1</p><p class="screen2" id="1132228">SPB Service Detailed Info</p><p class="screen2" id="1132229">  Service Id       &#x3A; 1,                    Description      &#x3A; ,</p><p class="screen2" id="1132230">  ISID             &#x3A; 1&#x30;&#x30;&#x30;,                 BVlan            &#x3A; 4&#x30;&#x30;1,</p><p class="screen2" id="1132231">  Multicast&#x2D;Mode   &#x3A; Headend,              Tx&#47;Rx Bits       &#x3A; &#x30;&#47;&#x30;,</p><p class="screen2" id="1132232">  Admin Status     &#x3A; Up,                   Oper Status      &#x3A; Up,</p><p class="screen2" id="1132233">  Stats Status     &#x3A; No,                   Vlan Translation &#x3A; No,</p><p class="screen2" id="1132234">  Service Type     &#x3A; SPB,                  Allocation Type  &#x3A; Static,</p><p class="screen2" id="1132235">  MTU              &#x3A; 9194,                 Def Mesh VC Id   &#x3A; 1,</p><p class="screen2" id="1132236">  SAP Count        &#x3A; 4,                    SDP Bind Count   &#x3A; 1,</p><p class="screen2" id="1132237">  Ingress Pkts     &#x3A; &#x30;,                    Ingress Bytes    &#x3A; &#x30;,</p><p class="screen2" id="1132238">  Egress Pkts      &#x3A; &#x30;,                    Egress Bytes     &#x3A; &#x30;,</p><p class="screen2" id="1132225">  Mgmt Change      &#x3A; &#x30;8&#47;1&#x30;&#47;2&#x30;12 13&#x3A;14&#x3A;43,  Status Change    &#x3A; &#x30;8&#47;1&#x30;&#47;2&#x30;12 13&#x3A;14&#x3A;&#x30;&#x30;</p><p class="heading2" id="1132171"><a id="XREF_75835__Configuring_Service_Access_Points_(SAPs)163" name="XREF_75835__Configuring_Service_Access_Points_(SAPs)163">Configuring Service Access Points (SAPs)</a></p><p class="text" id="1126112"><a id="163_text_1126112" name="163_text_1126112"></a>A SAP identifies the location where customer traffic enters the Provider Backbone Bridge Network (PBBN) edge, the type of customer traffic to service, parameters to apply to the traffic, and the service that will process the traffic for tunneling through the provider network.</p><p class="text" id="1126113">Configuring a SAP requires several steps. These steps are outlined here and further described throughout this section&#x3A;</p><p class="bullet" id="1126114"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configure customer&#x2D;facing ports or link aggregates as service access ports. </p><p class="bullet" id="1126116"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configure Layer 2 profiles to determine how control packets are processed on access ports.</p><p class="bullet" id="1126117"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Create a SAP by associating a SAP ID with an SPB service ID. A SAP ID is comprised of an access port and an encapsulation value, which is used to identify the type of customer traffic (untagged, single&#x2D;tagged, or double&#x2D;tagged) to map to the associated service.</p><p class="heading3" id="1126118">SAP Configuration Guidelines</p><p class="text" id="1126119">Consider the following when configuring a SAP&#x3A;</p><p class="bullet" id="1126120"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A SAP is a unique local entity for any given device. The same SAP ID value can be used on other BEB switches.</p><p class="bullet" id="1126121"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>There are no SAPs configured by default; explicit configuration of a SAP is required.</p><p class="bullet" id="1126122"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A SAP is administratively disabled at the time the SAP is created.</p><p class="bullet" id="1126123"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When a SAP is deleted, all configuration parameters for the SAP are also deleted.</p><p class="bullet" id="1144902"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A SAP is owned by and associated with the service that was specified at the time the SAP was created. </p><p class="bullet" id="1144959"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Multiple SAPs with different service types, such as a Virtual eXtensible LAN (VXLAN) or an SPB service, are allowed on the same service access port. For example, the following <a id="index_1192936" name="index_1192936"></a><a data-indexterm="%3Cindex%3Eshow%20service%20access%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_service_access%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_service_access%3Cdefault_para_font%3E_command"></a><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_98570__show_service_port" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service access</a></span><span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">&#160;</span>command output shows two SAPs for port 2&#47;1&#47;3&#x30;&#x3A; one SAP bound to a VXLAN service and the other SAP bound to an SPB service&#x3A;</p><p class="example1" id="1144963">&#x2D;&#x3E; show service access port 2&#47;1&#47;3&#x30; sap</p><p class="example2" id="1144964">Legend&#x3A; &#x2A; denotes a dynamic object</p><p class="example2" id="1144965">                                                         Vlan</p><p class="example2" id="1144966">Identifier    Adm  Oper Stats T&#x3A;P  ServiceId   Isid&#47;Vnid Xlation Sap Description</p><p class="example2" id="1144967">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="example2" id="1144968">sap&#x3A;2&#47;1&#47;3&#x30;A&#x3A;&#x30; Down Down  N    Y&#x3A;x  2&#x30;          15&#x30;&#x30;        N        &#x2D;</p><p class="example2" id="1144969">sap&#x3A;2&#47;1&#47;3&#x30;A&#x3A;5 Up   Down  N    Y&#x3A;x  1&#x30;          23&#x30;&#x30;&#x30;       N        &#x2D;</p><p class="example2" id="1144970"><br/></p><p class="example2" id="1144971">Total SAPs&#x3A; 2</p><p class="bullet" id="1126126"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If a port is administratively shutdown, all SAPs on that port become operationally out of service.</p><p class="bullet" id="1126128"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Both fixed ports and link aggregates are configurable as access ports. Only access ports are associated with SAPs.</p><p class="bullet" id="1285016"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Bridging functionality is not supported on access ports or link aggregates. In addition, if the default VLAN for a port or link aggregate is configured with an IP interface, then configuring the port or link aggregate as an access port is not supported.</p><p class="bullet" id="1285018"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configuring multiple SAPs on an access port that map different VLAN tags to the same service can cause a MAC move when the same customer MAC (CMAC) ingresses the access port with different VLAN tags. For example, a CMAC has two flows tagged with VLAN 1&#x30; and VLAN 2&#x30; ingressing access port 1&#47;1 and both are mapped to service 1&#x30;&#x30;. </p><p class="example1" id="1140138">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;1&#47;1&#x3A;1&#x30;</p><p class="example2" id="1140135">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;1&#47;1&#x3A;2&#x30;</p><p class="indented1" id="1140092">To avoid the MAC move in this scenario, use one of the following alternative SAP configurations.</p><p class="indented1" id="1140141">Configure the SAPs with different services&#x3A;</p><p class="example1" id="1140054">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;1&#47;1&#x3A;1&#x30;</p><p class="example2" id="1139954">&#x2D;&#x3E; service 2&#x30;&#x30; sap port 1&#47;1&#47;1&#x3A;2&#x30;</p><p class="indented1" id="1140147">Configure a default SAP to classify both flows into the same service&#x3A;</p><p class="example1" id="1140064">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;1&#47;1&#x3A;all</p><p class="indented1" id="1140117">See <a  href="#XREF_58853__Creating_the_Service_Access_Point163"></a><a  href="#XREF_58853__Creating_the_Service_Access_Point163" style="color:#0000ff;background-color:transparent;">Creating the Service Access Point</a> for more information.</p><p class="heading3" id="1126133"><a id="XREF_39304__Configuring_Service_Access_Ports163" name="XREF_39304__Configuring_Service_Access_Ports163">Configuring Service Access Ports</a></p><p class="text" id="1126134"><a id="163_text_1126134" name="163_text_1126134"></a>Each SAP is comprised of an access port or link aggregate and an encapsulation type value. Access ports are customer&#x2D;facing ports that reside on a provider edge router. Traffic received on these ports is classified for one or more SAPs and forwarded onto the intended destination by the associated SPB service.</p><p class="text" id="1126135">To configure a port or link aggregate as an access port, use the <a id="index_1192941" name="index_1192941"></a><a data-indexterm="%3Cindex%3Eservice%20access%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_access%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_access%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_50401__service_access" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service access</a> command. For example, the following command configures port 1&#47;1&#47;2 and link aggregate 5 as access ports&#x3A;</p><p class="example1" id="1126139">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="example2" id="1131131">&#x2D;&#x3E; service access linkagg 5</p><p class="text" id="1131151">To revert an access port back to a regular switch port or link aggregate, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service access</span> command. For example&#x3A;</p><p class="example1" id="1131155">&#x2D;&#x3E; no service access port 1&#47;1&#47;2</p><p class="example2" id="1131162">&#x2D;&#x3E; no service access linkagg 5</p><p class="example2" id="1385928"><br/></p><p class="heading4" id="1385932">Configuring Hybrid Access Ports</p><p class="text" id="1385933">A single port can function both as an access port and a bridging port by enabling Hybrid mode on an access port. Hybrid configured port can be understood as a bridge port with a default VLAN and tagged VLAN for bridging and the user can configure SAPs for services with mapped tagged VLANs. </p><p class="text" id="1385935">To enable hybrid mode on the access port, use the <span class="blue_bold" style="font-weight:Bold;color:#0000ff;background-color:transparent;"><a id="index_1385934" name="index_1385934"></a><a data-indexterm="%3Cindex%3Eservice%20access%20vlan-xlation%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command"></a>service access</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">hybrid</span> option with <span style="font-weight:Bold;">enable</span> keyword. For example&#x3A;</p><p class="example2" id="1385936"><br/></p><p class="example2" id="1385937">&#x2D;&#x3E; service access port 1&#47;1&#47;3&#x2D;1&#x30; hybrid enable</p><p class="text" id="1385939">To disable hybrid mode on the access port, use the <span class="blue_bold" style="font-weight:Bold;color:#0000ff;background-color:transparent;"><a id="index_1385938" name="index_1385938"></a><a data-indexterm="%3Cindex%3Eservice%20access%20vlan-xlation%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command"></a>service access</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">hybrid</span> option with <span style="font-weight:Bold;">disable</span> keyword. For example&#x3A;</p><p class="example2" id="1385940"><br/></p><p class="example2" id="1385941">&#x2D;&#x3E; service access port 1&#47;1&#47;6 hybrid disable</p><p class="text" id="1385942">Below is an example topology depicting traffic treatment on a hybrid configured port. When different domains (SAP&#47;VLAN&#47;Default&#x2D;VLAN) traffic from customer network is received on the hybrid configured port at BEB from aggregator switch, the traffic gets classified to their respective domain. SAP VLAN tagged traffic is processed in service domain and regular VLAN tagged&#47;untagged (default) packet gets processed in VLAN domain.</p><p class="text" id="1385946"><img align="" alt="Hybrid Access Port" class="imageSettings" height="auto" preserveAspectRatio="none" src="../assets/Hybrid_Access_Port.jpg" style="max-width: 100% ;height: auto;display:block;margin:auto;" width="606.999817" x="8.000000" y="4.666667" /></p><p class="text" id="1385947"><br/></p><p class="FigureTitle" id="1385926">Figure 7&#x2D;14 &#x3A;  Hybrid Access Port Topology</p><p class="heading4" id="1131251">VLAN Translation on Access Ports</p><p class="text" id="1131258">VLAN translation refers to the egress translation of VLAN tags on service access points (SAPs). For more information about how VLAN translation is applied, see <a  href="#XREF_65701__Using_VLAN_Translation163" style="color:#0000ff;background-color:transparent;">Using VLAN Translation</a>. </p><p>By default, VLAN translation is disabled on access ports. Enabling VLAN translation on an access port implicitly enables translation for all SAPs associated with that port. However, translation must also be enabled for the services associated with these SAPs. This ensures that all SAPs associated with a service will apply VLAN translation.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="38.00px"><td><p class="CellBody_note_text" id="1380107" style="font-kerning:none;"><span class="Times_Bold">Note.  </span> On the <span data-keyref="Platforms Supported_OS9900">OmniSwitch 9900</span>, enabling VLAN translation at the access port level is not required. See <a  href="#XREF_65701__Using_VLAN_Translation163" style="color:#0000ff;background-color:transparent;">Using VLAN Translation</a> for more information.</p></td></tr></table></div></p><p class="text" id="1131283">To enable VLAN translation on an access port, use the <a id="index_1135460" name="index_1135460"></a><a data-indexterm="%3Cindex%3Eservice%20access%20vlan-xlation%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_access_vlan-xlation%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_89704__service_access_vlan-xlation" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service access vlan-xlation</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">enable</span> option. For example&#x3A;</p><p class="example1" id="1131299">&#x2D;&#x3E; service access port 1&#47;1&#47;3 vlan&#x2D;xlation enable</p><p class="example2" id="1131300">&#x2D;&#x3E; service access linkagg 1&#x30; vlan&#x2D;xlation enable</p><p class="text" id="1131291">To disable VLAN translation on an access port, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service access vlan&#x2D;xlation</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">disable</span> option. For example&#x3A;</p><p class="example1" id="1131310">&#x2D;&#x3E; service access port 1&#47;1&#47;3 vlan&#x2D;xlation disable</p><p class="example2" id="1202080">&#x2D;&#x3E; service access linkagg 1&#x30; vlan&#x2D;xlation disable</p><p class="heading4" id="1202082"><a id="XREF_64148__Configuring_Layer_2_Profiles_for_Access_Ports163" name="XREF_64148__Configuring_Layer_2_Profiles_for_Access_Ports163">Configuring Layer 2 Profiles for Access Ports</a></p><p>A Layer 2 profile determines how control frames ingressing on an access port are processed. When a port is configured as an access port, a default Layer 2 profile (<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">def&#x2D;access&#x2D;profile</span>) is applied to the port with the following default values for processing control frames&#x3A;<span style="font-size : 12.00pt;"><div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="124.80px"/><col width="124.80px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1380773"><a id="163_CellHeading_1380773" name="163_CellHeading_1380773"></a>Protocol</p></th><th><p class="CellHeading" id="1380775">Default</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1380777">STP</p></td><td><p class="CellBody" id="1380779">tunnel</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1380781">8&#x30;2.1x</p></td><td><p class="CellBody" id="1380783">drop</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1380785">8&#x30;2.3ad</p></td><td><p class="CellBody" id="1380787">peer</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1380789">MVRP</p></td><td><p class="CellBody" id="1380791">tunnel</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1380793">GVRP</p></td><td><p class="CellBody" id="1380795">tunnel</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1380797">AMAP</p></td><td><p class="CellBody" id="1380799">drop</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1380801">8&#x30;2.1ab</p></td><td><p class="CellBody" id="1380803">drop</p></td></tr></table></div></span></p><p class="text" id="1380845">If the default profile values are not sufficient, use the <a id="index_1380841" name="index_1380841"></a><a data-indexterm="%3Cindex%3Eservice%20l2profile%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_l2profile%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_l2profile%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_48070__service_l2profile" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service l2profile</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">tunnel</span>, <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">drop</span>, and <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">peer</span> options to create a new profile. For example, the following command creates a profile named &#x201c;DropL2&#x201d;&#x3A;</p><p class="example1" id="1131424">&#x2D;&#x3E; service l2profile DropL2 stp drop gvrp drop 8&#x30;2.1ab drop</p><p class="text" id="1126188">Consider the following when configuring Layer 2 profiles&#x3A;</p><p class="bullet" id="1204454"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When a profile is created, the new profile inherits the default profile settings for processing control frames. The default settings are applied with the new profile unless they are explicitly changed. For example, the profile &#x201c;DropL2&#x201d; was configured to discard STP, GVRP, and 8&#x30;2.1ab frames. No other protocol settings were changed, so the default settings still apply for the other protocols.</p><p class="bullet" id="1204475"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Remove any profile associations with access ports before attempting to modify or delete the profile.</p><p><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Not all of the control protocols are currently supported with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">peer</span>, <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">tunnel</span>, and <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">drop</span> parameters. Use the following table to determine the parameter combinations that are supported&#x3A;<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;margin-left:28.80pt;margin-bottom:12.00pt;"><col width="96.00px"/><col width="134.40px"/><col width="96.00px"/><col width="96.00px"/><col width="96.00px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1204492">Protocol</p></th><th><p class="CellHeading" id="1204494" style="text-align:center;">Reserved MAC</p></th><th><p class="CellHeading" id="1204496" style="text-align:center;">peer</p></th><th><p class="CellHeading" id="1204498" style="text-align:center;">drop</p></th><th><p class="CellHeading" id="1204500" style="text-align:center;">tunnel</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1204502">STP</p></td><td><p class="CellBody" id="1204504" style="text-align:center;">&#x30;1&#x2D;8&#x30;&#x2D;C2&#x2D;&#x30;&#x30;&#x2D;&#x30;&#x30;&#x2D;&#x30;&#x30; </p></td><td><p class="CellBody" id="1204506" style="text-align:center;">no</p></td><td><p class="CellBody" id="1204508" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204510" style="text-align:center;">yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1204512">8&#x30;2.1x</p></td><td><p class="CellBody" id="1204514" style="text-align:center;">&#x30;1&#x2D;8&#x30;&#x2D;C2&#x2D;&#x30;&#x30;&#x2D;&#x30;&#x30;&#x2D;&#x30;3</p></td><td><p class="CellBody" id="1204516" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204518" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204520" style="text-align:center;">yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1204522">8&#x30;2.1ab</p></td><td><p class="CellBody" id="1204524" style="text-align:center;">&#x30;1&#x2D;8&#x30;&#x2D;C2&#x2D;&#x30;&#x30;&#x2D;&#x30;&#x30;&#x2D;&#x30;E</p></td><td><p class="CellBody" id="1204526" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204528" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204530" style="text-align:center;">yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1204532">8&#x30;2.3ad</p></td><td><p class="CellBody" id="1204534" style="text-align:center;">&#x30;1&#x2D;8&#x30;&#x2D;C2&#x2D;&#x30;&#x30;&#x2D;&#x30;&#x30;&#x2D;&#x30;2</p></td><td><p class="CellBody" id="1204536" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204538" style="text-align:center;">no</p></td><td><p class="CellBody" id="1204540" style="text-align:center;">no</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1204542">GVRP</p></td><td><p class="CellBody" id="1204544" style="text-align:center;">&#x30;1&#x2D;8&#x30;&#x2D;C2&#x2D;&#x30;&#x30;&#x2D;&#x30;&#x30;&#x2D;21</p></td><td><p class="CellBody" id="1204546" style="text-align:center;">no</p></td><td><p class="CellBody" id="1204548" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204550" style="text-align:center;">yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1272639">AMAP</p></td><td><p class="CellBody" id="1272641" style="text-align:center;">&#x30;&#x30;&#x2D;2&#x30;&#x2D;DA&#x2D;&#x30;&#x30;&#x2D;7&#x30;&#x2D;&#x30;4</p></td><td><p class="CellBody" id="1272643" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1272645" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1272647" style="text-align:center;">yes</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1204552">MVRP</p></td><td><p class="CellBody" id="1204554" style="text-align:center;">&#x30;1&#x2D;8&#x30;&#x2D;C2&#x2D;&#x30;&#x30;&#x2D;&#x30;&#x30;&#x2D;21</p></td><td><p class="CellBody" id="1204556" style="text-align:center;">no</p></td><td><p class="CellBody" id="1204558" style="text-align:center;">yes</p></td><td><p class="CellBody" id="1204560" style="text-align:center;">yes</p></td></tr></table></div>&#160;</p><p class="text" id="1204571">To delete a user&#x2D;created Layer 2 profile, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service l2profile </span>command. For example, the following command deletes the &#x201c;DropL2&#x201d; profile&#x3A;</p><p class="example1" id="1126250">&#x2D;&#x3E; no service l2profile DropL2</p><p class="text" id="1126254">Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_44687__show_service_l2profile" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service l2profile</a> command to view a list of profiles that are already configured for the switch. This command also displays the attribute values for each profile.</p><p class="heading4" id="1278583">Configuring a Layer 2 Profile Action for 8&#x30;2.1AB PDUs</p><p class="text" id="1278584">A Layer 2 profile can be configured to apply a different action to tagged and untagged 8&#x30;2.1AB control frames. For example, the following command uses the <a href="../c_svcmgr/c_svcmgr.htm#XREF_35880__service_l2profile_inbound_802_1ab" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service l2profile inbound 802.1ab</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">tagged</span> parameter to set the action for tagged 8&#x30;2.1AB control frames in the specified Layer 2 profile&#x3A;</p><p class="example1" id="1278588">&#x2D;&#x3E; service l2profile lldp&#x2D;tagged inbound tagged 8&#x30;2.1ab tunnel</p><p class="text" id="1278589">In this example, the tunnel action is specified only for tagged 8&#x30;2.1AB control frames. All tagged 8&#x30;2.1AB control frames will be tunneled, while untagged frames will be dropped. </p><p class="text" id="1278590">To configure an action for untagged 8&#x30;2.1AB control frames, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service l2profile inbound 8&#x30;2.1ab</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">untagged</span> parameter to set the action for untagged 8&#x30;2.1AB control frames in the specified Layer 2 profile. For example&#x3A;</p><p class="example1" id="1278591">&#x2D;&#x3E; service l2profile lldp&#x2D;untagged inbound untagged 8&#x30;2.1ab peer</p><p class="text" id="1278592">In this example, the peer action is specified only for untagged 8&#x30;2.1AB control frames. All untagged 8&#x30;2.1AB control frames will participate in the protocol, while tagged frames will be dropped.</p><p class="text" id="1278593">To configure the same action for both tagged and untagged 8&#x30;2.1AB control frames, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service l2profile inbound 8&#x30;2.1ab</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">both</span> parameter. For example&#x3A;</p><p class="example1" id="1278594">&#x2D;&#x3E; service l2profile lldp&#x2D;both inbound both 8&#x30;2.1ab peer</p><p class="text" id="1278595">When a UNI profile is configured to apply a different action for tagged and untagged 8&#x30;2.1AB PDUs, the profile action can only be modified through one of the following methods&#x3A;</p><p class="bullet" id="1278596"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Set both the tagged and untagged action for 8&#x30;2.1AB PDUs back to the default setting (<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">drop</span>) then configure a new action for both.</p><p class="bullet" id="1278597"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Delete the UNI profile and create a new one with the modified action for tagged and untagged 8&#x30;2.1AB PDUs.</p><p class="heading4" id="1126255"><a id="XREF_90209__Assigning_Layer_2_Profiles_to_Access_Ports163" name="XREF_90209__Assigning_Layer_2_Profiles_to_Access_Ports163">Assigning Layer 2 Profiles to Access Ports</a></p><p class="text" id="1126256"><a id="163_text_1126256" name="163_text_1126256"></a>After a Layer 2 profile is created, it is then necessary to assign the profile to an access port or link aggregate. When this is done, the current profile associated with the port is replaced with the new profile. </p><p class="text" id="1126260">The <a id="index_1135462" name="index_1135462"></a><a data-indexterm="%3Cindex%3Eservice%20access%20l2profile%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_access_l2profile%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_access_l2profile%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_90596__service_port_l2profile" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service access l2profile</a> command is used to assign a new profile to an access port. For example, the following command assigns the &#x201c;DropL2&#x201d; profile to access port 1&#47;1&#47;4 and link aggregate 5&#x3A;</p><p class="example1" id="1126261">&#x2D;&#x3E; service access port 1&#47;1&#47;4 l2profile DropL2</p><p class="example2" id="1131589">&#x2D;&#x3E; service access linkagg 5 l2profile DropL2</p><p class="text" id="1126262">To change the profile associated with the access port back to the default profile (<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">def&#x2D;access&#x2D;profile</span>), use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">default</span> option with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service access l2profile</span> command. For example&#x3A;</p><p class="example1" id="1126263">&#x2D;&#x3E; service port 1&#47;1&#47;4 l2profile default</p><p class="example2" id="1131638">&#x2D;&#x3E; service access linkagg 5 l2profile default</p><p class="text" id="1384072" style="font-weight:Bold;">When a service access port is configured with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">def&#x2D;access&#x2D;profile</span> and then assigned to an SPB pseudo&#x2D;wire SAP, the Layer 2 profile for that port automatically changes to <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">pw&#x2D;def&#x2D;access&#x2D;profile</span> with the following control protocol settings (see <a  href="#XREF_26657__Configuring_an_SPB_Pseudo-Wire_Service163" style="color:#0000ff;background-color:transparent;">Configuring an SPB Pseudo-Wire Service</a> for more information)&#x3A;<span style="font-size : 12.00pt;"><div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="124.80px"/><col width="124.80px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1384078">parameter</p></th><th><p class="CellHeading" id="1384080">def&#x2D;access&#x2D;profile</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1384082" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">stp </span></p></td><td><p class="CellBody" id="1384084" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">tunnel</span></p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1384086" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">8&#x30;2.1x</span></p></td><td><p class="CellBody" id="1384088" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">tunnel</span></p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1384090" style="font-weight:Bold;">8&#x30;2.3ad</p></td><td><p class="CellBody" id="1384092" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">peer</span></p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1384094" style="font-weight:Bold;">mvrp</p></td><td><p class="CellBody" id="1384096" style="font-weight:Bold;">tunnel</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1384098" style="font-weight:Bold;">gvrp</p></td><td><p class="CellBody" id="1384100" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">tunnel</span></p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1384102" style="font-weight:Bold;">amap</p></td><td><p class="CellBody" id="1384104" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">tunnel</span></p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1384106" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">8&#x30;2.1ab</span></p></td><td><p class="CellBody" id="1384108" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">tunnel</span></p></td></tr></table></div></span></p><p class="bullet" id="1384257"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If a user&#x2D;created Layer 2 profile is associated with a service access port that is then assigned to an SPB pseudo&#x2D;wire SAP, the Layer 2 profile for that port is <span class="Times_italics" style="font-style:Italic;background-color:transparent;">not</span> changed. The user&#x2D;created profile is applied to control packets received on the port, not the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">pw&#x2D;def&#x2D;access&#x2D;profile</span>. </p><p class="bullet" id="1384122"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">default</span> option is used with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service access l2profile</span> command, the Layer 2 profile assignment for the service access port reverts back to <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">def&#x2D;access&#x2D;profile</span>, regardless of whether the port was assigned to a user&#x2D;created profile or to <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">pw&#x2D;def&#x2D;access&#x2D;profile</span>.</p><p class="heading4" id="1132261">Verifying the Access Port Configuration</p><p class="text" id="1132285">To view the access port configuration for the switch, use the <a id="index_1192946" name="index_1192946"></a><a data-indexterm="%3Cindex%3Eshow%20service%20access%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_service_access%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_service_access%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_98570__show_service_port" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service access</a> command. For example&#x3A;</p><p class="screen2" id="1143739"><br/></p><p class="screen2" id="1151252">&#x2D;&#x3E; show service access</p><p class="screen2" id="1132292">Port       Link  SAP     SAP     Vlan</p><p class="screen2" id="1132293">Id        Status Type    Count   Xlation L2Profile</p><p class="screen2" id="1132294">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1132295">1&#47;1&#47;3     Up     Manual  1&#x30;&#x30;     N       def&#x2D;access&#x2D;profile</p><p class="screen2" id="1132296">1&#47;1&#47;4     Down   Manual  1&#x30;&#x30;     N       def&#x2D;access&#x2D;profile</p><p class="screen2" id="1132297">1&#47;1&#47;5     Down   Manual  1&#x30;&#x30;     N       def&#x2D;access&#x2D;profile</p><p class="screen2" id="1132299">1&#47;1&#47;15    Down   Dynamic &#x30;       Y       def&#x2D;access&#x2D;profile</p><p class="screen2" id="1132300">1&#47;1&#47;16    Up     Dynamic 1       Y       def&#x2D;access&#x2D;profile</p><p class="screen2" id="1132301">1&#47;1&#47;17    Down   Dynamic &#x30;       Y       def&#x2D;access&#x2D;profile</p><p class="screen2" id="1132303"><br/></p><p class="screen2" id="1132286">Total Access Ports&#x3A; 6</p><p class="heading3" id="1132287"><a id="XREF_58853__Creating_the_Service_Access_Point163" name="XREF_58853__Creating_the_Service_Access_Point163">Creating the Service Access Point</a></p><p class="text" id="1126269"><a id="163_text_1126269" name="163_text_1126269"></a>Each SPB service is bound to at least one Service Access Point (SAP). A SAP identifies the point at which customer traffic enters the Provider Backbone Bridge Network (PBBN). Creating a SAP on an SPB switch designates that switch as a Backbone Edge Bridge (BEB) in the PBBN. An SPB switch that does not have a SAP but does have at least one BVLAN and an SPB interface is designated as Backbone Core Bridge (BCB) in the PBBN.</p><p class="text" id="1131883">Once the SPB topology is determined and switches that will serve as BEBs are identified, a SAP is created on each BEB. A SAP is created by associating a SAP ID with an SPB service. A SAP ID is comprised of a customer&#x2D;facing port (referred to as an access port) and an encapsulation value that is used to identify the type of customer traffic (untagged, single&#x2D;tagged, or double&#x2D;tagged) to map to the associated service.</p><p class="text" id="1132476">The <a id="index_1135463" name="index_1135463"></a><a data-indexterm="%3Cindex%3Eservice%20sap%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_sap%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_sap%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_73897__service_spb_sap" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap</a> command is used to configure a SAP. This command specifies the SPB service ID number and the SAP ID (slot&#47;port&#x3A;encapsulation). The following parameter values are used with this command to specify the encapsulation value&#x3A;<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;margin-left:31.97pt;"><col width="168.00px"/><col width="288.00px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1131826">SAP Encapsulation Value</p></th><th><p class="CellHeading" id="1131828">Customer Traffic Serviced</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1131834" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">&#x30; (null)</span></p></td><td><p class="CellBody" id="1131836">All untagged packets; tagged packets are dropped.</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1131838" style="font-weight:Bold;"><span class="Times_Bold" style="background-color:transparent;">all</span></p></td><td><p class="CellBody" id="1131840">All tagged and untagged packets not already classified into another SAP&#x2A;</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1131842" style="font-style:Italic;"><span class="Times_italics" style="background-color:transparent;">qtag</span></p></td><td><p class="CellBody" id="1131844">Only traffic 8&#x30;2.1q&#x2D;tagged with the specified VLAN ID.</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1131846">outer_<span class="Times_italics" style="font-style:Italic;background-color:transparent;">qtag.inner_qtag</span></p></td><td><p class="CellBody" id="1131848">Only traffic double&#x2D;tagged (QinQ) with the specified outer and inner VLAN IDs.</p></td></tr></table></div></p><p class="indented1" id="1132494">&#x2A;Note that the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">&#x3A;all</span> (wildcard) parameter is also configurable as the inner tag value for double&#x2D;tagged frames (for example, &#x201c;1&#x30;&#x3A;all&#x201d; specifies double&#x2D;tagged packets with an outer tag equal to 1&#x30; and an inner tag with any value).</p><p class="text" id="1126308">The following <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service sap</span> command example creates a SAP that will direct customer traffic ingressing on access port 1&#47;1&#47;4 that is tagged with VLAN ID 5&#x30; to service 1&#x30;&#x30;&#x3A;</p><p class="example1" id="1126309">&#x2D;&#x3E; service 1&#x30;&#x30; sap 1&#47;1&#47;4&#x3A;5&#x30; description &#x201c;BEB1 to SPB1&#x30;&#x30; CVLAN 5&#x30;&#x201d;</p><p class="text" id="1126310">In the above example, the 1&#47;1&#47;4&#x3A;5&#x30; designation is referred to as the SAP ID or the encapsulation ID. This means that if no other SAPs are configured for port 1&#47;1&#47;4, then any traffic ingressing on that port is dropped if the traffic is not tagged with VLAN 5&#x30;.</p><p class="text" id="1131975">It is possible to configure more than one SAP for the same access port, which provides a method for segregating incoming traffic into multiple services. For example, the following SAP configuration for port 2&#47;1&#47;3 sends incoming traffic to three different services based on the VLAN tags of the frames received&#x3A;</p><p class="example1" id="1132354">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 2&#47;1&#47;3&#x3A;all</p><p class="example2" id="1132355">&#x2D;&#x3E; service 2&#x30;&#x30; sap port 2&#47;1&#47;3&#x3A;1&#x30;&#x30;</p><p class="example2" id="1132356">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 2&#47;1&#47;3&#x3A;1&#x30;&#x30;.2&#x30;&#x30;</p><p class="text" id="1132369">In this example,</p><p class="bullet" id="1132373"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Frames double&#x2D;tagged with 1&#x30;&#x30; (outer tag) and 2&#x30;&#x30; (inner tag) are sent on service 1&#x30;&#x30;&#x30;.</p><p class="bullet" id="1132377"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Frames single&#x2D;tagged with VLAN 1&#x30;&#x30; are sent on service 2&#x30;&#x30;.</p><p class="bullet" id="1132378"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>All other frames (those that are not single&#x2D;tagged with 1&#x30;&#x30; or double&#x2D;tagged with 1&#x30;&#x30; and 2&#x30;&#x30;) are sent on service 2&#x30;&#x30;&#x30;.</p><p class="text" id="1132384">The following SAP ID classification precedence is applied when there are multiple SAPs for one access port&#x3A;</p><p class="step_first" id="1132395"><span class="Futura_Bold">1&#160;&#160;&#160; </span>Double&#x2D;tagged (Outer VLAN + Inner VLAN) &#x2D; Highest </p><p class="step_next" id="1132396"><span class="Futura_Bold">2&#160;&#160;&#160; </span>Double&#x2D;tagged (Outer VLAN + all)</p><p class="step_next" id="1132397"><span class="Futura_Bold">3&#160;&#160;&#160; </span>Single&#x2D;tagged (VLAN)</p><p class="step_next" id="1132398"><span class="Futura_Bold">4&#160;&#160;&#160; </span>Single&#x2D;tagged (wildcard)</p><p class="step_next" id="1132399"><span class="Futura_Bold">5&#160;&#160;&#160; </span>Untagged &#x2D; Lowest.</p><p class="heading4" id="1132541">Modifying Default SAP Parameters</p><p>The following parameter values are set by default at the time the SAP is created. If necessary, use the specified commands to change the default values.<div align="left"><table class="Defaults_Table" style="max-width: 100% ;height: auto;"><col width="201.60px"/><col width="192.00px"/><col width="110.40px"/><thead><tr height="28.67px"><th><p class="CellHeading" id="1132545">Parameter Description</p></th><th><p class="CellHeading" id="1132547">Command</p></th><th><p class="CellHeading" id="1132549">Default</p></th></tr></thead><tr height="23.33px"><td><p class="CellBody" id="1132551">SAP description.</p></td><td><p class="CellBody" id="1132556" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_15874__service_spb_sap_description" style="background-color:transparent;">service sap description</a></p></td><td><p class="CellBody" id="1132558">None</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1132620">SAP trust mode</p></td><td><p class="CellBody" id="1132622" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_34281__service_spb_sap_trusted" style="background-color:transparent;">service sap trusted</a></p></td><td><p class="CellBody" id="1132624">Trusted</p></td></tr><tr height="23.33px"><td><p class="CellBody" id="1132639">Administrative status for the SAP</p></td><td><p class="CellBody" id="1132641" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_48837__service_spb_sap_admin-state" style="background-color:transparent;">service sap admin-state</a></p></td><td><p class="CellBody" id="1132643">Enabled</p></td></tr><tr height="39.33px"><td><p class="CellBody" id="1132560">Administrative status for statistics collection.</p></td><td><p class="CellBody" id="1132565" style="font-weight:Bold;color:#0000ff;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_57012__service_spb_stats" style="background-color:transparent;">service sap stats</a></p></td><td><p class="CellBody" id="1132567">Disabled</p></td></tr></table></div></p><p class="text" id="1132586">Refer to the <span class="Times_italics" data-keyref="CLI Reference Guide" style="font-family : Times New Roman ; font-weight:normal;font-style:Italic;font-size : 10.50pt;text-decoration:none;font-kerning:none;text-transform:none;font-stretch:normal;color:#000000;background-color:transparent;letter-spacing : 0.00em;">OmniSwitch AOS Release 8 CLI Reference Guide</span> for more information about the command parameters.</p><p class="heading4" id="1126311">Configuring the SAP Trust Mode&#160;&#160;&#160;</p><p class="text" id="1126315">The <a id="index_1135464" name="index_1135464"></a><a data-indexterm="%3Cindex%3Eservice%20sap%20trusted%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_sap_trusted%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_sap_trusted%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_34281__service_spb_sap_trusted" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap trusted</a> command is used to configure the trust mode for a SAP. A trusted SAP can accept 8&#x30;2.1p values in incoming packets; an untrusted SAP will set any 8&#x30;2.1p values to zero in incoming packets, unless an 8&#x30;2.1p value is configured with this command.</p><p class="text" id="1132534">Note that untagged Layer 2 control packets (for example, BPDU, GVRP, and AMAP) are always tunneled (if enabled) through the Provider Backbone Bridge (PBB) network with the default EXP bits set to 7, so that they can arrive at the destination bridge at the highest COS queue of 7. As a result, trusted and untrusted SAPs configured on the access ports will not affect the Layer 2 control packets ingressing on the access ports.</p><p class="text" id="1126316">By default, a SAP is trusted with the priority set to best effort (zero). Use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service spb sap trusted</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">priority</span> option to change the SAP mode to untrusted. For example&#x3A; </p><p class="example1" id="1126317">&#x2D;&#x3E; service 1&#x30;&#x30; sap 1&#47;4&#x3A;5&#x30; no trusted priority 7</p><p class="text" id="1126318">When a SAP is trusted, the priority value contained in tagged customer packets is used; untagged packets are assigned the default priority value (zero). When a SAP is untrusted, the priority value configured for the SAP is assigned to both tagged and untagged customer packets.</p><p class="heading4" id="1126331">Enabling&#47;Disabling the SAP</p><p class="text" id="1193031">By default, a SAP is disabled at the time the SAP is created. To enable the SAP administrative status, use the <a id="index_1193032" name="index_1193032"></a><a data-indexterm="%3Cindex%3Eservice%20sap%20admin-state%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_sap_admin-state%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_sap_admin-state%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_48837__service_spb_sap_admin-state" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap admin-state</a> command. For example&#x3A;</p><p class="example1" id="1193036">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;4&#x3A;5&#x30; admin&#x2D;state enable</p><p class="example2" id="1132897">&#x2D;&#x3E; service 2&#x30;&#x30; sap linkagg 5&#x3A;all admin&#x2D;state enable</p><p class="text" id="1145300">To disable the SAP, enter the following command&#x3A;</p><p class="example1" id="1145301">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;4&#x3A;5&#x30; admin&#x2D;state disable</p><p class="example2" id="1145302">&#x2D;&#x3E; service 2&#x30;&#x30; sap linkagg 5&#x3A;all admin&#x2D;state disable</p><p class="heading4" id="1126339">Deleting the SAP</p><p class="text" id="1126340">When a SAP is administratively disabled, the SAP configuration is not removed from the switch. To delete a SAP from the switch configuration, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <a href="../c_svcmgr/c_svcmgr.htm#XREF_73897__service_spb_sap" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap</a> command. For example&#x3A;</p><p class="example1" id="1126341">&#x2D;&#x3E; service 1&#x30;&#x30; no sap port 1&#47;4&#x3A;5&#x30;</p><p class="example2" id="1132926">&#x2D;&#x3E; service 2&#x30;&#x30; no sap linkagg 5&#x3A;all</p><p class="heading4" id="1116243">Verifying the SAP Configuration</p><p class="text" id="1132861">A SAP is a type of virtual port that is associated with an SPB service. To determine the SAP configuration for a specific service, use the <a id="index_1193039" name="index_1193039"></a><a data-indexterm="%3Cindex%3Eshow%20service%20ports%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_service_ports%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_service_ports%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_15149__show_service_spb_ports" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service ports</a> command to view the virtual ports associated with a specific service. For example&#x3A;</p><p class="screen2" id="1143745"><br/></p><p class="screen2" id="1151258">&#x2D;&#x3E; show service 1 ports</p><p class="screen2" id="1132988">Legend&#x3A; &#x2A; denotes a dynamic object</p><p class="screen2" id="1132989">SPB Service Info</p><p class="screen2" id="1132990">  Admin &#x3A; Up, Oper  &#x3A; Up, Stats      &#x3A; N, Mtu     &#x3A; 9194,   VlanXlation &#x3A; N,</p><p class="screen2" id="1132991">  ISID  &#x3A; 1&#x30;&#x30;&#x30;,      BVlan &#x3A; 4&#x30;&#x30;1,   MCast&#x2D;Mode &#x3A; Headend,   Tx&#47;Rx   &#x3A; &#x30;&#47;&#x30;</p><p class="screen2" id="1132992"><br/></p><p class="screen2" id="1132993">                                 Sap Trusted&#x3A;Priority&#47;         Sap Description &#47;</p><p class="screen2" id="1132994">Identifier       Adm  Oper Stats Sdp SystemId&#x3A;BVlan   Intf     Sdp SystemName</p><p class="screen2" id="1132995">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1132996">sap&#x3A;1&#47;11&#x3A;1&#x30;&#x30;&#x30;    Up   Up    N           Y&#x3A;x           1&#47;11        &#x2D;</p><p class="screen2" id="1132997">sap&#x3A;1&#47;12&#x3A;1&#x30;&#x30;&#x30;    Up   Down  N           Y&#x3A;x           1&#47;12        &#x2D;</p><p class="screen2" id="1132998">sap&#x3A;1&#47;13&#x3A;1&#x30;&#x30;&#x30;    Up   Down  N           Y&#x3A;x           1&#47;13        &#x2D;</p><p class="screen2" id="1132999">sap&#x3A;1&#47;14&#x3A;1&#x30;&#x30;&#x30;    Up   Down  N           Y&#x3A;x           1&#47;14        &#x2D;</p><p class="screen2" id="1133000">sdp&#x3A;32776&#x3A;1&#x2A;     Up   Up    Y    e8e7.3233.1831&#x3A;4&#x30;&#x30;1  1&#47;1        BEB&#x2D;1</p><p class="screen2" id="1133001"><br/></p><p class="screen2" id="1132962">Total Ports&#x3A; 5</p><p class="text" id="1133011">To then view configuration information for a specific SAP, use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_76189__show_service_spb_sap" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service spb sap</a> command. For example&#x3A;</p><p class="screen2" id="1143748"><br/></p><p class="screen2" id="1151264">&#x2D;&#x3E; show service 1 sap port 1&#47;11&#x3A;1&#x30;&#x30;&#x30;</p><p class="screen2" id="1132969">SAP Detailed Info</p><p class="screen2" id="1132970">  SAP Id           &#x3A; 1&#47;11&#x3A;1&#x30;&#x30;&#x30;,            Description      &#x3A; ,</p><p class="screen2" id="1132971">  Admin Status     &#x3A; Up,                   Oper Status      &#x3A; Up,</p><p class="screen2" id="1132972">  Stats Status     &#x3A; No,                   Vlan Translation &#x3A; No,</p><p class="screen2" id="1132973">  Service Type     &#x3A; SPB,                  Allocation Type  &#x3A; Static,</p><p class="screen2" id="1132974">  Trusted          &#x3A; Yes,                  Priority         &#x3A; &#x30;,</p><p class="screen2" id="1132975">  Ingress Pkts     &#x3A; &#x30;,                    Ingress Bytes    &#x3A; &#x30;,</p><p class="screen2" id="1132976">  Egress Pkts      &#x3A; &#x30;,                    Egress Bytes     &#x3A; &#x30;,</p><p class="screen2" id="1132963">  Mgmt Change      &#x3A; &#x30;8&#47;&#x30;7&#47;2&#x30;12 23&#x3A;39&#x3A;29,  Status Change    &#x3A; &#x30;8&#47;1&#x30;&#47;2&#x30;12 15&#x3A;13&#x3A;&#x30;8</p><p class="heading2" id="1383462"><a id="XREF_26657__Configuring_an_SPB_Pseudo-Wire_Service163" name="XREF_26657__Configuring_an_SPB_Pseudo-Wire_Service163">Configuring an SPB Pseudo&#x2D;Wire Service</a></p><p class="text" id="1383463"><a id="163_text_1383463" name="163_text_1383463"></a>The OmniSwitch implementation of SPB provides a multipoint&#x2D;to&#x2D;multipoint (E&#x2D;LAN) connectivity solution that connects customer sites across an SPB network. However, as the number of users increases, the number of MAC addresses learned increases and more system resources are used up. It is also possible that a simple point&#x2D;to&#x2D;point virtual wire (E&#x2D;LINE) connection between two SPB nodes is all that is required. </p><p class="text" id="1383464">An SPB pseudo&#x2D;wire service provides a point&#x2D;to&#x2D;point connection (E&#x2D;LINE) that will bridge Ethernet traffic between two specifically designated end points. Configuring an SPB pseudo&#x2D;wire service is done as part of defining an end point for a point&#x2D;to&#x2D;point connection between two SAPs (also referred to as attachment points for a pseudo&#x2D;wire). </p><p class="text" id="1383465">With a pseudo&#x2D;wire point&#x2D;to&#x2D;point connection, there is no forwarding decision to be made; packets simply enter one end of the connection and leave the other end of the connection unchanged. As a result, customer MAC addresses are not learned on the SAP attachment points. Packets are transparently forwarded, which simplifies traffic flow and reduces hardware usage.</p><p class="text" id="1383468">When configuring an SPB pseudo&#x2D;wire service, as described in <a  href="#XREF_22820__SPBM_Pseudo-Wire_(E-LINE_Transparent)_Service163" style="color:#0000ff;background-color:transparent;">SPBM Pseudo-Wire (E-LINE Transparent) Service</a>, consider the following guidelines&#x3A;</p><p class="bullet" id="1383470"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The SAP that the service is associated with serves as an attachment point for one end of the point&#x2D;to&#x2D;point connection. </p><p class="bullet_sub" id="1383471"><span class="bold">&#x2013;&#160;&#160;&#160; </span>If the other end of the connection is to a local SAP, make sure both SAPs are associated with the same service.</p><p class="bullet_sub" id="1383472"><span class="bold">&#x2013;&#160;&#160;&#160; </span>If the other end of the connection is to a remote SAP, make sure both the local and remote SAP are associated with the same I&#x2D;SID. This will ensure that there is only one virtual wire connection between the two SPB nodes. </p><p class="bullet_sub" id="1383473"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Make sure there are no more than two SAP attachment points for the same pseudo&#x2D;wire service.</p><p class="bullet" id="1383474"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Do not configure a pseudo&#x2D;wire service with the same I&#x2D;SID on more than two SPB nodes. Configuring the same pseudo&#x2D;wire service on more than two nodes may cause unpredictable behavior with the connection.</p><p class="bullet" id="1383475"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configure the SPB pseudo&#x2D;wire service to use the head&#x2D;end multicast mode.</p><p class="bullet" id="1383476"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>VLAN translation is automatically disabled to ensure packets enter and leave the pseudo&#x2D;wire connection with the original customer VLAN tag.</p><p class="bullet" id="1383477"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">all</span> option for the SAP encapsulation (1&#47;1&#47;2&#x3A;all) to ensure all customer traffic flows through the pseudo&#x2D;wire connection.</p><p class="bullet" id="1383478"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Flooding and replication are not needed, as there are only two attachment points (SAP to SAP for a local service or SAP to an SPB network port for the same service instance across the SPB backbone network).</p><p class="bullet" id="1383479"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>IPv4 over SPB routing, IPv6 over SPB routing, and IGMP snooping are not supported on an SPB pseudo&#x2D;wire service.</p><p class="bullet" id="1383480"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When an access port that is associated with the Layer 2 profile <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">def&#x2D;access&#x2D;profile</span> is assigned to an SPB pseudo&#x2D;wire SAP attachment point, the Layer 2 profile for that port is automatically changed to <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">pw&#x2D;def&#x2D;access&#x2D;profile</span>. See the <a  href="#XREF_90209__Assigning_Layer_2_Profiles_to_Access_Ports163" style="color:#0000ff;background-color:transparent;">Assigning Layer 2 Profiles to Access Ports</a> for more information.</p><p class="text" id="1383486">To configure an SPB pseudo&#x2D;wire connection, identify which SPB nodes will serve as a pseudo&#x2D;wire endpoint. This usually is a node that connects to a customer edge switch. Using the <a href="../c_svcmgr/c_svcmgr.htm#XREF_95469__service_spb" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service spb</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">pseudo&#x2D;wire</span> option, configure an SPB service as a pseudo&#x2D;wire type service. For example&#x3A;</p><p class="example1" id="1383490">&#x2D;&#x3E; service 1&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;1 pseudo&#x2D;wire enable description &quot;Pseudo&#x2D;wire ISID 1&#x30;&#x30;&#x30;&quot;</p><p class="text" id="1383494">After the service is created, use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_73897__service_spb_sap" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap</a> command to configure a SAP for the service and specify the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">all</span> option for the SAP encapsulation. For example&#x3A;</p><p class="example1" id="1383495">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;1&#47;1&#x30;&#x3A;all</p><p class="heading3" id="1383496">Verifying the SPB Pseudo&#x2D;Wire Configuration</p><p class="text" id="1383500">To verify the type of SPB service that is configured, use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_82323__show_service" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service</a> command and specify the service ID. For example, the following commands displays information about SPB service 1&#x30;&#x30;&#x3A;</p><p class="screen" id="1383501">&#x2D;&#x3E; show service 1&#x30;&#x30;</p><p class="screen2" id="1383502">SPB Service Detailed Info</p><p class="screen2" id="1383503">  Service Id       &#x3A; 1&#x30;&#x30;,                 Description      &#x3A; Pseudo&#x2D;wire ISID 1&#x30;&#x30;&#x30;,</p><p class="screen2" id="1383504">  ISID             &#x3A; 1&#x30;&#x30;&#x30;,                BVlan            &#x3A; 4&#x30;&#x30;1,</p><p class="screen2" id="1383505">  Multicast&#x2D;Mode   &#x3A; Headend,             Tx&#47;Rx Bits       &#x3A; &#x30;&#47;&#x30;,</p><p class="screen2" id="1383506">  Admin Status     &#x3A; Up,                  Oper Status      &#x3A; Up,</p><p class="screen2" id="1383507">  Stats Status     &#x3A; No,                  Vlan Translation &#x3A; No,</p><p class="screen2" id="1383508">  Service Type     &#x3A; SPB,                 Allocation Type  &#x3A; Static,</p><p class="screen2" id="1383509">  MTU              &#x3A; 9194,                VPN IP&#x2D;MTU       &#x3A; 15&#x30;&#x30;,</p><p class="screen2" id="1383510">  SAP Count        &#x3A; 1,                   SDP Bind Count   &#x3A; 1,</p><p class="screen2" id="1383511">  RemoveIngressTag &#x3A; No,                  Option           &#x3A; Pseudo&#x2D;wire,</p><p class="screen2" id="1383513">  Mgmt Change      &#x3A; 12&#47;&#x30;5&#47;2&#x30;15 18&#x3A;42&#x3A;43, Status Change    &#x3A; 12&#47;&#x30;5&#47;2&#x30;15 18&#x3A;42&#x3A;43</p><p class="text" id="1383514">The &#x201c;Option&#x201d; field indicates that service 1&#x30;&#x30; is a pseudo&#x2D;wire service (tunnel endpoints are manually configured to define a single point&#x2D;to&#x2D;point tunnel connection between two SPB attachment points). If this field displays <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">None</span>, the service is operating in the default multipoint&#x2D;to&#x2D;multipoint mode (tunnel endpoints are automatically defined between all the SPB nodes with the same I&#x2D;SID.</p><p class="text" id="1383518">To verify the virtual ports associated with a pseudo&#x2D;wire service, use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_15149__show_service_spb_ports" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service ports</a> command. For example, the following command displays the virtual port information for pseudo&#x2D;wire service 1&#x30;&#x30;&#x3A;</p><p class="screen" id="1383519">&#x2D;&#x3E; show service 1&#x30;&#x30; ports</p><p class="screen2" id="1383520">Legend&#x3A; (&#x2A;)Dyn unicast (+)Remote Mcast (&#x23;)Local Mcast (&#x2D;)ERP Ring</p><p class="screen2" id="1383521">SPB Service 1&#x30;&#x30; Info</p><p class="screen2" id="1383522"> Admin &#x3A; Up,   Oper  &#x3A; Down, Stats      &#x3A; Y,       Mtu     &#x3A; 9194, VlanXlation &#x3A; N,</p><p class="screen2" id="1383523"> ISID  &#x3A; 1&#x30;&#x30;&#x30;, BVlan &#x3A; 4&#x30;&#x30;1, MCast&#x2D;Mode &#x3A; Headend, Tx&#47;Rx   &#x3A; &#x30;&#47;&#x30;,  RemoveIngTag&#x3A; N,</p><p class="screen2" id="1383524"> PW&#x2D;Enb&#x3A; Y,</p><p class="screen2" id="1383525"><br/></p><p class="screen2" id="1383526">                                  Sap Trusted&#x3A;Priority&#47;         Sap Description &#47;</p><p class="screen2" id="1383527">Identifier        Adm  Oper Stats Sdp SystemId&#x3A;BVlan   Intf     Sdp SystemName</p><p class="screen2" id="1383528">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1383529">sap&#x3A;1&#47;1&#47;5&#x3A;all     Up   Up    N           Y&#x3A;x           1&#47;1&#47;5       &#x2D;</p><p class="screen2" id="1383530">sdp&#x3A;32768&#x3A;1&#x30;&#x30;&#x2A;    Up   Up    N    e8e7.32f8.5b41&#x3A;4&#x30;&#x30;&#x30;  &#x30;&#47;12&#x30;    X72_VC</p><p class="screen2" id="1383531"><br/></p><p class="screen2" id="1383532">Total Ports&#x3A; 2</p><p class="text" id="1383533">MAC learning is automatically disabled for SAP 1&#47;1&#47;5&#x3A;all and SDP 32768&#x3A;1&#x30;&#x30;, because service 1&#x30;&#x30; defines an endpoint for a pseudo&#x2D;wire connection.</p><p class="heading3" id="1383535"><a id="XREF_86413__SPB_Pseudo-Wire_Configuration_Example163" name="XREF_86413__SPB_Pseudo-Wire_Configuration_Example163">SPB Pseudo&#x2D;Wire Configuration Example</a></p><p class="text" id="1383536"><a id="163_text_1383536" name="163_text_1383536"></a>The following diagram shows an example of a pseudo&#x2D;wire point&#x2D;to&#x2D;point connection between two remote sites across the SPB network cloud. In this sample topology, </p><p class="bullet" id="1383537"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Customer Edge&#x2D;1 (CE&#x2D;1) carries different traffic flows from its site to the attachment point SAP on BEB&#x2D;1, which is configured as an endpoint for the pseudo&#x2D;wire. The traffic is then transparently forwarded across the SPB network towards the other end of the pseudo&#x2D;wire on BEB&#x2D;2.</p><p class="bullet" id="1383538"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Customer&#x2D;Edge&#x2D;2 receives the traffic flows from CE&#x2D;1 in the original format. </p><p class="bullet" id="1383539"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>As the number of users increases between the two customer sites, the number of MAC addresses does not increase, as there is no MAC address learning on the pseudo&#x2D;wire SAP attachment points or the SPB network ports on BEB&#x2D;1 and BEB&#x2D;2.</p><p class="text" id="1383764"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_180.svg" height="239.486654" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1383766">Figure 7&#x2D;15 &#x3A;  <a id="XREF_39573__Remote_SAP_Pseudo-Wire_Connection163" name="XREF_39573__Remote_SAP_Pseudo-Wire_Connection163">Remote SAP Pseudo&#x2D;Wire Connection</a></p><p class="text" id="1383767"><a id="163_text_1383767" name="163_text_1383767"></a>The two sites (CE&#x2D;1 and CE&#x2D;2) are connected through the pseudo&#x2D;wire as if they were on the same single line (E&#x2D;LINE). The following diagram shows a logical depiction of how traffic flows between the devices that are remotely connected through the pseudo&#x2D;wire as if they were locally connected.</p><p class="text" id="1383975"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_190.svg" height="224.153442" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1383976">Figure 7&#x2D;16 &#x3A;  Devices Remotely Connected on a Pseudo&#x2D;Wire</p><p class="text" id="1383977">The following CLI command examples are used to configure BEB&#x2D;1 and BEB&#x2D;2 in the sample SPB pseudo&#x2D;wire topology&#x3A;</p><p class="example1" id="1383978">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="example2" id="1383979">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="example2" id="1383980">&#x2D;&#x3E; spb isis interface port 1&#47;1&#47;5</p><p class="example2" id="1383981">&#x2D;&#x3E; service access port 1&#47;1&#47;1&#x30;</p><p class="example2" id="1383982">&#x2D;&#x3E; service 1&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;1 pseudo&#x2D;wire enable description &quot;Pseudo&#x2D;wire for ISID 1&#x30;&#x30;&#x30;&quot;</p><p class="example2" id="1383983">&#x2D;&#x3E; service 1&#x30;&#x30; sap port 1&#47;1&#47;1&#x30;&#x3A;all</p><p class="example2" id="1383984">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="heading2" id="1357116"><a id="XREF_32410__Configuring_Remote_Fault_Propagation_for_SPBM163" name="XREF_32410__Configuring_Remote_Fault_Propagation_for_SPBM163">Configuring Remote Fault Propagation for SPBM</a></p><p class="text" id="1164595"><a id="163_text_1164595" name="163_text_1164595"></a>Remote Fault Propagation (RFP) for SPBM monitors SPB access ports to detect link failures that cause interruptions to SPB services. The status of an access port and any associated I&#x2D;SID is advertised within an RFP domain using Continuity Check Message (CCM) packets. When a CCM packet is received that indicates an access port for a specific I&#x2D;SID is down, the corresponding access port associated with the same I&#x2D;SID is automatically taken down.</p><p class="text" id="1165551">Consider the following recommended guidelines when configuring RFP for SPBM&#x3A;</p><p class="bullet" id="1165675"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configuring an RFP domain involves creating a local Maintenance End Point (MEP) on each switch that will participate in the RFP domain. The MEP is mapped to a reserved Ethernet OAM domain. This type of domain counts towards the maximum limit of Ethernet OAM domains allowed.</p><p class="bullet" id="1180810"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The SPB Control BVLAN serves as the primary VLAN for all RFP domains. CCM packets are sent across the SPBM network to all BEB devices on the Control BVLAN. However, CCM packets are not encapsulated with SPB header information.</p><p class="bullet" id="1186148"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Make sure to use the same CCM interval value for all local MEPs that participate in the same RFP domain. A mismatch will prevent reliable communication between MEPs.</p><p class="bullet" id="1176296"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The SPB service associated with the I&#x2D;SID that RFP will monitor should be configured on only two Backbone Edge Bridges (BEBs) in the network. </p><p class="bullet" id="1165676"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The SPB service associated with an I&#x2D;SID is mapped to only one SAP. For example, SPB service 1&#x30; bound to I&#x2D;SID 15&#x30;&#x30; is mapped only to a SAP configured on port 1&#47;12; service 1&#x30; is not mapped to any other SAP on the same switch.</p><p class="bullet" id="1165677"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configure only one SAP on a physical access port; configuring additional SAPs on the same port is not recommended.</p><p class="bullet" id="1165678"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configure a SAP associated with an RFP monitored port on only one physical port of the BEB.</p><p class="heading3" id="1164730">Configuring an RFP Domain</p><p class="text" id="1177571">A local Maintenance End Point (MEP) and a corresponding remote end point list are configured on each BEB that will participate in an RFP domain. The domain to which each end point is assigned is determined by the RFP domain ID associated with each end point. The domain ID is defined at the time the local MEP is created using the <a id="index_1193044" name="index_1193044"></a><a data-indexterm="%3Cindex%3Eservice%20rfp%20local-endpoint%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_rfp_local-endpoint%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_rfp_local-endpoint%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_65613__service_rfp_local-endpoint" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service rfp local-endpoint</a> command. For example&#x3A;</p><p class="example1" id="1171013">&#x2D;&#x3E; service rfp 1 local&#x2D;endpoint 1&#x30; type spb</p><p class="text" id="1170552">In this example, RFP domain 1 is created with a local MEP ID of 1&#x30;. By default, the CCM interval is set to 1 second, the domain level is set to 7, and the administrative status is enabled for RFP domain 1. To set different values for these parameters, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service rfp local&#x2D;endpoint</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ccm&#x2D;interval</span>, <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">level</span>, or <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">admin&#x2D;state</span> parameters. For example&#x3A;</p><p class="example1" id="1186540">&#x2D;&#x3E; service rfp 1 local&#x2D;endpoint 1&#x30; ccm&#x2D;interval interval1&#x30;s level 6 admin&#x2D;state disable type spb</p><p class="text" id="1186541">In this example, RFP domain 1 with local MEP ID 1&#x30; is created with the CCM interval set to 1&#x30; seconds, the domain level set to 6, and the administrative status disabled.</p><p class="text" id="1171700">The parameter values used to created an RFP domain are used to create a reserved Ethernet OAM domain on the local switch to which the RFP domain is mapped. The reserved OAM domain is given the name &#x201c;RFP_OVER_SPB_DOMAIN_LEVELx&#x201d;, where x is the number specified with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">level</span> parameter. It is important to note that each RFP domain created must use a different level number. For example, if RFP domain 1 uses level 7, then RFP domain 2 must use a different level number (for example, level 6). </p><p class="text" id="1186546">All the reserved OAM domains that are automatically created for RFP domains are assigned to the same &#x201c;RFP_OVER_SPB_ASSOCIATION&#x201d; Maintenance Association (MA).</p><p class="text" id="1172470">Use the <a id="index_1193049" name="index_1193049"></a><a data-indexterm="%3Cindex%3Eshow%20service%20rfp%20configuration%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_service_rfp_configuration%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_service_rfp_configuration%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_30385__show_service_rfp_configuration" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service rfp configuration</a> to display the Ethernet OAM domain parameters configured and associated with the RFP domain. For example, the following shows the OAM domain reserved for the RFP 1 domain ID&#x3A;</p><p class="example1" id="1172768">&#x2D;&#x3E; show service rfp configuration</p><p class="example2" id="1172769">Total Number of RFP domains &#x2D; 1</p><p class="example2" id="1172770"><br/></p><p class="example2" id="1172771">RFP Domain Number       &#x3A; 1</p><p class="example2" id="1172772">Admin Status            &#x3A; Enabled</p><p class="example2" id="1172773">Level                   &#x3A; 7</p><p class="example2" id="1172774">Type                    &#x3A; SPB</p><p class="example2" id="1172775">Maintenance Domain      &#x3A; RFP_OVER_SPB_DOMAIN_LEVEL7</p><p class="example2" id="1172776">Maintenance Association &#x3A; RFP_OVER_SPB_ASSOCIATION</p><p class="example2" id="1172777">Control B&#x2D;VLAN          &#x3A; 5&#x30;&#x30;</p><p class="example2" id="1172778">Virtual UP MEP ID       &#x3A; 1&#x30;</p><p class="example2" id="1172779">CCM Interval            &#x3A; 1&#x30; minutes</p><p class="example2" id="1172780">Remote Endpoint           Service Id</p><p class="example2" id="1172764">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="text" id="1170923">In this example, the &#x201c;Remote Endpoint&#x201d; and &#x201c;Service Id&#x201d; fields are blank because a list of remote end points and SPB services has not yet been created for RFP domain 1. A remote end point list provides a list of remote MEP IDs (local MEP IDs configured on other BEBs) and a list of SPB service IDs that are active on the local BEB. CCM packets are sent to all the remote MEP IDs on the list to advertise the status of the local SAP ports and I&#x2D;SIDs associated with the specified SPB services. </p><p class="text" id="1170896">To create a remote end point list for RFP domain 1, use the <a id="index_1193054" name="index_1193054"></a><a data-indexterm="%3Cindex%3Eservice%20rfp%20remote-endpoint%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eservice_rfp_remote-endpoint%3Cdefault_para_font%3E_command" name="%3Cindex%3Eservice_rfp_remote-endpoint%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_78530__service_rfp_remote-endpoint" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service rfp remote-endpoint</a> command. For example&#x3A;</p><p class="example1" id="1173102">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 2 service&#x2D;id 1&#x30;&#x2D;12</p><p class="text" id="1170532">In this example, remote end point 2 is the MEP ID that identifies a remote BEB that is participating in the same RFP domain. The service IDs 1&#x30;, 11, and 12 are the SPB services bound to the RFP 1 domain. </p><p class="text" id="1174564">Creating a remote end point list triggers the transmission of CCM packets carrying I&#x2D;SID and port status information related to the specified SPB services. Configure a different remote end point for each remote BEB that needs to receive the CCM packet information for a specific service. For example, the following commands add MEP ID 3 and 4 as remote end points to receive status for services 13 and 14&#x3A;</p><p class="example1" id="1175944">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 3 service&#x2D;id 13</p><p class="example2" id="1176237">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 4 service&#x2D;id 14</p><p class="text" id="1173955">Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_30385__show_service_rfp_configuration" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service rfp configuration</a> to display the RFP Ethernet OAM domain configuration showing the remote end points added to RFP domain 1. For example&#x3A;</p><p class="example1" id="1173956">&#x2D;&#x3E; show service rfp configuration</p><p class="example2" id="1173957">Total Number of RFP domains &#x2D; 1</p><p class="example2" id="1173958"><br/></p><p class="example2" id="1173959">RFP Domain Number       &#x3A; 1</p><p class="example2" id="1173960">Admin Status            &#x3A; Enabled</p><p class="example2" id="1173961">Level                   &#x3A; 7</p><p class="example2" id="1173962">Type                    &#x3A; SPB</p><p class="example2" id="1173963">Maintenance Domain      &#x3A; RFP_OVER_SPB_DOMAIN_LEVEL7</p><p class="example2" id="1173964">Maintenance Association &#x3A; RFP_OVER_SPB_ASSOCIATION</p><p class="example2" id="1173965">Control B&#x2D;VLAN          &#x3A; 5&#x30;&#x30;</p><p class="example2" id="1173966">Virtual UP MEP ID       &#x3A; 1&#x30;</p><p class="example2" id="1173967">CCM Interval            &#x3A; 1&#x30; minutes</p><p class="example2" id="1173968">Remote Endpoint           Service Id</p><p class="example2" id="1174202">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="example2" id="1174203">2                          1&#x30;</p><p class="example2" id="1179548">2                          11</p><p class="example2" id="1179567">2                          12</p><p class="example2" id="1179563">3                          13</p><p class="example2" id="1174307">4                          14</p><p class="heading4" id="1190003">Deleting the RFP Domain</p><p class="text" id="1176967">To remove an RFP domain configuration from the switch, use the following command<span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">&#x3A;</span></p><p class="example1" id="1177139">&#x2D;&#x3E; no service rfp 1</p><p class="text" id="1177135">The above command removes all of the RFP configuration items, including the reserved Ethernet OAM domain for the specified RFP ID.</p><p class="heading4" id="1189416">Modifying the local MEP ID</p><p class="text" id="1177323">To change a local end point (MEP ID), first set the ID to zero using the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service rfp local&#x2D;endpoint</span> command and specify the existing ID number. For example&#x3A;</p><p class="example1" id="1178149">&#x2D;&#x3E; no service rfp 1 local&#x2D;endpoint 1&#x30;</p><p class="text" id="1178291">Next, set the local MEP ID to a different value. For example, the following command sets a new value of 15 for the local MEP ID&#x3A;</p><p class="example1" id="1189458">&#x2D;&#x3E; service rfp 1 local&#x2D;endpoint 15</p><p class="heading4" id="1190040">Removing an SPB Service from RFP Monitoring</p><p class="text" id="1190044">To discontinue RFP monitoring of SPB service instances within an RFP domain, remove the local MEP ID from the remote end point list on each BEB that terminates the service. To remove a MEP ID from a remote end point list, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service rfp remote&#x2D;endpoint </span>command. For example&#x3A;</p><p class="example1" id="1174502">&#x2D;&#x3E; no service rfp 1 remote&#x2D;endpoint 2 </p><p class="text" id="1174495">In this example, MEP ID 2 is removed from the remote end point list along with all SBP services associated with MEP ID 1. RFP will no longer monitor and advertise the status of local services to remote MEP ID 2. </p><p class="text" id="1189406">To remove a specific SPB service from a remote end point list, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">no</span> form of the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service rfp remote&#x2D;endpoint</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service&#x2D;id</span> parameter. For example, the following command removes SPB service 1&#x30; associated with MEP ID 2&#x3A;</p><p class="example1" id="1179616">&#x2D;&#x3E; no service rfp 1 remote&#x2D;endpoint 2 service&#x2D;id 1&#x30;</p><p class="text" id="1173943">In this example, SPB service 1&#x30; was removed from the end point list for MEP ID 2. However, RFP will continue to monitor and advertise all other services to this remote end point. </p><p class="text" id="1190875">It is important to consider that when a MEP ID or a specific SPB service ID is removed from the end point list on the local switch, a port violation will occur. This can cause an undesirable service interruption when attempting to simply unbind a service from an RFP domain. To avoid a port violation condition, remove the SPB service ID from both ends of the SPB tunnel at the same time. </p><p class="heading3" id="1170088">Verifying the RFP for SPB Configuration&#160;&#160;&#160;&#160;&#160;&#160;</p><p class="text" id="1179977">To verify the connectivity between remote end points within an RFP domain, use the <a id="index_1193059" name="index_1193059"></a><a data-indexterm="%3Cindex%3Eshow%20service%20rfp%3Cdefault%20para%20font%3E%20command" id="%3Cindex%3Eshow_service_rfp%3Cdefault_para_font%3E_command" name="%3Cindex%3Eshow_service_rfp%3Cdefault_para_font%3E_command"></a><a href="../c_svcmgr/c_svcmgr.htm#XREF_18064__show_service_rfp" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service rfp</a> command. For example&#x3A;</p><p class="screen2" id="1180147"><br/></p><p class="screen2" id="1180185">&#x2D;&#x3E; show service rfp</p><p class="screen2" id="1180148"><br/></p><p class="screen2" id="1180149">Local system (Name &#x3A; SystemId) &#x3D;  Edge&#x2D;39 &#x3A; e8e7.326c.4a39</p><p class="screen2" id="1180150">Total number of services information  &#x3D; 2</p><p class="screen2" id="1180151">Total number of RFP domain  &#x3D; 3</p><p class="screen2" id="1180152">RFP    Remote   RMEP      System                     B&#x2D;VLAN ISID    Service Admin</p><p class="screen2" id="1180153">       EndPoint Status    (Name &#x3A; SystemId)                         Id      State</p><p class="screen2" id="1180154">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1180155">1      2        RMEP_OK  Edge&#x2D;43&#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;e7&#x3A;&#x30;9&#x3A;a3 5&#x30;&#x30;    1&#x30;&#x30;1    1&#x30;      Enabled</p><p class="screen2" id="1180143">1      2        RMEP_OK  Edge&#x2D;43&#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;e7&#x3A;&#x30;9&#x3A;a3 5&#x30;&#x30;    1&#x30;&#x30;2    11      Enabled</p><p class="screen2" id="1180686">1      2        RMEP_OK  Edge&#x2D;43&#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;e7&#x3A;&#x30;9&#x3A;a3 5&#x30;&#x30;    1&#x30;&#x30;3    12      Enabled</p><p class="screen2" id="1181806"><br/></p><p class="text" id="1180804">To verify the status of the local SAP associated with the RFP domain, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show service rfp</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">local&#x2D;sap&#x2D;status</span> parameter. For example&#x3A;</p><p class="screen2" id="1180805"><br/></p><p class="screen2" id="1181267">&#x2D;&#x3E; show service rfp 1 local&#x2D;sap&#x2D;status</p><p class="screen2" id="1180770"><br/></p><p class="screen2" id="1180771">Local endpoint ID &#x3D; 1&#x30;</p><p class="screen2" id="1180772">Local system (Name &#x3A; SystemId)  &#x3D; Edge&#x2D;39 &#x3A; e8e7.326c.4a39</p><p class="screen2" id="1180773">Service  Sap                Admin         Oper           Remote         R&#x2D;Endpoint</p><p class="screen2" id="1180774">Id                                                       Endpoint       Status</p><p class="screen2" id="1180775">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1180776">1&#x30;       sap&#x3A;1&#47;12&#x3A;all       Enabled       Down           2              RMEP_OK</p><p class="screen2" id="1187443">11       sap&#x3A;1&#47;11&#x3A;all       Enabled       Down           2              RMEP_OK</p><p class="screen2" id="1187451">12       sap&#x3A;1&#47;1&#x30;&#x3A;all       Enabled       Down           2              RMEP_OK</p><p class="screen2" id="1187452"><br/></p><p class="text" id="1187456">As previously described, use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_30385__show_service_rfp_configuration" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show service rfp configuration</a> command to display the parameter values associated with the RFP domain. For example&#x3A;</p><p class="example1" id="1181766">&#x2D;&#x3E; show service rfp configuration</p><p class="example2" id="1181767">Total Number of RFP domains &#x2D; 1</p><p class="example2" id="1181768"><br/></p><p class="example2" id="1181769">RFP Domain Number       &#x3A; 1</p><p class="example2" id="1181770">Admin Status            &#x3A; Enabled</p><p class="example2" id="1181771">Level                   &#x3A; 7</p><p class="example2" id="1181772">Type                    &#x3A; SPB</p><p class="example2" id="1181773">Maintenance Domain      &#x3A; RFP_OVER_SPB_DOMAIN_LEVEL7</p><p class="example2" id="1181774">Maintenance Association &#x3A; RFP_OVER_SPB_ASSOCIATION</p><p class="example2" id="1181775">Control B&#x2D;VLAN          &#x3A; 5&#x30;&#x30;</p><p class="example2" id="1181776">Virtual UP MEP ID       &#x3A; 1&#x30;</p><p class="example2" id="1181777">CCM Interval            &#x3A; 1&#x30; minutes</p><p class="example2" id="1181778">Remote Endpoint           Service Id</p><p class="example2" id="1181779">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="example2" id="1181780">2                          1&#x30;</p><p class="example2" id="1181781">2                          11</p><p class="example2" id="1181782">2                          12</p><p class="heading3" id="1214880"><a id="XREF_35424__RFP_for_SPB_Configuration_Example163" name="XREF_35424__RFP_for_SPB_Configuration_Example163">RFP for SPB Configuration Example</a></p><p class="text" id="1214881"><a id="163_text_1214881" name="163_text_1214881"></a>This section contains CLI command examples used to configure the RFP domain functionality deployed in the following sample SPB network topology&#x3A;<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_195.svg" height="323.911601" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1231393">Figure 7&#x2D;17 &#x3A;  RFP for SPB Example</p><p class="text" id="1214980">In this topology, RFP domain 1 is created by configuring a Maintenance End Point (MEP) on each OmniSwitch serving as an SPB BEB. The local MEP ID associated with each switch (MEP 1, 2, 3, and 4) identifies that switch as a participant in the RFP domain. As shown in the above diagram&#x3A;</p><p class="bullet" id="1214981"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Three I&#x2D;SIDs (15&#x30;&#x30;, 16&#x30;&#x30;, and 17&#x30;&#x30;) are each bound to a separate SAP port (1&#47;1, 1&#47;2, and 1&#47;3) on BEB&#x2D;1. This represents one end of each SPB service. </p><p class="bullet" id="1214982"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The other end of each SPB service is bound to SAP ports on BEB&#x2D;2 (I&#x2D;SID 15&#x30;&#x30;), BEB&#x2D;3 (I&#x2D;SID 16&#x30;&#x30;), and BEB&#x2D;3 (I&#x2D;SID 17&#x30;&#x30;).</p><p class="bullet" id="1214983"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The RFP configuration on BEB&#x2D;1 specifies the MEP ID of the other three BEBs as remote end points to which the local status of the three I&#x2D;SIDS and SAP ports is advertised using CCM packets.</p><p class="bullet" id="1214984"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The RFP configuration on BEB&#x2D;2 specifies the MEP ID of BEB&#x2D;1 as a remote end point to which the local status of I&#x2D;SID 15&#x30;&#x30; and SAP port 2&#47;1 is advertised using CCM packets.</p><p class="bullet" id="1214985"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The RFP configuration on BEB&#x2D;3 specifies the MEP ID of BEB&#x2D;1 as a remote end point to which the local status of I&#x2D;SID 16&#x30;&#x30; and SAP port 2&#47;1 is advertised using CCM packets.</p><p class="bullet" id="1214986"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The RFP configuration on BEB&#x2D;4 specifies the MEP ID of BEB&#x2D;1 as a remote end point to which the local status of I&#x2D;SID 17&#x30;&#x30; and SAP port 2&#47;1 is advertised using CCM packets.</p><p class="bullet" id="1214987"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When SAP port 2&#47;1 goes down on BEB&#x2D;2, the port down status is reported in the CCM transmitted from BEB&#x2D;2 to BEB&#x2D;1. </p><p class="bullet" id="1214988"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When BEB&#x2D;1 receives the CCM packet from BEB&#x2D;2 and detects the port down status, BEB&#x2D;1 administratively downs the corresponding SAP port 1&#47;1. The service associated with I&#x2D;SID 15&#x30;&#x30; stops on both ends of the service (BEB&#x2D;1 and BEB&#x2D;2).</p><p class="bullet" id="1214989"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When the downed port on BEB&#x2D;2 is brought back up, BEB&#x2D;1 receives the port up status from BEB&#x2D;2 and brings the local SAP port 1&#47;1 back up as well. </p><p class="text" id="1214990">The following CLI command examples include the SPB commands used to create the SPB service layer that RFP will monitor.</p><p class="text" id="1214991">BEB&#x2D;1&#x3A;</p><p class="screen" id="1214992">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1214993">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 2</p><p class="screen2" id="1214994">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1214995">&#x2D;&#x3E; spb isis interface port 1&#47;2&#x30;</p><p class="screen2" id="1214996">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1214997">&#x2D;&#x3E; service access port 1&#47;1</p><p class="screen2" id="1214998">&#x2D;&#x3E; service access port 1&#47;2</p><p class="screen2" id="1214999">&#x2D;&#x3E; service access port 1&#47;3</p><p class="screen2" id="1215000">&#x2D;&#x3E; service spb 1 isid 15&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215001">&#x2D;&#x3E; service spb 2 isid 16&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215002">&#x2D;&#x3E; service spb 3 isid 17&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215003">&#x2D;&#x3E; service spb 1 sap port 1&#47;1&#x3A;all admin&#x2D;state enable</p><p class="screen2" id="1215004">&#x2D;&#x3E; service spb 2 sap port 1&#47;2&#x3A;all admin&#x2D;state enable</p><p class="screen2" id="1215005">&#x2D;&#x3E; service spb 3 sap port 1&#47;3&#x3A;all admin&#x2D;state enable</p><p class="screen2" id="1215006"><br/></p><p class="screen2" id="1215007">&#x2D;&#x3E; service rfp 1 local&#x2D;endpoint 1 ccm&#x2D;interval interval1&#x30;&#x30;ms type spb</p><p class="screen2" id="1215008">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 2 service&#x2D;id 1 admin&#x2D;status enable</p><p class="screen2" id="1215009">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 3 service&#x2D;id 2 admin&#x2D;status enable</p><p class="screen2" id="1215010">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 4 service&#x2D;id 3 admin&#x2D;status enable</p><p class="screen2" id="1215071"><br/></p><p class="text" id="1215011">BEB&#x2D;2&#x3A;</p><p class="screen" id="1215012">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215013">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 2</p><p class="screen2" id="1215014">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1215015">&#x2D;&#x3E; spb isis interface port 1&#47;21</p><p class="screen2" id="1215016">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1215017">&#x2D;&#x3E; service access port 2&#47;1</p><p class="screen2" id="1215018">&#x2D;&#x3E; service spb 1 isid 15&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215019">&#x2D;&#x3E; service spb 1 sap port 2&#47;1&#x3A;all admin&#x2D;state enable</p><p class="screen2" id="1215020"><br/></p><p class="screen2" id="1215021">&#x2D;&#x3E; service rfp 1 local&#x2D;endpoint 2 ccm&#x2D;interval interval1&#x30;&#x30;ms type spb</p><p class="screen2" id="1215022">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 1 service&#x2D;id 1 admin&#x2D;status enable</p><p class="screen2" id="1215074"><br/></p><p class="text" id="1215023">BEB&#x2D;3&#x3A;</p><p class="screen" id="1215024">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215025">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 2</p><p class="screen2" id="1215026">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1215027">&#x2D;&#x3E; spb isis interface port 1&#47;22</p><p class="screen2" id="1215028">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1215029">&#x2D;&#x3E; service access port 2&#47;1</p><p class="screen2" id="1215030">&#x2D;&#x3E; service spb 2 isid 16&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215031">&#x2D;&#x3E; service spb 2 sap port 2&#47;1&#x3A;all admin&#x2D;state enable</p><p class="screen2" id="1215032"><br/></p><p class="screen2" id="1215033">&#x2D;&#x3E; service rfp 1 local&#x2D;endpoint 3 ccm&#x2D;interval interval1&#x30;&#x30;ms type spb</p><p class="screen2" id="1215034">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 1 service&#x2D;id 2 admin&#x2D;status enable</p><p class="screen2" id="1215077"><br/></p><p class="text" id="1215035">BEB&#x2D;4&#x3A;</p><p class="screen" id="1215036">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215037">&#x2D;&#x3E; spb isis bvlan 4&#x30;&#x30;1 ect&#x2D;id 2</p><p class="screen2" id="1215038">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="screen2" id="1215039">&#x2D;&#x3E; spb isis interface port 1&#47;23</p><p class="screen2" id="1215040">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="screen2" id="1215041">&#x2D;&#x3E; service access port 2&#47;1</p><p class="screen2" id="1215042">&#x2D;&#x3E; service spb 3 isid 17&#x30;&#x30; bvlan 4&#x30;&#x30;1 admin&#x2D;state enable</p><p class="screen2" id="1215043">&#x2D;&#x3E; service spb 3 sap port 2&#47;1&#x3A;all admin&#x2D;state enable</p><p class="screen2" id="1215044"><br/></p><p class="screen2" id="1215045">&#x2D;&#x3E; service rfp 1 local&#x2D;endpoint 4 ccm&#x2D;interval interval1&#x30;&#x30;ms type spb</p><p class="screen2" id="1215046">&#x2D;&#x3E; service rfp 1 remote&#x2D;endpoint 1 service&#x2D;id 3 admin&#x2D;status enable</p><p class="heading2" id="1182392"><a id="XREF_26416__Configuring_IP_over_SPB163" name="XREF_26416__Configuring_IP_over_SPB163">Configuring IP over SPB</a></p><p class="text" id="1245842"><a id="163_text_1245842" name="163_text_1245842"></a>Configuring IP over SPB, as described in <a  href="#XREF_21917__IP_over_SPB-M163" style="color:#0000ff;background-color:transparent;">IP over SPBM</a>, requires the following general steps&#x3A;</p><p class="bullet" id="1339586"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Define an L3 VPN interface to serve as a gateway address to remote networks. The following options are available for configuring an L3 VPN interface (refer to the table on <a  href="#XREF_72523__Supported_L3_VPN_Interface_Options163" style="color:#0000ff;background-color:transparent;">page 7-20</a> to determine which L3 VPN interface options are supported based on the switch platform)&#x3A; </p><p class="bullet_sub" id="1339529"><span class="bold">&#x2013;&#160;&#160;&#160; </span>An external loopback port configuration.</p><p class="bullet_sub" id="1245851"><span class="bold">&#x2013;&#160;&#160;&#160; </span>An IP service&#x2D;based interface configured through software for single&#x2D;pass inline routing.</p><p class="bullet_sub" id="1264485"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Front&#x2D;panel ports configured through software for two&#x2D;pass inline routing.</p><p class="bullet" id="1245852"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Determine whether to use the VPN&#x2D;Lite or L3 VPN (ISIS&#x2D;SPB) approach for routing L3 traffic over an L2 SPBM backbone network.</p><p class="bullet" id="1245853"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>To implement the VPN&#x2D;Lite approach, configure dynamic routing protocols (such as OSPF) or static routes directly on the L3 VPN interface.</p><p class="bullet" id="1245854"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>To implement the L3 VPN (ISIS&#x2D;SPB) approach, configure a binding between a VRF instance, an SPB I&#x2D;SID, and an IP gateway (the L3 VPN interface address). This binding will enable bidirectional exchange of routes between the VRF and SPB I&#x2D;SID via the Global Route Manager (GRM).</p><p class="bullet_sub" id="1245855"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Optionally configure a route map to filter routes that are imported or exported between the VRF and I&#x2D;SID defined in an L3 VPN binding.</p><p class="bullet_sub" id="1245856"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Optionally configure additional methods for route leaking, such as route redistribution to allow routing between a VRF instance and an I&#x2D;SID or between two I&#x2D;SIDs.</p><p class="heading3" id="1245857"><a id="XREF_29739__IP_over_SPB_Configuration_Guidelines163" name="XREF_29739__IP_over_SPB_Configuration_Guidelines163">IP over SPB Configuration Guidelines</a></p><p class="text" id="1245858"><a id="163_text_1245858" name="163_text_1245858"></a>Consider the following guidelines when configuring IP over SPB&#x3A;</p><p class="bullet" id="1245859"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An L3 VPN interface serves as an IP gateway to access remote networks. The network administrator must ensure the IP subnet reachability of the L3 VPN addresses on the same SPBM I&#x2D;SID.</p><p class="bullet" id="1264982"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>IPv4 L3 VPN interfaces use dynamic ARP and IPv6 L3 VPN interfaces use neighbor discovery to learn the MAC addresses of other L3 VPN interfaces and provide next&#x2D;hop forwarding information to the switch.</p><p class="bullet" id="1265215"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The following SPB inline routing (L3 VPN) solutions are available. Each solution is supported on specific switch platforms, as noted in the table on <a  href="#XREF_68509__In-line_Routing163" style="color:#0000ff;background-color:transparent;">page 7-20</a>.</p><p class="bullet_sub" id="1266399"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Single&#x2D;pass inline routing&#x2014;an L3 VPN interface is defined through the configuration of an IP interface that is bound to an SPB service.</p><p class="bullet_sub" id="1266658"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Two&#x2D;pass inline routing using a single front panel port&#x2014;an L3 VPN interface is defined through the configuration of front panel ports or a link aggregate to run in loopback mode.</p><p class="bullet" id="1336293"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When creating an L3 VPN interface for single&#x2D;pass inline routing, assigning an existing SPB service to an IP interface is required. The IP address assigned to the service interface is used as a gateway address to bind a VRF instance to an SPB backbone service instance identifier (I&#x2D;SID). When assigning an SPB service to an IP interface, consider the following&#x3A;</p><p class="bullet_sub" id="1265216"><span class="bold">&#x2013;&#160;&#160;&#160; </span>VLAN translation is implicitly enabled when a service is assigned to an IP interface regardless of        whether or not VLAN translation is enabled for the service; the VLAN translation status is no longer configurable as long as the service is bound to an IP interface.</p><p class="bullet_sub" id="1267765"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Configuring multiple IP addresses (IP multinetting) for the same service&#x2D;based interface is not supported.</p><p class="bullet" id="1275987"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When creating an L3 VPN interface for two&#x2D;pass inline routing, consider the following&#x3A;</p><p class="bullet_sub" id="1275989"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The loopback function is defined on a single port or link aggregate (instead of two separate ports or link aggregates). This eliminates the need for a physical cable to connect two different ports to create the loopback. The same port is assigned to the L3 VPN VLAN and is also configured as a service access port.</p><p class="bullet_sub" id="1272929"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A dedicated VLAN and a port or link aggregate configured to operate in the loopback mode is required.</p><p class="bullet_sub" id="1275616"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Once a port or link aggregate is configured to run in the loopback mode, no other functionality is supported on the port or link aggregate.</p><p class="bullet_sub" id="1273058"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The dedicated VLAN is reserved for the L3 VPN and can only be associated with the loopback port or link aggregate. To ensure this, configure the L3 VPN IP interface using the router port and tagged VLAN options, where the router port is the loopback port and the tagged VLAN is the dedicated VLAN.</p><p class="bullet_sub" id="1272787"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The full bandwidth of the loopback port is available to forward traffic in and out of the SPB service. In addition, multiple front&#x2D;panel loopback ports can be combined into a static loopback link aggregate for redundancy and to increase bandwidth.</p><p class="bullet_sub" id="1276424"><span class="bold">&#x2013;&#160;&#160;&#160; </span>When configuring the loopback port or link aggregate as an access port and creating an SPB service, enable VLAN translation.</p><p class="bullet_sub" id="1277533"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Once the loopback mode is enabled for a link aggregate, the link aggregate is dedicated to providing loopback functionality for an SPB L3 VPN inline routing configuration. The loopback mode is disabled only when the link aggregate is deleted.</p><p class="bullet" id="1271096"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>There are two scenarios for mapping a VRF instance to an I&#x2D;SID&#x3A; </p><p class="bullet_sub" id="1248307"><span class="bold">&#x2013;&#160;&#160;&#160; </span>One VRF to one I&#x2D;SID</p><p class="bullet_sub" id="1248308"><span class="bold">&#x2013;&#160;&#160;&#160; </span>One VRF to many I&#x2D;SIDs</p><p class="bullet" id="1248369"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>When an L3 VPN (ISIS&#x2D;SPB) &#x201c;bind&#x201d; entry goes active, ISIS&#x2D;SPB will export learned routes from the SPB network to the GRM, which triggers the GRM to send IP routes from the corresponding VRF to ISIS&#x2D;SPB using the ISID and gateway IP address as the next hop.</p><p class="bullet" id="1248439"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The difference between an L3 VPN (ISIS&#x2D;SPB) bind entry and a redistribution entry is as follows&#x3A;</p><p class="bullet_sub" id="1249007"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A bind entry binds only one I&#x2D;SID to one VRF, IP gateway instance. IP VPN routes are then imported and exported bidirectionally between the VRF and I&#x2D;SID.</p><p class="bullet_sub" id="1248391"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A redistribution entry allows multiple VRFs to redistribute routes into one I&#x2D;SID. However, IP VPN routes are only redistributed into the I&#x2D;SID; there is no bidirectional exchange of routes between the VRF and I&#x2D;SID. Redistribution is mainly used when routing between I&#x2D;SIDs is required.</p><p class="bullet" id="1248371"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>If exchanging routes between different VRF networks associated with different I&#x2D;SIDs (inter&#x2D;service routing) is required, the L3 VPN (ISIS&#x2D;SPB) approach supports the following route leaking methods&#x3A;</p><p class="bullet_sub" id="1248340"><span class="bold">&#x2013;&#160;&#160;&#160; </span>VRF&#x2D;to&#x2D;VRF (route import&#47;export)</p><p class="bullet_sub" id="1248341"><span class="bold">&#x2013;&#160;&#160;&#160; </span>VRF&#x2D;to&#x2D;I&#x2D;SID (route redistribution)</p><p class="bullet_sub" id="1248342"><span class="bold">&#x2013;&#160;&#160;&#160; </span>I&#x2D;SID&#x2D;to&#x2D;I&#x2D;SID (route redistribution)</p><p class="bullet_sub" id="1248343"><span class="bold">&#x2013;&#160;&#160;&#160; </span>I&#x2D;SID&#x2D;to&#x2D;VRF (route import)</p><p class="heading3" id="1247366"><a id="XREF_73214__Configuring_the_L3_VPN_Interface163" name="XREF_73214__Configuring_the_L3_VPN_Interface163">Configuring the L3 VPN Interface</a></p><p class="text" id="1304523"><a id="163_text_1304523" name="163_text_1304523"></a>Identify the BEBs that will participate in routing L3 traffic through the SPBM core. On each of these BEBs, configure the required L3 VPN interface configuration. Use one of the following options to configure this&#160;type of interface based on the switch platform&#x3A;</p><p class="bullet" id="1304527"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_84303__L3_VPN_External_Loopback_Interface163" style="font-weight:normal;color:#0000ff;background-color:transparent;">L3 VPN Interface&#58; External Loopback</a>.</p><p class="bullet" id="1304531"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_17772__L3_VPN_Inline_Routing_Interface_(OmniSwitch_9900)163" style="font-weight:normal;color:#0000ff;background-color:transparent;">L3 VPN Interface&#58; Inline Routing (Service-Based IP Interface)</a>.</p><p class="bullet" id="1270111"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_31253__Front-Panel_Ports_(Om163" style="font-weight:normal;color:#0000ff;background-color:transparent;">L3 VPN Interface&#58; Inline Routing with a Front-Panel Port</a>.</p><p class="bullet" id="1277905"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_83375__Inline_Routing_with_Internal_Link_Agg163" style="font-weight:normal;color:#0000ff;background-color:transparent;">L3 VPN Interface&#58; Inline Routing with a Static Link Aggregate</a>.</p><p class="heading4" id="1270015" style="margin-top : 11.00pt;margin-bottom : 7.00pt;font-family : Times New Roman ; font-size : 10.50pt;font-kerning:none;"><span class="Times_Bold" style="background-color:transparent;"><a id="XREF_84303__L3_VPN_External_Loopback_Interface163" name="XREF_84303__L3_VPN_External_Loopback_Interface163" style="background-color:transparent;">L3 VPN Interface&#x3A; </a></span><span class="Times_Bold" style="background-color:transparent;">External Loopback</span></p><p class="text" id="1244197"><a id="163_text_1244197" name="163_text_1244197"></a>The following commands create an external loopback port configuration that will serve as an L3 VPN interface&#x3A;</p><p class="example1" id="1234456" style="text-indent : 4.03pt;">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="example2" id="1234457" style="text-indent : 4.03pt;">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="example2" id="1234458" style="text-indent : 4.03pt;">&#x2D;&#x3E; spb bvlan 5&#x30;&#x30;</p><p class="example2" id="1265572" style="text-indent : 4.03pt;">&#x2D;&#x3E; spb isis control&#x2D;bvlan 5&#x30;&#x30;</p><p class="example2" id="1234459" style="text-indent : 4.03pt;">&#x2D;&#x3E; service access port 1&#47;1&#47;2 vxlan&#x2D;xlation</p><p class="example2" id="1234460" style="text-indent : 4.03pt;">&#x2D;&#x3E; service 1&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 5&#x30;&#x30; admin&#x2D;state enable</p><p class="example2" id="1234461" style="text-indent : 4.03pt;">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30;</p><p class="example2" id="1234462" style="text-indent : 4.03pt;">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="example2" id="1234463" style="text-indent : 4.03pt;">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface IPv4&#x2D;L3vpn1 vlan 4&#x30;&#x30; address 1&#x30;.1.1.1&#47;24</p><p class="example2" id="1251766" style="text-indent : 4.03pt;">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface IPv6&#x2D;L3vpn1 vlan 4&#x30;&#x30; address 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="example2" id="1252286" style="text-indent : 4.03pt;">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface IPv6&#x2D;L3vpn2 vlan 4&#x30;&#x30; address 2&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="indented1" id="1381167" style="margin-left : 36.00pt;text-indent : 0.00pt;">Once the above loopback port configuration is defined, use a physical cable to connect port 1&#47;1&#47;1 to access port 1&#47;1&#47;2. The SPB BVLAN and I&#x2D;SID are required to create the SAP for access port 1&#47;1&#47;2. See <a  href="#XREF_24341__Multiple_I-SIDs163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN External Loopback and Inline Routing&#58; Two I-SIDs&#44; One VRF</a> for an example configuration of an L3 VPN loopback interface.</p><p class="heading4" id="1381172" style="margin-top : 11.00pt;margin-bottom : 7.00pt;font-family : Times New Roman ; font-size : 10.50pt;font-kerning:none;"><span class="Times_Bold" style="background-color:transparent;"><a id="XREF_17772__L3_VPN_Inline_Routing_Interface_(OmniSwitch_9900)163" name="XREF_17772__L3_VPN_Inline_Routing_Interface_(OmniSwitch_9900)163" style="background-color:transparent;">L3 VPN Interface&#x3A; Inline Routing (Service&#x2D;Based IP Interface)</a></span></p><p class="text" id="1381173"><a id="163_text_1381173" name="163_text_1381173"></a>The following commands provide an example for creating an L3 VPN service&#x2D;based IP interface for single&#x2D;pass inline routing&#x3A;</p><p class="example1" id="1265553">&#x2D;&#x3E; spb bvlan 5&#x30;&#x30;</p><p class="example2" id="1265618">&#x2D;&#x3E; spb isis control&#x2D;bvlan 5&#x30;&#x30;</p><p class="example2" id="1265569">&#x2D;&#x3E; service 1&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 5&#x30;&#x30; admin&#x2D;state enable</p><p class="example2" id="1265623">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="example2" id="1221153">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface IPv4&#x2D;L3vpn3 service 1&#x30; address 1&#x30;&#x30;.1.1.1&#47;8</p><p class="example2" id="1257281">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface IPv6&#x2D;L3vpn4 service 1&#x30; address 4&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="indented1" id="1382337">In this example, the &#x201c;IPv4&#x2D;L3vpn3&#x201d; and &#x201c;IPv6&#x2D;L3vpn4&#x201d; interfaces are created in the &#x201c;vrf&#x2D;1&#x201d; instance and bound to SPB service 1&#x30;. See <a  href="#XREF_20311__L3_VPN_for_Customer_Services163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN Inline Routing&#58; Service-Based (Two I-SIDS&#44; Two VRFs)</a> for an example configuration of an L3 VPN service&#x2D;based interface.<div align="left"><table class="Note" style="max-width: 100% ;height: auto;"><col width="600.00px"/><tr height="86.00px"><td><p class="CellBody_note_text" id="1382964" style="font-kerning:none;"><span class="Times_Bold">Note.  </span>If inline routing is <span class="Times_italics" style="font-style:Italic;background-color:transparent;">not</span> going to be configured on the <span data-keyref="Platforms Supported_OS6860N">OmniSwitch 6860N</span>&#160;or on the <span data-keyref="Platforms Supported_OS6900-X48C6/X48C4E/T48C6/V48C8">OmniSwitch 6900-X48C6&#47;X48C4E&#47;T48C6&#47;V48C8</span>,<span style="font-weight:Bold;color:#ff0000;">&#160;</span>inline routing support can be disabled on these models using the <span style="font-kerning:normal;"><a href="../c_svcmgr/c_svcmgr.htm#XREF_42517__service_l3vpn_profile" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service l3vpn profile</a></span><span style="font-kerning:normal;"> command. This will free up additional switch resources for other non&#x2D;inline routing functionality. </span>See the <span class="Times_italics" data-keyref="CLI Reference Guide" style="font-family : Times New Roman ; font-weight:normal;font-style:Italic;font-size : 10.50pt;text-decoration:none;font-kerning:none;text-transform:none;font-stretch:normal;color:#000000;background-color:transparent;letter-spacing : 0.00em;">OmniSwitch AOS Release 8 CLI Reference Guide</span> for more information about the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">service l3vpn profile</span> command.</p></td></tr></table></div></p><p class="heading4" id="1382346" style="margin-top : 11.00pt;margin-bottom : 7.00pt;font-family : Times New Roman ; font-size : 10.50pt;font-kerning:none;"><span class="Times_Bold" style="background-color:transparent;"><a id="XREF_31253__Front-Panel_Ports_(Om163" name="XREF_31253__Front-Panel_Ports_(Om163" style="background-color:transparent;">L3 VPN Interface&#x3A; Inline Routing with a Front&#x2D;Panel Port</a></span></p><p class="text" id="1319356"><a id="163_text_1319356" name="163_text_1319356"></a>The following commands provide an example for creating an L3 VPN interface using a front&#x2D;panel loopback port&#x3A;</p><p class="step_first" id="1273543"><span class="Futura_Bold">1&#160;&#160;&#160; </span>Use the <a href="../c_esm/c_esm.htm#XREF_11128__show_interfaces_flow" style="font-weight:Bold;color:#0000ff;background-color:transparent;">interfaces</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">loopback</span> option to configure a port to operate in the loopback mode. For example&#x3A;</p><p class="example1" id="1275084">&#x2D;&#x3E; interfaces port 1&#47;1&#47;18 loopback</p><p class="step_next" id="1273863"><span class="Futura_Bold">2&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_50401__service_access" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service access</a> command to configure the loopback port as a service access port with VLAN translation enabled. For example&#x3A;</p><p class="example1" id="1266120">&#x2D;&#x3E; service access port 1&#47;1&#47;18 vlan&#x2D;xlation</p><p class="step_next" id="1274096"><span class="Futura_Bold">3&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_95469__service_spb" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service spb</a> command to create an SPB service with VLAN translation enabled. For example;</p><p class="example1" id="1274204">&#x2D;&#x3E; service 1&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 5&#x30;&#x30; vlan&#x2D;xlation</p><p class="step_next" id="1274098"><span class="Futura_Bold">4&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_73897__service_spb_sap" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap</a> command to create a SAP that binds the loopback port to the SPB service and the L3 VPN VLAN. For example&#x3A;</p><p class="example1" id="1269925">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;18&#x3A;4&#x30;&#x30;</p><p class="step_next" id="1274383"><span class="Futura_Bold">5&#160;&#160;&#160; </span>Use the <a href="../c_ip/c_ip.htm#XREF_40097__arp" style="font-weight:Bold;color:#0000ff;background-color:transparent;">vrf</a> command to create the VRF instance (or use the default VRF instance) in which the IP VPN interface will be created.&#160;For example&#x3A;</p><p class="example1" id="1266007">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="step_next" id="1275100"><span class="Futura_Bold">6&#160;&#160;&#160; </span>To create an IPv4 VPN interface, use the <a href="../c_ip/c_ip.htm#XREF_47089__ip_interface_rtr-port" style="font-weight:Bold;color:#0000ff;background-color:transparent;">ip interface rtr-port</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">tagged vlan</span> option. Specify the VLAN ID of the L3 VPN VLAN with this command. For example&#x3A;</p><p class="example1" id="1275101">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface L3VPN address 1&#x30;&#x30;.1.1.1&#47;8 rtr&#x2D;port port 1&#47;1&#47;18 tagged vlan 4&#x30;&#x30;</p><p class="step_next" id="1275259"><span class="Futura_Bold">7&#160;&#160;&#160; </span>To create an IPv6 VPN interface, use the <a href="../c_ipv6/c_ipv6.htm#XREF_47089__ip_interface_rtr-port" style="font-weight:Bold;color:#0000ff;background-color:transparent;">ipv6 interface rtr-port</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">vlan</span> option and the <a href="../c_ipv6/c_ipv6.htm#XREF_67040__ipv6_address" style="font-weight:Bold;color:#0000ff;background-color:transparent;">ipv6 address</a> command. Specify the VLAN ID of the L3 VPN VLAN with this command. For example&#x3A;</p><p class="example1" id="1275261">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface L3VPN rtr&#x2D;port port 1&#47;1&#47;18 tagged vlan 4&#x30;&#x30;</p><p class="example2" id="1275262">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 address 2&#x30;&#x30;1&#x3A;db8&#x3A;1&#x30;&#x3A;&#x3A;1&#47;64 L3VPN</p><p class="text" id="1280089">See <a  href="#XREF_51169__Front-Panel_Ports163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN Inline Routing&#58; Front-Panel Ports</a> for an example configuration in which a front&#x2D;panel port serves as an L3 VPN interface.</p><p class="heading4" id="1270190" style="margin-top : 11.00pt;margin-bottom : 7.00pt;font-family : Times New Roman ; font-size : 10.50pt;font-kerning:none;"><span class="Times_Bold" style="background-color:transparent;"><a id="XREF_83375__Inline_Routing_with_Internal_Link_Agg163" name="XREF_83375__Inline_Routing_with_Internal_Link_Agg163" style="background-color:transparent;">L3 VPN Interface&#x3A; </a></span><span class="Times_Bold" style="background-color:transparent;">Inline</span><span class="Times_Bold" style="background-color:transparent;"> Routing with a Static Link Aggregate</span></p><p class="text" id="1278019"><a id="163_text_1278019" name="163_text_1278019"></a>The following commands provide an example for creating an L3 VPN interface using a static loopback link aggregate comprised of loopback ports&#x3A;</p><p class="step_first" id="1278023"><span class="Futura_Bold">1&#160;&#160;&#160; </span>Use the <a href="../c_esm/c_esm.htm#XREF_58132__interfaces_loopback" style="font-weight:Bold;color:#0000ff;background-color:transparent;">interfaces loopback</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">loopback</span> option to configure ports to operate in the loopback mode. For example&#x3A;</p><p class="example1" id="1278031">&#x2D;&#x3E; interfaces port 1&#47;1&#47;18&#x2D;21 loopback</p><p class="step_next" id="1278035"><span class="Futura_Bold">2&#160;&#160;&#160; </span>Use the <a href="../c_lnkagg/c_lnkagg.htm#XREF_63111__linkagg_static_agg_loopback" style="font-weight:Bold;color:#0000ff;background-color:transparent;">linkagg static agg loopback</a> command to configure a static link aggregate to operate in the loopback mode. For example&#x3A;</p><p class="example1" id="1278028">&#x2D;&#x3E; linkagg static agg 1 size 4</p><p class="example2" id="1274930">&#x2D;&#x3E; linkagg static agg 1 loopback</p><p class="step_next" id="1274888"><span class="Futura_Bold">3&#160;&#160;&#160; </span>Use the <a href="../c_lnkagg/c_lnkagg.htm#XREF_77043__static_linkagg_delete" style="font-weight:Bold;color:#0000ff;background-color:transparent;">linkagg static port agg</a> command to assign the loopback ports to the link aggregate. For example&#x3A;</p><p class="example1" id="1278161">&#x2D;&#x3E; linkagg static port 1&#47;1&#47;18&#x2D;21 agg 1</p><p class="step_next" id="1278060"><span class="Futura_Bold">4&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_50401__service_access" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service access</a> command to configure the loopback link aggregate as a service access port with VLAN translation enabled. For example&#x3A;</p><p class="example1" id="1274889">&#x2D;&#x3E; service access linkagg 1 vlan&#x2D;xlation</p><p class="step_next" id="1274893"><span class="Futura_Bold">5&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_95469__service_spb" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service spb</a> command to create an SPB service with VLAN translation enabled. For example;</p><p class="example1" id="1274894">&#x2D;&#x3E; service 1&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 5&#x30;&#x30; vlan&#x2D;xlation</p><p class="step_next" id="1274898"><span class="Futura_Bold">6&#160;&#160;&#160; </span>Use the <a href="../c_svcmgr/c_svcmgr.htm#XREF_73897__service_spb_sap" style="font-weight:Bold;color:#0000ff;background-color:transparent;">service sap</a> command to create a SAP that binds the loopback link aggregate to the SPB service. For example&#x3A;</p><p class="example1" id="1274899">&#x2D;&#x3E; service 1&#x30; sap linkagg 1&#x30;&#x3A;4&#x30;&#x30;</p><p class="step_next" id="1274900"><span class="Futura_Bold">7&#160;&#160;&#160; </span>Create the VRF instance (or use the default VRF instance) that will be bound to the SPB service instance and IP gateway using the <a href="../c_ip/c_ip.htm#XREF_40097__arp" style="font-weight:Bold;color:#0000ff;background-color:transparent;">vrf</a> command. For example&#x3A;</p><p class="example1" id="1274904">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="step_next" id="1275385"><span class="Futura_Bold">8&#160;&#160;&#160; </span>To create an IPv4 VPN interface, use the <a href="../c_ip/c_ip.htm#XREF_47089__ip_interface_rtr-port" style="font-weight:Bold;color:#0000ff;background-color:transparent;">ip interface rtr-port</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">vlan</span> option. For example&#x3A;</p><p class="example1" id="1275386">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface L3VPN address 1&#x30;&#x30;.1.1.1&#47;8 rtr&#x2D;port linkagg 1&#x30; tagged vlan 4&#x30;&#x30;</p><p class="step_next" id="1275390"><span class="Futura_Bold">9&#160;&#160;&#160; </span>To create an IPv6 VPN interface, use the <a href="../c_ipv6/c_ipv6.htm#XREF_47089__ip_interface_rtr-port" style="font-weight:Bold;color:#0000ff;background-color:transparent;">ipv6 interface rtr-port</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">vlan</span> option and the <a href="../c_ipv6/c_ipv6.htm#XREF_67040__ipv6_address" style="font-weight:Bold;color:#0000ff;background-color:transparent;">ipv6 address</a> command. For example&#x3A;</p><p class="example1" id="1275394">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface L3VPN rtr&#x2D;port linkagg 1&#x30; tagged vlan 4&#x30;&#x30;</p><p class="example2" id="1275395">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 address 2&#x30;&#x30;1&#x3A;db8&#x3A;1&#x30;&#x3A;&#x3A;1&#47;64 L3VPN</p><p class="text" id="1280139">See <a  href="#XREF_51169__Front-Panel_Ports163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN Inline Routing&#58; Front-Panel Ports</a> for an example configuration in which a static link aggregate comprised of front&#x2D;panel loopback ports serves as an L3 VPN interface.</p><p class="heading3" id="1247428"><a id="XREF_54326__Configuring_the_VPN-Lite_Solution163" name="XREF_54326__Configuring_the_VPN-Lite_Solution163">Configuring the VPN&#x2D;Lite Solution</a></p><p class="text" id="1247440"><a id="163_text_1247440" name="163_text_1247440"></a>The VPN&#x2D;Lite approach requires configuring routing protocols on the L3 VPN interface that will exchange routes between the VLAN domain (VRF instance) and the SPB service domain (I&#x2D;SID). For example, the following commands configure static routes for L3 VPN interfaces (gateway address)&#x3A;</p><p class="example1" id="1137295">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 2&#x30;.&#x30;.&#x30;.&#x30;&#47;24 gateway 1&#x30;.1.1.1</p><p class="example2" id="1225298">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 1&#x30;.&#x30;.&#x30;.&#x30;&#47;24 gateway 2&#x30;.1.1.1</p><p class="example2" id="1251700"><br/></p><p class="example2" id="1251734">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 static&#x2D;route 15&#x30;&#x30;&#x3A;&#x3A;&#47;16 gateway 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="example2" id="1251735">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 static&#x2D;route 16&#x30;&#x30;&#x3A;&#x3A;&#47;16 gateway 2&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="heading3" id="1247459">Configuring the L3 VPN (ISIS&#x2D;SPB) Solution</p><p class="text" id="1247460">The L3 VPN (ISIS&#x2D;SPB) approach requires configuring a VRF&#x2D;ISID binding to identify the L3 VPN interface that will exchange routes between the VLAN domain (VRF instance) and the SPB service domain (I&#x2D;SID). VRF import and export commands are used to exchange routes between the VRF and the I&#x2D;SID specified in the binding configuration. For example&#x3A;</p><p class="example1" id="1137481">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="example2" id="1225507">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="example2" id="1252074">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1&#x30;.1.1.1 all&#x2D;routes</p><p class="example2" id="1252076">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="example2" id="1252069">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1252440">In this example, &#x201c;vrf&#x2D;1&#x201d; is bound to SPB I&#x2D;SID 1&#x30;&#x30;&#x30; and gateway 1&#x30;.1.1.1 identifies the IPv4 L3 VPN interface. All IPv4 routes in &#x201c;vrf&#x2D;1&#x201d; are exported to the Global Route Manager (GRM), which then exports the routes to I&#x2D;SID 1&#x30;&#x30;&#x30;. The last command in this sequence sets up the import of I&#x2D;SID 1&#x30;&#x30;&#x30; routes from the GRM into the &#x201c;vrf&#x2D;1&#x201d; instance. The <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">all&#x2D;routes</span> parameter specifies that no route&#x2D;map filtering is applied to exported or imported routes; all routes are allowed.</p><p class="example1" id="1252084">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export all&#x2D;routes</p><p class="example2" id="1252134">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="example2" id="1252157">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 3&#x30;&#x30;&#x30; gateway 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="example2" id="1252372">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="example2" id="1252389">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 3&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1252071">In this example, &#x201c;vrf&#x2D;1&#x201d; is bound to SPB I&#x2D;SID 3&#x30;&#x30;&#x30; and gateway 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1 identifies the IPv6 L3 VPN interface. All IPv6 routes in &#x201c;vrf&#x2D;1&#x201d; are exported to the GRM, which then exports the routes to I&#x2D;SID 3&#x30;&#x30;&#x30;. The last command in this sequence sets up the import of I&#x2D;SID 3&#x30;&#x30;&#x30; routes from the GRM into the &#x201c;vrf&#x2D;1&#x201d; instance. The <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">all&#x2D;routes</span> parameter specifies that no route&#x2D;map filtering is applied to exported or imported routes; all routes are allowed.</p><p class="heading4" id="1247480">Filtering Imported or Exported Routes</p><p class="text" id="1247481">To filter routes that are imported or exported, define a route map to use with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ip import</span> or <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">ip export</span> commands. For example, the following commands create the &#x201c;ipvpn&#x2D;vrf1&#x201d; route map and filter exported and imported routes&#x3A;</p><p class="example1" id="1247482">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip access&#x2D;list ipaddr</p><p class="example2" id="1247483">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip access&#x2D;list ipaddr address 15.&#x30;.&#x30;.&#x30;&#47;8 action permit redist&#x2D;control all&#x2D;subnets</p><p class="example2" id="1247484">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip route&#x2D;map ipvpn&#x2D;vrf1 sequence&#x2D;number 1 action permit</p><p class="example2" id="1247485">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip route&#x2D;map ipvpn&#x2D;vrf1 sequence&#x2D;number 1 match ip&#x2D;address ipaddr</p><p class="example2" id="1247486">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export ipvpn&#x2D;vrf1</p><p class="example2" id="1247487">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; ipvpn&#x2D;vrf1</p><p class="example2" id="1252531"><br/></p><p class="example2" id="1252533">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 access&#x2D;list ip6addr</p><p class="example2" id="1252574">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 access&#x2D;list ip6addr address 2&#x30;&#x30;1&#x3A;&#x3A;&#47;64 action permit redist&#x2D;control all subnets</p><p class="example2" id="1252683">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip route&#x2D;map ipvpn6&#x2D;vrf1 sequence&#x2D;number 1 action permit</p><p class="example2" id="1252751">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip route&#x2D;map ipvpn6&#x2D;vrf1 sequence&#x2D;number 1 match ipv6&#x2D;address ip6addr</p><p class="example2" id="1252918">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export ipvpn6&#x2D;vrf1</p><p class="example2" id="1252951">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 3&#x30;&#x30;&#x30; ipvpn6&#x2D;vrf1</p><p class="heading4" id="1247488">Configuring Route Redistribution Between VRFs and&#47;or I&#x2D;SIDs</p><p class="text" id="1247511">The L3 VPN (ISIS&#x2D;SPB) solution also allows for the redistribution of routes between a VRF instance and an I&#x2D;SID or between two I&#x2D;SIDs (inter&#x2D;I&#x2D;SID route leaking). For example, the following commands redistribute routes from I&#x2D;SID 2&#x30;&#x30;&#x30; into I&#x2D;SID 1&#x30;&#x30;&#x30;, from &#x201c;vrf&#x2D;1&#x201d; into I&#x2D;SID 2&#x30;&#x30;&#x30;, from I&#x2D;SID 4&#x30;&#x30;&#x30; into I&#x2D;SID 3&#x30;&#x30;&#x30;, and from &#x201c;vrf&#x2D;1&#x201d; into I&#x2D;SID 4&#x30;&#x30;&#x30;.</p><p class="example1" id="1247512">&#x2D;&#x3E; spb ipvpn redist source&#x2D;isid 2&#x30;&#x30;&#x30; destination&#x2D;isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="example2" id="1247513">&#x2D;&#x3E; spb ipvpn redist source&#x2D;vrf vrf&#x2D;1 destination&#x2D;isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="example2" id="1253004">&#x2D;&#x3E; spb ipvpn6 redist source&#x2D;isid 4&#x30;&#x30;&#x30; destination&#x2D;isid 3&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="example2" id="1253076">&#x2D;&#x3E; spb ipvpn6 redist source&#x2D;vrf vrf&#x2D;1 destination&#x2D;isid 4&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1247519">See <a  href="#XREF_45588__I-SID_Routing_in_One_VRF163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN External Loopback Interfaces&#58; I-SID Routing in One VRF</a> and <a  href="#XREF_26654__I-SID_Routing_in_Two_VRFs163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN External Loopback Interfaces&#58; I-SID Routing in Two VRFs</a> for examples of using route redistribution in an IP over SPB configuration.</p><p class="heading3" id="1138874">Verifying L3 VPN Configuration and Routes</p><p class="text" id="1138878">VRFs are bound to I&#x2D;SIDs to identify a VRF mapping to a specific SPB service instance for the purposes of exchanging routes between the VRF and I&#x2D;SID via the switch GRM. To verify the VRF mapping configuration on the local switch, use the <a href="../c_spb/c_spb.htm#XREF_48255__show_spb_ipvpn_bind" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb ipvpn bind</a> or <a href="../c_spb/c_spb.htm#XREF_97146__show_spb_ipvpn6_bind" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb ipvpn6 bind</a> command. For example&#x3A;</p><p class="screen" id="1151270">&#x2D;&#x3E; show spb ipvpn bind</p><p class="screen2" id="1138898">Legend&#x3A; &#x2A; indicates bind entry is active</p><p class="screen2" id="1138899">SPB IPVPN Bind Table&#x3A;</p><p class="screen2" id="1138900">       VRF              ISID            Gateway                 Route&#x2D;Map</p><p class="screen2" id="1138901">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1138902">&#x2A; vrf&#x2D;1                  1&#x30;&#x30;&#x30;         1&#x30;.1.1.1</p><p class="screen2" id="1138903">&#x2A; vrf&#x2D;2                  2&#x30;&#x30;&#x30;         2&#x30;.1.1.1</p><p class="screen2" id="1138904"><br/></p><p class="screen2" id="1138895">Total Bind Entries&#x3A; 2</p><p class="screen2" id="1253275"><br/></p><p class="screen2" id="1253288">&#x2D;&#x3E; show spb ipvpn6 bind</p><p class="screen2" id="1253289">Legend&#x3A; &#x2A; indicates bind entry is active</p><p class="screen2" id="1253290">SPB IPVPN Bind Table&#x3A;</p><p class="screen2" id="1253291">       VRF              ISID            Gateway                 Route&#x2D;Map</p><p class="screen2" id="1253292">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1253293">&#x2A; ospf                   3&#x30;&#x30;&#x30;         1&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="screen2" id="1253294">&#x2A; ospf1                  4&#x30;&#x30;&#x30;         2&#x30;&#x30;&#x30;&#x3A;&#x3A;1</p><p class="screen2" id="1253295"><br/></p><p class="screen2" id="1253277">Total Bind Entries&#x3A; 2</p><p class="text" id="1385234">In addition to exchanging routes between VRFs and I&#x2D;SIDs, it is also possible to configure redistribution of routes between two I&#x2D;SIDs or between a VRF and an I&#x2D;SID. To verify the redistribution configuration for L3 VPN routes, use the <a href="../c_spb/c_spb.htm#XREF_66430__show_spb_ipvpn_redist" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb ipvpn redist</a> or <a href="../c_spb/c_spb.htm#XREF_60648__show_spb_ipvpn6_redist" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb ipvpn6 redist</a> command. For example&#x3A;</p><p class="screen" id="1385241">&#x2D;&#x3E; show spb ipvpn redist</p><p class="screen2" id="1385242">Legend&#x3A; &#x2A; indicates redist entry is active</p><p class="screen2" id="1138925">SPB IPVPN Redist ISID Table&#x3A;</p><p class="screen2" id="1138926">  Source&#x2D;ISID           Destination&#x2D;ISID     Route&#x2D;Map</p><p class="screen2" id="1138927">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1138928">&#x2A; 2&#x30;&#x30;&#x30;                  1&#x30;&#x30;&#x30;</p><p class="screen2" id="1138929">&#x2A; 2&#x30;&#x30;1                  1&#x30;&#x30;1</p><p class="screen2" id="1138930"><br/></p><p class="screen2" id="1138931">Total Redist ISID Entries&#x3A; 2</p><p class="screen2" id="1239927"><br/></p><p class="screen2" id="1239938">Legend&#x3A; &#x2A; indicates redist entry is active</p><p class="screen2" id="1239939">SPB IPVPN Redist VRF Table&#x3A;</p><p class="screen2" id="1239940">  Source&#x2D;VRF            Destination&#x2D;ISID     Route&#x2D;Map</p><p class="screen2" id="1239941">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1239942">&#x2A; vrf&#x2D;1                 2&#x30;&#x30;&#x30;</p><p class="screen2" id="1385258"><br/></p><p class="screen2" id="1239943">Total Redist Vrf Entries&#x3A; &#x30;</p><p class="screen2" id="1253418">&#x2D;&#x3E; show spb ipvpnv6 redist</p><p class="screen2" id="1253419">Legend&#x3A; &#x2A; indicates redist entry is active</p><p class="screen2" id="1253420">SPB IPVPN6 Redist ISID Table&#x3A;</p><p class="screen2" id="1253421">  Source&#x2D;ISID           Destination&#x2D;ISID     Route&#x2D;Map</p><p class="screen2" id="1253422">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1253423">&#x2A; 4&#x30;&#x30;&#x30;                  3&#x30;&#x30;&#x30;</p><p class="screen2" id="1253424">&#x2A; 4&#x30;&#x30;1                  3&#x30;&#x30;1</p><p class="screen2" id="1253425"><br/></p><p class="screen2" id="1253426">Total Redist ISID Entries&#x3A; 2</p><p class="screen2" id="1253427"><br/></p><p class="screen2" id="1253428">Legend&#x3A; &#x2A; indicates redist entry is active</p><p class="screen2" id="1253429">SPB IPVPN6 Redist VRF Table&#x3A;</p><p class="screen2" id="1253430">  Source&#x2D;VRF            Destination&#x2D;ISID     Route&#x2D;Map</p><p class="screen2" id="1253431">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1253432">&#x2A; vrf&#x2D;1                 4&#x30;&#x30;&#x30;</p><p class="screen2" id="1253709"><br/></p><p class="screen2" id="1253433">Total Redist Vrf Entries&#x3A; &#x30;</p><p class="text" id="1239932">To display the L3 VPN route table, use the <a href="../c_spb/c_spb.htm#XREF_48854__show_spb_ipvpn_route-table" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb ipvpn route-table</a>&#160;or <a href="../c_spb/c_spb.htm#XREF_89510__show_spb_ipvpn6_route-table" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb ipvpn6 route-table</a> command. For example&#x3A;</p><p class="screen" id="1151282">&#x2D;&#x3E; show spb ipvpn route&#x2D;table</p><p class="screen2" id="1138951">Legend&#x3A; &#x2A; indicates IPVPN route has matching locally configured ISID</p><p class="screen2" id="1138952">SPB IPVPN Route Table&#x3A;</p><p class="screen2" id="1138953">                                                 Source Bridge</p><p class="screen2" id="1138954">     ISID  Destination         Gateway           (Name &#x3A; BMAC)               Metric</p><p class="screen2" id="1253905">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1253906">&#x2A;    4&#x30;&#x30;1  1.1.1.&#x30;&#47;24           1.1.1.1          L2&#x2D;DUT1 &#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;db&#x3A;c3&#x3A;65     1</p><p class="screen2" id="1253907">&#x2A;    4&#x30;&#x30;1  1.1.1.&#x30;&#47;24           1.1.1.2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253897">&#x2A;    4&#x30;&#x30;1  2.2.2.&#x30;&#47;24           1.1.1.2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253882">&#x2A;    4&#x30;&#x30;1  1&#x30;.1&#x30;.1&#x30;.&#x30;&#47;24        1.1.1.1          L2&#x2D;DUT1 &#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;db&#x3A;c3&#x3A;65     1</p><p class="screen2" id="1253935">&#x2A;    4&#x30;&#x30;3  1.1.1.&#x30;&#47;24           2.2.2.2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253936">&#x2A;    4&#x30;&#x30;3  2.2.2.&#x30;&#47;24           2.2.2.1          L2&#x2D;DUT2 &#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;dd&#x3A;99&#x3A;db     1</p><p class="screen2" id="1253937">&#x2A;    4&#x30;&#x30;3  2.2.2.&#x30;&#47;24           2.2.2.2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253938">&#x2A;    4&#x30;&#x30;3  1&#x30;.1&#x30;.1&#x30;.&#x30;&#47;24        2.2.2.2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253940"><br/></p><p class="screen2" id="1253982">Routes&#x3A; 8</p><p class="screen2" id="1253984"><br/></p><p class="screen2" id="1253913">&#x2D;&#x3E; show spb ipvpn6 route&#x2D;table</p><p class="screen2" id="1253914">Legend&#x3A; &#x2A; indicates IPVPN6 route has matching locally configured ISID</p><p class="screen2" id="1253915">SPB IPVPN6 Route Table&#x3A;</p><p class="screen2" id="1253916">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Source Bridge</p><p class="screen2" id="1253917">     ISID  Destination         Gateway           (Name &#x3A; BMAC)               Metric</p><p class="screen2" id="1253918">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1253919">&#x2A;    4&#x30;&#x30;1  15&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       1&#x30;&#x30;&#x30;&#x3A;&#x3A;1          L2&#x2D;DUT1 &#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;db&#x3A;c3&#x3A;65     1</p><p class="screen2" id="1253920">&#x2A;    4&#x30;&#x30;1  16&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       1&#x30;&#x30;&#x30;&#x3A;&#x3A;2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253921">&#x2A;    4&#x30;&#x30;1  17&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       1&#x30;&#x30;&#x30;&#x3A;&#x3A;2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253922">&#x2A;    4&#x30;&#x30;1  19&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       1&#x30;&#x30;&#x30;&#x3A;&#x3A;1          L2&#x2D;DUT1 &#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;db&#x3A;c3&#x3A;65     1</p><p class="screen2" id="1253949">&#x2A;    4&#x30;&#x30;3  15&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       2&#x30;&#x30;&#x30;&#x3A;&#x3A;2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253950">&#x2A;    4&#x30;&#x30;3  16&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       2&#x30;&#x30;&#x30;&#x3A;&#x3A;1          L2&#x2D;DUT2 &#x3A; &#x30;&#x30;&#x3A;e&#x30;&#x3A;b1&#x3A;dd&#x3A;99&#x3A;db     1</p><p class="screen2" id="1253951">&#x2A;    4&#x30;&#x30;3  17&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       2&#x30;&#x30;&#x30;&#x3A;&#x3A;2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253952">&#x2A;    4&#x30;&#x30;3  19&#x30;1&#x3A;&#x30;&#x30;&#x30;1&#x3A;&#x3A;&#47;32       2&#x30;&#x30;&#x30;&#x3A;&#x3A;2          L2&#x2D;DEV1 &#x3A; e8&#x3A;e7&#x3A;32&#x3A;&#x30;&#x30;&#x3A;23&#x3A;f9     1</p><p class="screen2" id="1253964"><br/></p><p class="screen2" id="1253966">Routes&#x3A; 8</p><p class="heading3" id="1214836"><a id="XREF_23405__Configuration_Examples163" name="XREF_23405__Configuration_Examples163">IP over SPB Configuration Examples</a></p><p class="text" id="1137545"><a id="163_text_1137545" name="163_text_1137545"></a>This section contains diagrams and CLI command examples for configuring the following IP over SPB scenarios&#x3A;</p><p class="bullet" id="1137546"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_20311__L3_VPN_for_Customer_Services163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN Inline Routing&#58; Service-Based (Two I-SIDS&#44; Two VRFs)</a>.</p><p class="bullet" id="1279483"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_51169__Front-Panel_Ports163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN Inline Routing&#58; Front-Panel Ports</a>.</p><p class="bullet" id="1226868"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_24341__Multiple_I-SIDs163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN External Loopback and Inline Routing&#58; Two I-SIDs&#44; One VRF</a>.</p><p class="bullet" id="1137551"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_45588__I-SID_Routing_in_One_VRF163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN External Loopback Interfaces&#58; I-SID Routing in One VRF</a>.</p><p class="bullet" id="1256335"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_25642__I-SID_Routing_in163" style="color:#0000ff;background-color:transparent;">IPv6 L3 VPN External Loopback Interfaces&#58; I-SID Routing in One VRF</a>.</p><p class="bullet" id="1139769"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_26654__I-SID_Routing_in_Two_VRFs163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN External Loopback Interfaces&#58; I-SID Routing in Two VRFs</a>.</p><p class="bullet" id="1256358"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_59495__I-SID_Routing_in163" style="color:#0000ff;background-color:transparent;">IPv6 L3 VPN External Loopback Interfaces&#58; I-SID Routing in Two VRFs</a>.</p><p class="bullet" id="1336966"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_27375__L3_VPN_External_Loopback_Migration_to_Service-Base163" style="color:#0000ff;background-color:transparent;">L3 VPN External Loopback Migration to Inline Routing</a>.</p><p class="heading3" id="1247586"><a id="XREF_20311__L3_VPN_for_Customer_Services163" name="XREF_20311__L3_VPN_for_Customer_Services163">IPv4 L3 VPN </a>Inline Routing&#x3A; Service&#x2D;Based (Two I&#x2D;SIDS, Two VRFs)</p><p class="text" id="1247587"><a id="163_text_1247587" name="163_text_1247587"></a>In this sample IPv4 over SPB topology, Customer Edge (CE) devices can communicate with other CE devices through L3 VPN services that traverse the SPB backbone network. Because the <span data-keyref="Platforms Supported_OS9900">OmniSwitch 9900</span> is used in this example topology, the IPv4 L3 VPN interfaces are defined by creating an IPv4 interface within each VRF instance that is bound to an SPB service.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_205.svg" height="475.111023" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="528.609192"></object></p><p class="FigureTitle" id="1247653">Figure 7&#x2D;18 &#x3A;  <a id="XREF_35174_%11L3_VPN_Services163" name="XREF_35174_%11L3_VPN_Services163">IPv4 L3 VPN Service&#x2D;based Interfaces (Inline Routing)</a></p><p class="text" id="1255347"><a id="163_text_1255347" name="163_text_1255347"></a>In this topology, Customer 1 requires L3 VPN services between CE 1&#x2D;1 and CE 1&#x2D;2, and Customer 2 requires L3 VPN services between CE 2&#x2D;1 and CE 2&#x2D;2. </p><p class="bullet" id="1255348"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>BEB&#x2D;1 is connected to two customer edge devices (CE 1&#x2D;1 and CE 2&#x2D;1).</p><p class="bullet" id="1247656"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>BEB&#x2D;2 is connected to two customer edge devices (CE 1&#x2D;2 and CE 2&#x2D;2).</p><p class="bullet" id="1247657"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 1&#47;I&#x2D;SID 1&#x30;&#x30;&#x30; and VRF A are dedicated to Customer 1.</p><p class="bullet" id="1247658"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 2&#47;I&#x2D;SID 2&#x30;&#x30;&#x30; and VRF B are dedicated to Customer 2.</p><p class="bullet" id="1247659"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An IPv4 interface is configured in VRF A and bound to SPB service 1 to define an IPv4 L3 VPN interface for Customer 1.</p><p class="bullet" id="1247660"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An IPv4 interface is configured in VRF B and bound to SPB service 2 to define an IPv4 L3 VPN interface for Customer 2.</p><p class="bullet" id="1247661"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>VPN routes are learned on the BEB switches through L3 VPN (ISIS&#x2D;SPB) or VPN&#x2D;lite and are then installed into the appropriate VRFs. </p><p class="bullet" id="1247662"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The nexthop interface for VPN routes is through the IPv4 L3 VPN interfaces. For example, </p><p class="bullet_sub" id="1247663"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The VPN routes in BEB&#x2D;1 for VRF&#x2D;A are installed with the next hop set to1&#x30;&#x30;.&#x30;.&#x30;.2, and the VPN routes in BEB&#x2D;2 for VRF&#x2D;A are installed with the nexthop set to1&#x30;&#x30;.&#x30;.&#x30;.1.</p><p class="bullet_sub" id="1247664"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The VPN routes in BEB&#x2D;1 for VRF&#x2D;B are installed with the next hop set to 2&#x30;&#x30;.&#x30;.&#x30;.2, and the VPN routes in BEB&#x2D;2 for VRF&#x2D;B are installed with the next hop set to 2&#x30;&#x30;.&#x30;.&#x30;.1.</p><p class="text" id="1303882">The following CLI command examples are used to configure the sample IPv4 over SPB topology shown in <a  href="#XREF_35174_%11L3_VPN_Services163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN Service-based Interfaces (Inline Routing)</a>. </p><p class="text" id="1303886">BEB&#x2D;1&#x3A;</p><p class="screen" id="1247670">&#x2D;&#x3E; vlan 1&#x30;&#x30;</p><p class="screen2" id="1247671">&#x2D;&#x3E; vlan 1&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1247672">&#x2D;&#x3E; service 1 spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable</p><p class="screen2" id="1247673">&#x2D;&#x3E; vrf create vrf&#x2D;A</p><p class="screen2" id="1247674">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip interface ip&#x2D;a1 address 15.&#x30;.&#x30;.1&#47;8 vlan 1&#x30;&#x30;</p><p class="screen2" id="1247761">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn&#x2D;a1 address 1&#x30;&#x30;.&#x30;.&#x30;.1&#47;8 service 1</p><p class="screen2" id="1247676">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1247677"><br/></p><p class="screen2" id="1247678">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1247679">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;2 tagged </p><p class="screen2" id="1247680">&#x2D;&#x3E; service 2 spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable</p><p class="screen2" id="1247681">&#x2D;&#x3E; vrf create vrf&#x2D;B</p><p class="screen2" id="1247682">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip interface ip&#x2D;b1 address 16.&#x30;.&#x30;.1&#47;8 vlan 2&#x30;&#x30;</p><p class="screen2" id="1247773">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn&#x2D;b1 address 2&#x30;&#x30;.&#x30;.&#x30;.1&#47;8 service 2</p><p class="text" id="1247684">BEB&#x2D;2&#x3A;</p><p class="screen2" id="1247685">&#x2D;&#x3E; vlan 3&#x30;&#x30;</p><p class="screen2" id="1247686">&#x2D;&#x3E; vlan 3&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1247687">&#x2D;&#x3E; service 1 spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1247688">&#x2D;&#x3E; vrf create vrf&#x2D;A</p><p class="screen2" id="1247785">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip interface ip&#x2D;a2 address 115.&#x30;.&#x30;.1&#47;8 vlan 3&#x30;&#x30;</p><p class="screen2" id="1247786">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn&#x2D;a2 address 1&#x30;&#x30;.&#x30;.&#x30;.2&#47;8 service 1</p><p class="screen2" id="1247691"><br/></p><p class="screen2" id="1247692">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1247693">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;2 tagged</p><p class="screen2" id="1247694">&#x2D;&#x3E; service 2 spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable</p><p class="screen2" id="1247695">&#x2D;&#x3E; vrf create vrf&#x2D;B</p><p class="screen2" id="1247798">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip interface ip&#x2D;b2 address 116.&#x30;.&#x30;.1&#47;8 vlan 4&#x30;&#x30;</p><p class="screen2" id="1247799">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn&#x2D;b2 address 2&#x30;&#x30;.&#x30;.&#x30;.2&#47;8 service 2</p><p class="text" id="1247698" style="font-weight:Bold;text-decoration: underline;"><span class="Times_Bold" style="font-size : 11.00pt;text-decoration: underline;background-color:transparent;">VPN&#x2D;Lite</span><span class="Times_Bold" style="text-decoration: underline;background-color:transparent;">&#160;</span></p><p class="text" id="1247811">The VPN&#x2D;Lite approach requires configuring routing protocols to run on the L3 VPN interface or defining static routes with a remote L3 VPN interface as a gateway. The following commands provide examples of configuring either OSPF or static routes for a VPN&#x2D;Lite configuration.</p><p class="text" id="1247812">BEB&#x2D;1 (OSPF&#x2014;the interface name specified is the name of the IPv4 L3 VPN service&#x2D;based interface)&#x3A;</p><p class="screen" id="1247813">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip load ospf</p><p class="screen2" id="1247814">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;a1</p><p class="screen2" id="1247815">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247816">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;a1 area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247817">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;a1 admin&#x2D;state enable</p><p class="screen2" id="1247818">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf admin&#x2D;state enable</p><p class="screen2" id="1247819"><br/></p><p class="screen2" id="1247820">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip load ospf</p><p class="screen2" id="1247821">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;b1</p><p class="screen2" id="1247822">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247823">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;b1 area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247824">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;b1 admin&#x2D;state enable</p><p class="screen2" id="1247825">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf admin&#x2D;state enable</p><p class="text" id="1247826">BEB&#x2D;1 (Static Routes&#x2014;the gateway IP address specified is the IP address of the IPv4 L3 VPN service&#x2D;based interface)&#x3A;</p><p class="screen" id="1247827">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 115.&#x30;.&#x30;.&#x30;&#47;8 gateway 1&#x30;&#x30;.&#x30;.&#x30;.2</p><p class="screen2" id="1247828">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 116.&#x30;.&#x30;.&#x30;&#47;8 gateway 2&#x30;&#x30;.&#x30;.&#x30;.2</p><p class="text" id="1247840">BEB&#x2D;2 (OSPF&#x2014;the interface name specified is the name of the IPv4 L3 VPN service&#x2D;based interface)&#x3A;</p><p class="screen" id="1247841">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip load ospf</p><p class="screen2" id="1247842">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;a2</p><p class="screen2" id="1247843">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247844">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;a2 area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247845">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;a2 admin&#x2D;state enable</p><p class="screen2" id="1247846">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip ospf admin&#x2D;state enable</p><p class="screen2" id="1247847"><br/></p><p class="screen2" id="1247848">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip load ospf</p><p class="screen2" id="1247849">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;b2</p><p class="screen2" id="1247850">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247851">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;b2 area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1247852">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf interface l3vpn&#x2D;b2 admin&#x2D;state enable</p><p class="screen2" id="1247853">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip ospf admin&#x2D;state enable</p><p class="text" id="1247854">BEB&#x2D;2 (Static Routes&#x2014;the gateway IP address specified is the IP address of the IPv4 L3 VPN service&#x2D;based interface)&#x3A;</p><p class="screen" id="1247855">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 15.&#x30;.&#x30;.&#x30;&#47;8 gateway 1&#x30;&#x30;.&#x30;.&#x30;.1</p><p class="screen2" id="1247856">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 16.&#x30;.&#x30;.&#x30;&#47;8 gateway 2&#x30;&#x30;.&#x30;.&#x30;.1</p><p class="screen2" id="1247912"><br/></p><p class="text" id="1247706" style="margin-top : 8.00pt;line-height : 12.00pt;font-weight:Bold;font-size : 11.00pt;text-decoration: underline;"><span class="Times_Bold" style="font-size : 11.00pt;text-decoration: underline;background-color:transparent;">L3 VPN</span></p><p class="text" id="1247900">The L3 VPN (ISIS&#x2D;SPB) approach exchanges L3 routes between VRFs. Instead of configuring routing protocols on the L3 VPN interface (VPN&#x2D;Lite), VRFs are bound to backbone I&#x2D;SIDs to connect VRFs across the SPBM network. IP routes are then imported into ISIS&#x2D;SPB from the VRFs where IPVPN TLVs are used to carry the routes through the network to other SPBM BEB switches.</p><p class="text" id="1247901">The following commands are used only when configuring an L3 VPN (ISIS&#x2D;SPB) configuration (the gateway IP address specified is the IP address of the IPv4 L3 VPN service&#x2D;based interface).</p><p class="text" id="1247708">BEB&#x2D;1&#x3A;</p><p class="screen" id="1247709">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1247710">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1247711">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;A isid 1&#x30;&#x30;&#x30; gateway 1&#x30;&#x30;.&#x30;.&#x30;.1 all&#x2D;routes</p><p class="screen2" id="1247712">&#x2D;&#x3E; vrf vrf&#x2D;A</p><p class="screen2" id="1247713">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1247714">vrf A&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1247715"><br/></p><p class="screen2" id="1247716">&#x2D;&#x3E; vrf vrf&#x2D;B</p><p class="screen2" id="1247717">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1247718">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1247719">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;B isid 2&#x30;&#x30;&#x30; gateway 2&#x30;&#x30;.&#x30;.&#x30;.1 all&#x2D;routes</p><p class="screen2" id="1247720">&#x2D;&#x3E; vrf vrf&#x2D;B</p><p class="screen2" id="1247721">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1247722">vrf B&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="text" id="1247723">BEB&#x2D;2&#x3A;</p><p class="screen" id="1247724">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1247725">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1247726">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;A isid 1&#x30;&#x30;&#x30; gateway 1&#x30;&#x30;.&#x30;.&#x30;.2 all&#x2D;routes</p><p class="screen2" id="1247727">&#x2D;&#x3E; vrf vrf&#x2D;A</p><p class="screen2" id="1247728">vrf&#x2D;A&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1247729">vrf A&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1247730"><br/></p><p class="screen2" id="1247731">&#x2D;&#x3E; vrf vrf&#x2D;B</p><p class="screen2" id="1247732">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1247733">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1247734">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;B isid 2&#x30;&#x30;&#x30; gateway 2&#x30;&#x30;.&#x30;.&#x30;.2 all&#x2D;routes</p><p class="screen2" id="1247735">&#x2D;&#x3E; vrf vrf&#x2D;B</p><p class="screen2" id="1247736">vrf&#x2D;B&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1247737">vrf B&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="heading3" id="1281446"><a id="XREF_51169__Front-Panel_Ports163" name="XREF_51169__Front-Panel_Ports163">IPv4 L3 VPN </a>Inline Routing&#x3A; Front&#x2D;Panel Ports</p><p class="text" id="1281507"><a id="163_text_1281507" name="163_text_1281507"></a>In this sample IP over SPB topology, routing between Customer Edge (CE) devices across the SPB backbone network is achieved through the L3 VPN interface configured on BEB&#x2D;A and BEB&#x2D;B. Because the <span data-keyref="Platforms Supported_OS6900-V72">OmniSwitch 6900-V72</span> is used in this example topology, the L3 VPN interfaces are defined by using front&#x2D;panel ports configured to operate in the loopback mode.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_213.svg" height="249.086629" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1280914">Figure 7&#x2D;19 &#x3A;  <a id="XREF_80001_%11L3_VPN_Front-Panel_Ports_(In-Line_Routi163" name="XREF_80001_%11L3_VPN_Front-Panel_Ports_(In-Line_Routi163">L3 VPN Front&#x2D;Panel Ports (Inline Routing)</a></p><p class="text" id="1283110"><a id="163_text_1283110" name="163_text_1283110"></a>In this topology, L3 VPN services provide routing between CE devices.</p><p class="bullet" id="1286680"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>CE devices are connected to BEB&#x2D;1 and BEB&#x2D;2 in IP subnet 2&#x30;.2&#x30;.2&#x30;.&#x30;&#47;24 and 3&#x30;.3&#x30;.3&#x30;.&#x30;&#47;24, respectively.</p><p class="bullet" id="1287104"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The CE devices can either be connected to bridge ports or access ports on the BEB switches. The CLI commands included in this sample topology provide examples for both scenarios (CE connected to bridge port; CE connected to access port). When a CE device is connected to an access port, the L3 VPN subnet can be extended to the device.</p><p class="bullet" id="1283102"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An L3 VPN interface is configured on BEB&#x2D;1 and BEB&#x2D;2 in IP subnet 1&#x30;.1&#x30;.1&#x30;.&#x30;&#47;24.</p><p class="bullet" id="1283131"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The L3 VPN interface on BEB&#x2D;1 is comprised of a front&#x2D;panel loopback port that is bound to an IP interface (1&#x30;.1&#x30;.1&#x30;.1) and VLAN 4&#x30;&#x30;. The same port is also configured as a service access port that is used to define a Service Access Point (SAP) binding with service 1&#x30;.</p><p class="bullet" id="1283515"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The L3 VPN interface on BEB&#x2D;2 is comprised of a loopback link aggregate to which multiple front&#x2D;panel loopback ports are assigned. The link aggregate is bound to an IP interface (1&#x30;.1&#x30;.1&#x30;.2) and VLAN 4&#x30;&#x30;. The same link aggregate is also configured as a service access link aggregate that is used to define a SAP binding with service 1&#x30;.</p><p class="bullet" id="1283979"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Once the L3 VPN interfaces are defined on each BEB, then either the VPN&#x2D;Lite or L3 VPN (ISIS&#x2D;SPB) method is configured to exchange routes across the SPB network. The CLI commands included in this sample topology provide examples of how to configure both methods.</p><p class="bullet_sub" id="1286669"><span class="bold">&#x2013;&#160;&#160;&#160; </span>VPN&#x2D;Lite requires routing protocols to be configured on all the IP interfaces. See <a  href="#XREF_80946__VPN-Lite163" style="color:#0000ff;background-color:transparent;">VPN-Lite</a>.</p><p class="bullet_sub" id="1286675"><span class="bold">&#x2013;&#160;&#160;&#160; </span>L3 VPN (ISIS&#x2D;SPB) requires binding the L3 VPN interface to an SPB I&#x2D;SID to exchange all routes in the associated VRF instance with other SPB bridges. See <a  href="#XREF_73812__L3_VPN_(SPB-ISIS)163" style="color:#0000ff;background-color:transparent;">L3 VPN (ISIS-SPB)</a>.</p><p class="text" id="1282731">The following CLI command examples are used to configure the sample IP over SPB topology shown in <a  href="#XREF_80001_%11L3_VPN_Front-Panel_Ports_(In-Line_Routi163" style="color:#0000ff;background-color:transparent;">L3 VPN Front-Panel Ports (Inline Routing)</a>.</p><p class="text" id="1282735">BEB&#x2D;1 (CE devices connected to bridge ports)&#x3A;</p><p class="screen" id="1284162">&#x2D;&#x3E; interface port 1&#47;1&#47;18 loopback</p><p class="screen2" id="1284322"><br/></p><p class="screen2" id="1282852">&#x2D;&#x3E; vlan 2&#x30;</p><p class="screen2" id="1282860">&#x2D;&#x3E; vlan 2&#x30; member port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1282881"><br/></p><p class="screen2" id="1282883">&#x2D;&#x3E; ip interface IPVPN address 1&#x30;.1&#x30;.1&#x30;.1&#47;24 rtr&#x2D;port port 1&#47;1&#47;18 tagged vlan 4&#x30;&#x30;</p><p class="screen2" id="1282895">&#x2D;&#x3E; ip interface IP&#x2D;CE address 2&#x30;.2&#x30;.2&#x30;.1&#47;24 vlan 2&#x30;</p><p class="screen2" id="1282916"><br/></p><p class="screen2" id="1282918">&#x2D;&#x3E; service access port 1&#47;1&#47;18 vlan&#x2D;xlation enable</p><p class="screen2" id="1282926">&#x2D;&#x3E; service spb 1&#x30; isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;&#x30; vlan&#x2D;xlation enable</p><p class="screen2" id="1282931">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;18&#x3A;4&#x30;&#x30;</p><p class="text" id="1287912">BEB&#x2D;1 (CE devices connected to access ports)&#x3A;</p><p class="screen" id="1287913">&#x2D;&#x3E; interface port 1&#47;1&#47;18 loopback</p><p class="screen2" id="1287914"><br/></p><p class="screen2" id="1287915">&#x2D;&#x3E; ip interface IPVPN address 1&#x30;.1&#x30;.1&#x30;.1&#47;24 rtr&#x2D;port port 1&#47;1&#47;18 tagged vlan 4&#x30;&#x30;</p><p class="screen2" id="1287916"><br/></p><p class="screen2" id="1287917">&#x2D;&#x3E; service access port 1&#47;1&#47;18 vlan&#x2D;xlation enable</p><p class="screen2" id="1287918">&#x2D;&#x3E; service spb 1&#x30; isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;&#x30; vlan&#x2D;xlation enable</p><p class="screen2" id="1287919">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;18&#x3A;4&#x30;&#x30;</p><p class="screen2" id="1287920">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;1&#x3A;4&#x30;&#x30;</p><p class="text" id="1284461">BEB&#x2D;2 (CE devices connected to bridge ports)&#x3A; </p><p class="screen" id="1284432">&#x2D;&#x3E; interface port 1&#47;1&#47;18 loopback</p><p class="screen2" id="1284433">&#x2D;&#x3E; interface port 2&#47;1&#47;18 loopback</p><p class="screen2" id="1284435">&#x2D;&#x3E; linkagg static agg 1 size 4 loopback</p><p class="screen2" id="1284436">&#x2D;&#x3E; linkagg static port 1&#47;1&#47;18 agg 1</p><p class="screen2" id="1284437">&#x2D;&#x3E; linkagg static port 2&#47;1&#47;18 agg 1</p><p class="screen2" id="1284507"><br/></p><p class="screen2" id="1284509">&#x2D;&#x3E; vlan 3&#x30;</p><p class="screen2" id="1284517">&#x2D;&#x3E; vlan 3&#x30; member port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1284529"><br/></p><p class="screen2" id="1284531">&#x2D;&#x3E; ip interface IPVPN address 1&#x30;.1&#x30;.1&#x30;.2&#47;24 rtr&#x2D;port linkagg 1 tagged vlan 4&#x30;&#x30;</p><p class="screen2" id="1284539">&#x2D;&#x3E; ip interface IP&#x2D;CE address 3&#x30;.3&#x30;.3&#x30;.2&#47;24 vlan 3&#x30;</p><p class="screen2" id="1284550"><br/></p><p class="screen2" id="1284552">&#x2D;&#x3E; service access linkagg 1 vlan&#x2D;xlation enable</p><p class="screen2" id="1284560">&#x2D;&#x3E; service spb 1&#x30; isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;&#x30; vlan&#x2D;xlation enable</p><p class="screen2" id="1284568">&#x2D;&#x3E; service 1&#x30; sap linkagg 1&#x3A;4&#x30;&#x30;</p><p class="text" id="1286872">BEB&#x2D;2 (CE devices connected to access ports)&#x3A; </p><p class="screen" id="1286873">&#x2D;&#x3E; interface port 1&#47;1&#47;18 loopback</p><p class="screen2" id="1286874">&#x2D;&#x3E; interface port 2&#47;1&#47;18 loopback</p><p class="screen2" id="1286875">&#x2D;&#x3E; linkagg static agg 1 size 4 loopback</p><p class="screen2" id="1286876">&#x2D;&#x3E; linkagg static port 1&#47;1&#47;18 agg 1</p><p class="screen2" id="1286877">&#x2D;&#x3E; linkagg static port 2&#47;1&#47;18 agg 1</p><p class="screen2" id="1286878"><br/></p><p class="screen2" id="1286882">&#x2D;&#x3E; ip interface IPVPN address 1&#x30;.1&#x30;.1&#x30;.2&#47;24 rtr&#x2D;port linkagg 1 tagged vlan 4&#x30;&#x30; </p><p class="screen2" id="1286884"><br/></p><p class="screen2" id="1286885">&#x2D;&#x3E; service access linkagg 1 vlan&#x2D;xlation enable</p><p class="screen2" id="1286886">&#x2D;&#x3E; service spb 1&#x30; isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;&#x30; vlan&#x2D;xlation enable</p><p class="screen2" id="1286887">&#x2D;&#x3E; service 1&#x30; sap linkagg 1&#x3A;4&#x30;&#x30;</p><p class="screen2" id="1286856">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;1&#x3A;4&#x30;&#x30;</p><p class="heading5" id="1284052" style="margin-left : 18.00pt;margin-top : 11.00pt;margin-bottom : 7.00pt;text-indent : 0.00pt;font-size : 10.50pt;font-kerning:none;"><span class="Times_Bold" style="background-color:transparent;"><a id="XREF_80946__VPN-Lite163" name="XREF_80946__VPN-Lite163" style="background-color:transparent;">VPN&#x2D;Lite</a></span></p><p class="text" id="1284053"><a id="163_text_1284053" name="163_text_1284053"></a>The VPN&#x2D;Lite approach requires configuring routing protocols to run on all the interfaces or defining static routes with a remote interface as a gateway. The following commands provide examples of configuring either OSPF or static routes for a VPN&#x2D;Lite configuration.</p><p class="text" id="1284054">BEB&#x2D;1 (OSPF&#x2014;the interface name specified is the name of the L3 VPN interface and the CE interface)&#x3A;</p><p class="screen" id="1284343">&#x2D;&#x3E; ip load ospf</p><p class="screen2" id="1284344">&#x2D;&#x3E; ip ospf area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1284345">&#x2D;&#x3E; ip ospf interface &quot;IPVPN&quot;</p><p class="screen2" id="1284346">&#x2D;&#x3E; ip ospf interface &quot;IPVPN&quot; area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1284347">&#x2D;&#x3E; ip ospf interface &quot;IPVPN&quot; admin&#x2D;state enable</p><p class="screen2" id="1284348">&#x2D;&#x3E; ip ospf interface &quot;IP&#x2D;CE&quot;</p><p class="screen2" id="1284349">&#x2D;&#x3E; ip ospf interface &quot;IP&#x2D;CE&quot; area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1284350">&#x2D;&#x3E; ip ospf interface &quot;IP&#x2D;CE&quot; admin&#x2D;state enable</p><p class="screen2" id="1284055">&#x2D;&#x3E; ip ospf admin&#x2D;state enable</p><p class="text" id="1284068">BEB&#x2D;1 (Static Routes&#x2014;the gateway IP address specified is the IP address of the L3 VPN interface)&#x3A;</p><p class="screen" id="1284069">&#x2D;&#x3E; ip static&#x2D;route 2&#x30;.2&#x30;.2&#x30;.&#x30;&#47;24 gateway 1&#x30;.1&#x30;.1&#x30;.1</p><p class="text" id="1284071">BEB&#x2D;2 (OSPF&#x2014;the interface name specified is the name of the L3 VPN interface and the CE interface)&#x3A;</p><p class="screen" id="1285715">&#x2D;&#x3E; ip load ospf</p><p class="screen2" id="1285716">&#x2D;&#x3E; ip ospf area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1285717">&#x2D;&#x3E; ip ospf interface &quot;IPVPN&quot;</p><p class="screen2" id="1285718">&#x2D;&#x3E; ip ospf interface &quot;IPVPN&quot; area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1285719">&#x2D;&#x3E; ip ospf interface &quot;IPVPN&quot; admin&#x2D;state enable</p><p class="screen2" id="1285720">&#x2D;&#x3E; ip ospf interface &quot;IP&#x2D;CE&quot;</p><p class="screen2" id="1285721">&#x2D;&#x3E; ip ospf interface &quot;IP&#x2D;CE&quot; area &#x30;.&#x30;.&#x30;.&#x30;</p><p class="screen2" id="1285722">&#x2D;&#x3E; ip ospf interface &quot;IP&#x2D;CE&quot; admin&#x2D;state enable</p><p class="screen2" id="1285723">&#x2D;&#x3E; ip ospf admin&#x2D;state enable</p><p class="text" id="1284085">BEB&#x2D;2 (Static Routes&#x2014;the gateway IP address specified is the IP address of the IPv4 L3 VPN service&#x2D;based interface)&#x3A;</p><p class="screen" id="1284086">&#x2D;&#x3E; ip static&#x2D;route 3&#x30;.3&#x30;.3&#x30;.&#x30;&#47;24 gateway 1&#x30;.1&#x30;.1&#x30;.2</p><p class="heading5" id="1286035" style="margin-left : 18.00pt;margin-top : 11.00pt;margin-bottom : 7.00pt;text-indent : 0.00pt;font-size : 10.50pt;font-kerning:none;"><span class="Times_Bold" style="background-color:transparent;"><a id="XREF_73812__L3_VPN_(SPB-ISIS)163" name="XREF_73812__L3_VPN_(SPB-ISIS)163" style="background-color:transparent;">L3 VPN (</a></span><span class="Times_Bold" style="background-color:transparent;">ISIS&#x2D;SPB</span><span class="Times_Bold" style="background-color:transparent;">)</span></p><p class="text" id="1286036"><a id="163_text_1286036" name="163_text_1286036"></a>The L3 VPN (ISIS&#x2D;SPB) approach exchanges L3 routes between VRFs. Instead of configuring routing protocols on the L3 VPN interface (VPN&#x2D;Lite), VRFs are bound to backbone I&#x2D;SIDs to connect VRFs across the SPBM network. IP routes are then imported into ISIS&#x2D;SPB from the VRFs where IPVPN TLVs are used to carry the routes through the network to other SPBM BEB switches.</p><p class="text" id="1286037">The following commands are used only when configuring an L3 VPN (ISIS&#x2D;SPB) configuration (the gateway IP address specified is the IP address of the L3 VPN interface).</p><p class="text" id="1286038">BEB&#x2D;1&#x3A;</p><p class="screen" id="1286536">&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1286588">&#x2D;&#x3E; spb ipvpn bind vrf default isid 1&#x30;&#x30;&#x30; gateway 1&#x30;.1&#x30;.1&#x30;.1 all&#x2D;routes</p><p class="screen2" id="1286537">&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1286053">BEB&#x2D;2&#x3A;</p><p class="screen" id="1286609">&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1286628">&#x2D;&#x3E; spb ipvpn bind vrf default isid 1&#x30;&#x30;&#x30; gateway 1&#x30;.1&#x30;.1&#x30;.2 all&#x2D;routes</p><p class="screen2" id="1286630">&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="heading3" id="1247931"><a id="XREF_24341__Multiple_I-SIDs163" name="XREF_24341__Multiple_I-SIDs163">IPv4 L3 VPN </a>External Loopback and Inline Routing&#x3A; Two I&#x2D;SIDs, One VRF</p><p class="text" id="1247932"><a id="163_text_1247932" name="163_text_1247932"></a>In this sample IPv4 over SPB topology, Network A can communicate with Network B across two I&#x2D;SIDs. This scenario could be expanded to connect multiple customer sites together to form a VPN cloud.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_219.svg" height="399.778381" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="528.609192"></object></p><p class="FigureTitle" id="1244482">Figure 7&#x2D;2&#x30; &#x3A;  <a id="XREF_17735_%11L3%11ECMP/VPN%11Cloud%11Example163" name="XREF_17735_%11L3%11ECMP_VPN%11Cloud%11Example163">IPv4 L3 VPN External Loopback and Service&#x2D;based Interfaces</a></p><p class="text" id="1138071"><a id="163_text_1138071" name="163_text_1138071"></a>In this topology, </p><p class="bullet" id="1223443"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical loopback port configuration is required on BEB&#x2D;A (OS69&#x30;&#x30;). Port 1&#47;1&#47;1 is the L3 VPN router port, port 1&#47;1&#47;2 is the L3 VPN access port, and VLAN 2&#x30;&#x30; and VLAN 4&#x30;&#x30; are the L3 VPN VLANs.</p><p class="bullet_sub" id="1244547"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Port 1&#47;1&#47;1 is tagged with VLANs 2&#x30;&#x30; and 4&#x30;&#x30;.</p><p class="bullet_sub" id="1254893"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Access port 1&#47;1&#47;2 is assigned to SAPs that are each associated with an I&#x2D;SID (an SPB service instance) that will forward VLAN 2&#x30;&#x30; and 4&#x30;&#x30; traffic through the SPB backbone network.</p><p class="bullet_sub" id="1254894"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A physical cable is connected to port 1&#47;1&#47;1 and to port 1&#47;1&#47;2 to create the connection between the VLAN and service domains.</p><p class="bullet_sub" id="1224142"><span class="bold">&#x2013;&#160;&#160;&#160; </span>An IPv4 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1.1.1.1&#47;24) and VLAN 4&#x30;&#x30; (2.2.2.1&#47;24).</p><p class="bullet" id="1226005"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical loopback port configuration is not used on BEB&#x2D;B (OS99&#x30;&#x30;). Instead, an IPv4&#160;L3 VPN interface is configured on service 1&#x30;&#x30;&#x30; (1.1.1.2&#47;24) and service 2&#x30;&#x30;&#x30; (2.2.2.2&#47;24).</p><p class="bullet" id="1226007"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>On BEB&#x2D;A and BEB&#x2D;B, the VPN&#x2D;Lite or L3 VPN solution is configured.</p><p class="text" id="1255488">The following CLI command examples are used to configure the sample IPv4 over SPB topology shown in <a  href="#XREF_17735_%11L3%11ECMP/VPN%11Cloud%11Example163" style="color:#0000ff;background-color:transparent;">IPv4 L3 VPN External Loopback and Service-based Interfaces</a>. </p><p class="text" id="1255492">BEB&#x2D;A&#x3A;</p><p class="screen" id="1255493">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1225813">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1225814">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1225815">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1242642">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1242643">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1242644">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1242645">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1242646">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1242588">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1137923">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn1 vlan 2&#x30;&#x30; address 1.1.1.1&#47;24</p><p class="screen2" id="1137924">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn2 vlan 4&#x30;&#x30; address 2.2.2.1&#47;24</p><p class="text" id="1137926">BEB&#x2D;B (OS99&#x30;&#x30;)&#x3A;</p><p class="screen" id="1254903">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable</p><p class="screen2" id="1254923">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable</p><p class="screen2" id="1254916">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1137927">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn1 service 1&#x30;&#x30;&#x30; address 1.1.1.2&#47;24</p><p class="screen2" id="1137928">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn2 service 2&#x30;&#x30;&#x30; address 2.2.2.2&#47;24</p><p class="text" id="1137929" style="font-weight:Bold;"><span class="Times_Bold" style="font-size : 11.00pt;text-decoration: underline;background-color:transparent;">VPN&#x2D;Lite</span><span class="Times_Bold" style="background-color:transparent;">&#160;</span></p><p class="text" id="1254317">The VPN&#x2D;Lite approach requires configuring routing protocols to run on the L3 VPN interface or defining static routes with a remote L3 VPN interface as a gateway. The following commands provide examples of configuring static routes for a VPN&#x2D;Lite configuration.</p><p class="text" id="1138078">BEB&#x2D;A&#x3A;</p><p class="screen" id="1137931">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 2&#x30;.&#x30;.&#x30;.&#x30;&#47;24 gateway 1.1.1.2</p><p class="screen2" id="1137932">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 2&#x30;.&#x30;.&#x30;.&#x30;&#47;24 gateway 2.2.2.2</p><p class="text" id="1137934">BEB&#x2D;B (OS99&#x30;&#x30;)&#x3A;</p><p class="screen" id="1137935">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 1&#x30;.&#x30;.&#x30;.&#x30;&#47;24 gateway 1.1.1.1</p><p class="screen2" id="1137936">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip static&#x2D;route 1&#x30;.&#x30;.&#x30;.&#x30;&#47;24 gateway 2.2.2.1</p><p class="text" id="1137937" style="margin-top : 8.00pt;line-height : 12.00pt;font-weight:Bold;font-size : 11.00pt;text-decoration: underline;"><span class="Times_Bold" style="font-size : 11.00pt;text-decoration: underline;background-color:transparent;">L3 VPN</span></p><p class="text" id="1254338">The L3 VPN (ISIS&#x2D;SPB) approach exchanges L3 routes between VRFs. Instead of configuring routing protocols on the L3 VPN interface (VPN&#x2D;Lite), VRFs are bound to backbone I&#x2D;SIDs to connect VRFs across the SPBM network. IP routes are then imported into ISIS&#x2D;SPB from the VRFs where IPVPN TLVs are used to carry the routes through the network to other SPBM BEB switches.</p><p class="text" id="1254339">The following commands are used only when configuring an L3 VPN (ISIS&#x2D;SPB) configuration (the gateway IP address specified is the IP address of the IPv4 L3 VPN interface).</p><p class="text" id="1137938">BEB&#x2D;A&#x3A;</p><p class="screen" id="1137939">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1224663">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1137940">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1.1.1.1 all&#x2D;routes</p><p class="screen2" id="1137941">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2.2.2.1 all&#x2D;routes</p><p class="screen2" id="1224688">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1137942">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1137943">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1137945">BEB&#x2D;B (OS99&#x30;&#x30;)&#x3A;</p><p class="screen" id="1137946">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1224712">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1137947">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1.1.1.2 all&#x2D;routes</p><p class="screen2" id="1137948">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2.2.2.2 all&#x2D;routes</p><p class="screen2" id="1224724">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1137949">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1137950">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="heading3" id="1255384"><a id="XREF_45588__I-SID_Routing_in_One_VRF163" name="XREF_45588__I-SID_Routing_in_One_VRF163">IPv4</a> L3 VPN External Loopback Interfaces&#x3A; I&#x2D;SID Routing in One VRF</p><p class="text" id="1255385"><a id="163_text_1255385" name="163_text_1255385"></a>In this sample IPv4 over SPB configuration, Networks A and B can communicate with each other within the same VRF but on different I&#x2D;SIDs due to the routing (redistribution) between I&#x2D;SID 1&#x30;&#x30;&#x30; and 2&#x30;&#x30;&#x30; on BEB&#x2D;C. In addition, Network C is also able to communicate with Networks A and B.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_224.svg" height="393.745219" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="476.942240"></object></p><p class="FigureTitle" id="1138301">Figure 7&#x2D;21 &#x3A;  <a id="XREF_94545_%11Inter-ISID%11Routing%11Example163" name="XREF_94545_%11Inter-ISID%11Routing%11Example163">IPv4 Inter&#x2D;ISID Routing Example (One VRF)</a></p><p class="text" id="1138306"><a id="163_text_1138306" name="163_text_1138306"></a>In this topology, </p><p class="bullet" id="1254402"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Network A binds to I&#x2D;SID 1&#x30;&#x30;&#x30; in VRF&#x2D;1, Network B binds to I&#x2D;SID 2&#x30;&#x30;&#x30; in VRF&#x2D;1, and Network C binds to both I&#x2D;SIDs in VRF&#x2D;1. </p><p class="bullet" id="1254717"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical loopback port configuration is required on BEB&#x2D;A, BEB&#x2D;B, and BEB&#x2D;C. Port 1&#47;1&#47;1 is the L3 VPN router port, port 1&#47;1&#47;2 is the L3 VPN access port, and VLAN 2&#x30;&#x30; and VLAN 4&#x30;&#x30; are the L3 VPN VLANs.</p><p class="bullet_sub" id="1254718"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Port 1&#47;1&#47;1 is tagged with VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C).</p><p class="bullet_sub" id="1254719"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Access port 1&#47;1&#47;2 is assigned to SAPs that are each associated with an I&#x2D;SID (an SPB service instance) that will forward VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C) traffic through the SPB backbone network.</p><p class="bullet_sub" id="1254413"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A physical cable is connected to port 1&#47;1&#47;1 and to port 1&#47;1&#47;2 on each switch to create the connection between the VLAN and service domains.</p><p class="bullet_sub" id="1254414"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;A, an IPv4 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1.1.1.1&#47;24).</p><p class="bullet_sub" id="1254474"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;B, an IPv4 L3 VPN interface is configured on VLAN 4&#x30;&#x30; (2.2.2.1&#47;24).</p><p class="bullet_sub" id="1254534"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;C, an IPv4 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1.1.1.2&#47;24) and on VLAN 4&#x30;&#x30; (2.2.2.2&#47;24).</p><p class="text" id="1254399">The following CLI command examples are used to configure the sample IPv4 over SPB topology shown in <a  href="#XREF_94545_%11Inter-ISID%11Routing%11Example163" style="color:#0000ff;background-color:transparent;">IPv4 Inter-ISID&#160;Routing&#160;Example&#160;(One&#160;VRF)</a>.</p><p class="text" id="1138350">BEB&#x2D;A&#x3A;</p><p class="screen" id="1138504">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1138505">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1244809">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1138508">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138509">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138819">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1138536">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn1 vlan 2&#x30;&#x30; address 1.1.1.1&#47;24</p><p class="screen2" id="1138818">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1241380">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1138569">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1.1.1.1 all&#x2D;routes</p><p class="screen2" id="1138571">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1241417">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1241440">BEB&#x2D;B</p><p class="screen" id="1241442">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1138523">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1244868">&#x2D;&#x3E; service access port 1&#47;1&#47;2</p><p class="screen2" id="1138526">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1138527">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1241448">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1138543">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn2 vlan 4&#x30;&#x30; address 2.2.2.1&#47;24</p><p class="screen2" id="1138817">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1241484">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1138814">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2.2.2.1 all&#x2D;routes</p><p class="screen2" id="1138590">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1241504">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1138516">BEB&#x2D;C&#x3A;</p><p class="screen" id="1138352">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1138353">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1138354">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1138355">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1244905">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1138356">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138357">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138358">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1138359">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1241530">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1138554">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn1 vlan 2&#x30;&#x30; address 1.1.1.2&#47;24   </p><p class="screen2" id="1138805">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn2 vlan 4&#x30;&#x30; address 2.2.2.2&#47;24</p><p class="screen2" id="1241570">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1138812">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1.1.1.2 all&#x2D;routes</p><p class="screen2" id="1138606">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2.2.2.2 all&#x2D;routes</p><p class="screen2" id="1138559">&#x2D;&#x3E; spb ipvpn redist source&#x2D;isid 1&#x30;&#x30;&#x30; destination&#x2D;isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1138560">&#x2D;&#x3E; spb ipvpn redist source&#x2D;isid 2&#x30;&#x30;&#x30; destination&#x2D;isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1241582">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1138561">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import all&#x2D;routes</p><p class="screen2" id="1138562">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="heading3" id="1255538"><a id="XREF_25642__I-SID_Routing_in163" name="XREF_25642__I-SID_Routing_in163">IPv6 L3 VPN </a>External Loopback Interfaces&#x3A; I&#x2D;SID Routing in One VRF</p><p class="text" id="1255539"><a id="163_text_1255539" name="163_text_1255539"></a>In this sample IPv6 over SPB configuration, Networks A and B can communicate with each other within the same VRF but on different I&#x2D;SIDs due to the routing (redistribution) between I&#x2D;SID 1&#x30;&#x30;&#x30; and 2&#x30;&#x30;&#x30; on BEB&#x2D;C. In addition, Network C is also able to communicate with Networks A and B.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_231.svg" height="393.745219" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="476.942240"></object></p><p class="FigureTitle" id="1255598">Figure 7&#x2D;22 &#x3A;  IPv6 Inter&#x2D;ISID Routing Example (One VRF)</p><p class="text" id="1255599">In this topology, </p><p class="bullet" id="1255600"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Network A binds to I&#x2D;SID 1&#x30;&#x30;&#x30; in VRF&#x2D;1, Network B binds to I&#x2D;SID 2&#x30;&#x30;&#x30; in VRF&#x2D;1, and Network C binds to both I&#x2D;SIDs in VRF&#x2D;1. </p><p class="bullet" id="1255601"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical loopback port configuration is required on BEB&#x2D;A, BEB&#x2D;B, and BEB&#x2D;C. Port 1&#47;1&#47;1 is the L3 VPN router port, port 1&#47;1&#47;2 is the L3 VPN access port, and VLAN 2&#x30;&#x30; and VLAN 4&#x30;&#x30; are the L3 VPN VLANs.</p><p class="bullet_sub" id="1255602"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Port 1&#47;1&#47;1 is tagged with VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C).</p><p class="bullet_sub" id="1255603"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Access port 1&#47;1&#47;2 is assigned to SAPs that are each associated with an I&#x2D;SID (an SPB service instance) that will forward VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C) traffic through the SPB backbone network.</p><p class="bullet_sub" id="1255604"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A physical cable is connected to port 1&#47;1&#47;1 and to port 1&#47;1&#47;2 on each switch to create the connection between the VLAN and service domains.</p><p class="bullet_sub" id="1255605"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;A, an IPv6 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16).</p><p class="bullet_sub" id="1255606"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;B, an IPv6 L3 VPN interface is configured on VLAN 4&#x30;&#x30; (2&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16).</p><p class="bullet_sub" id="1255755"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;C, an IPv6 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16) and on VLAN 4&#x30;&#x30; (2&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16).</p><p class="text" id="1255756">The following CLI command examples are used to configure the sample IPv6 over SPB topology shown in <a  href="#XREF_94545_%11Inter-ISID%11Routing%11Example163" style="color:#0000ff;background-color:transparent;">IPv4 Inter-ISID&#160;Routing&#160;Example&#160;(One&#160;VRF)</a>.</p><p class="text" id="1255612">BEB&#x2D;A&#x3A;</p><p class="screen" id="1255613">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1255614">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1255615">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1255616">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1255617">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1255618">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1255619">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn1 vlan 2&#x30;&#x30; address 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16</p><p class="screen2" id="1255620">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export all&#x2D;routes</p><p class="screen2" id="1255621">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1255622">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1 all&#x2D;routes</p><p class="screen2" id="1255623">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1255624">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1255625">BEB&#x2D;B</p><p class="screen" id="1255626">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1255627">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1255628">&#x2D;&#x3E; service access port 1&#47;1&#47;2</p><p class="screen2" id="1255629">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1255630">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1255631">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1255632">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn2 vlan 4&#x30;&#x30; address 2&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16</p><p class="screen2" id="1255633">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export all&#x2D;routes</p><p class="screen2" id="1255634">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1255635">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2&#x30;&#x30;&#x30;&#x3A;&#x3A;1 all&#x2D;routes</p><p class="screen2" id="1255636">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1255637">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1255638">BEB&#x2D;C&#x3A;</p><p class="screen" id="1255639">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1255640">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1255641">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1255642">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1255643">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1255644">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1255645">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1255646">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1255647">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1255648">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1255649">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn1 vlan 2&#x30;&#x30; address 1&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16 </p><p class="screen2" id="1255650">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn2 vlan 4&#x30;&#x30; address 2&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16</p><p class="screen2" id="1255651">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1256296">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1&#x30;&#x30;&#x30;&#x3A;&#x3A;2 all&#x2D;routes</p><p class="screen2" id="1256297">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2&#x30;&#x30;&#x30;&#x3A;&#x3A;2 all&#x2D;routes</p><p class="screen2" id="1256298">&#x2D;&#x3E; spb ipvpn6 redist source&#x2D;isid 1&#x30;&#x30;&#x30; destination&#x2D;isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1255655">&#x2D;&#x3E; spb ipvpn6 redist source&#x2D;isid 2&#x30;&#x30;&#x30; destination&#x2D;isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1255656">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1256612">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import all&#x2D;routes</p><p class="screen2" id="1256613">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export all&#x2D;routes</p><p class="heading3" id="1256615"><a id="XREF_26654__I-SID_Routing_in_Two_VRFs163" name="XREF_26654__I-SID_Routing_in_Two_VRFs163">IPv4 L3 VPN </a>External Loopback Interfaces&#x3A; I&#x2D;SID Routing in Two VRFs</p><p class="text" id="1138633"><a id="163_text_1138633" name="163_text_1138633"></a>In this sample IPv4 over SPB configuration, Networks A and B can communicate with each other between two different VRFs on different I&#x2D;SIDs due to the routing (redistribution) between I&#x2D;SID 1&#x30;&#x30;&#x30; and 2&#x30;&#x30;&#x30; on BEB&#x2D;C. In addition, Network C is also able to communicate with Networks A and B.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_238.svg" height="397.578512" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="476.942240"></object></p><p class="FigureTitle" id="1138689">Figure 7&#x2D;23 &#x3A;  <a id="XREF_37872_%11Inter-ISID%11Routing%11Example%11(Two%11VRF)163" name="XREF_37872_%11Inter-ISID%11Routing%11Example%11(Two%11VRF)163">IPv4 Inter&#x2D;ISID Routing Example (Two VRFs)</a></p><p class="text" id="1138690"><a id="163_text_1138690" name="163_text_1138690"></a>In this topology, </p><p class="bullet" id="1254775"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Network A binds to I&#x2D;SID 1&#x30;&#x30;&#x30; in VRF&#x2D;1, Network B binds to I&#x2D;SID 2&#x30;&#x30;&#x30; in VRF&#x2D;2, and Network C binds to both I&#x2D;SIDs in VRF&#x2D;1. </p><p class="bullet" id="1254792"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical loopback port configuration is required on BEB&#x2D;A, BEB&#x2D;B, and BEB&#x2D;C. Port 1&#47;1&#47;1 is the L3 VPN router port, port 1&#47;1&#47;2 is the L3 VPN access port, and VLAN 2&#x30;&#x30; and VLAN 4&#x30;&#x30; are the L3 VPN VLANs.</p><p class="bullet_sub" id="1254793"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Port 1&#47;1&#47;1 is tagged with VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C).</p><p class="bullet_sub" id="1254794"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Access port 1&#47;1&#47;2 is assigned to SAPs that are each associated with an I&#x2D;SID (an SPB service instance) that will forward VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C) traffic through the SPB backbone network.</p><p class="bullet_sub" id="1254795"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A physical cable is connected to port 1&#47;1&#47;1 and to port 1&#47;1&#47;2 to create the connection between the VLAN and service domains.</p><p class="bullet_sub" id="1254796"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;A, an IPv4 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1.1.1.1&#47;24).</p><p class="bullet_sub" id="1254797"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;B, an IPv4 L3 VPN interface is configured on VLAN 4&#x30;&#x30; (2.2.2.1&#47;24).</p><p class="bullet_sub" id="1254798"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;C, an IPv4 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1.1.1.2&#47;24) and on VLAN 4&#x30;&#x30; (2.2.2.2&#47;24).</p><p class="text" id="1254783">The following CLI command examples are used to configure the sample IPv4 over SPB topology shown in <a  href="#XREF_37872_%11Inter-ISID%11Routing%11Example%11(Two%11VRF)163" style="color:#0000ff;background-color:transparent;">IPv4 Inter-ISID&#160;Routing&#160;Example&#160;(Two&#160;VRFs)</a>.</p><p class="text" id="1138694">BEB&#x2D;A</p><p class="screen" id="1138696">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1138697">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1244976">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1138698">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138699">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138700">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1138701">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn1 vlan 2&#x30;&#x30; address 1.1.1.1&#47;24 </p><p class="screen2" id="1138702">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1241667">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1138703">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1.1.1.1 all&#x2D;routes</p><p class="screen2" id="1138704">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1241699">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1138705">BEB&#x2D;B</p><p class="screen" id="1138707">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1138708">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1245003">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1138709">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1138710">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1241719">&#x2D;&#x3E; vrf create vrf&#x2D;2</p><p class="screen2" id="1138712">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn2 vlan 4&#x30;&#x30; address 2.2.2.1&#47;24</p><p class="screen2" id="1138713">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1241748">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1138714">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2.2.2.1 all&#x2D;routes</p><p class="screen2" id="1138715">&#x2D;&#x3E; vrf vrf&#x2D;2</p><p class="screen2" id="1241782">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1138716">BEB&#x2D;C</p><p class="screen" id="1138718">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1138719">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1138720">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1138721">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1245031">&#x2D;&#x3E; service access port 1&#47;1&#47;2</p><p class="screen2" id="1138722">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138723">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1138724">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1242019">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1242020">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1242021">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn1 vlan 2&#x30;&#x30; address 1.1.1.2&#47;24</p><p class="screen2" id="1242046">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf create vrf&#x2D;2</p><p class="screen2" id="1242006">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ip interface l3vpn2 vlan 4&#x30;&#x30; address 2.2.2.2&#47;24</p><p class="screen2" id="1242090">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1241996">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1.1.1.2 all&#x2D;routes</p><p class="screen2" id="1138731">&#x2D;&#x3E; spb ipvpn bind vrf&#x2D;2 isid 2&#x30;&#x30;&#x30; gateway 2.2.2.2 all&#x2D;routes</p><p class="screen2" id="1138788">&#x2D;&#x3E; spb ipvpn redist source&#x2D;isid 1&#x30;&#x30;&#x30; destination&#x2D;isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1138789">&#x2D;&#x3E; spb ipvpn redist source&#x2D;isid 2&#x30;&#x30;&#x30; destination&#x2D;isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1242116">&#x2D;&#x3E; spb ipvpn redist source&#x2D;vrf vrf&#x2D;1 destination&#x2D;isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1242117">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1242118">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1241966">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1241946">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ip export all&#x2D;routes</p><p class="screen2" id="1241941">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf vrf&#x2D;2</p><p class="screen2" id="1242195">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ip import vrf&#x2D;1 all&#x2D;routes</p><p class="screen2" id="1138795">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1138796">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ip import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="heading3" id="1255914"><a id="XREF_59495__I-SID_Routing_in163" name="XREF_59495__I-SID_Routing_in163">IPv6 L3 VPN </a>External Loopback Interfaces&#x3A; I&#x2D;SID Routing in Two VRFs</p><p class="text" id="1255915"><a id="163_text_1255915" name="163_text_1255915"></a>In this sample IPv6 over SPB configuration, Networks A and B can communicate with each other between two different VRFs on different I&#x2D;SIDs due to the routing (redistribution) between I&#x2D;SID 1&#x30;&#x30;&#x30; and 2&#x30;&#x30;&#x30; on BEB&#x2D;C. In addition, Network C is also able to communicate with Networks A and B.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_245.svg" height="397.578512" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="476.942240"></object></p><p class="FigureTitle" id="1255975">Figure 7&#x2D;24 &#x3A;  IPv6 Inter&#x2D;ISID Routing Example (Two VRFs)</p><p class="text" id="1255976">In this topology, </p><p class="bullet" id="1255977"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Network A binds to I&#x2D;SID 1&#x30;&#x30;&#x30; in VRF&#x2D;1, Network B binds to I&#x2D;SID 2&#x30;&#x30;&#x30; in VRF&#x2D;2, and Network C binds to both I&#x2D;SIDs in VRF&#x2D;1. </p><p class="bullet" id="1255978"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical loopback port configuration is required on BEB&#x2D;A, BEB&#x2D;B, and BEB&#x2D;C. Port 1&#47;1&#47;1 is the L3 VPN router port, port 1&#47;1&#47;2 is the L3 VPN access port, and VLAN 2&#x30;&#x30; and VLAN 4&#x30;&#x30; are the L3 VPN VLANs.</p><p class="bullet_sub" id="1255979"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Port 1&#47;1&#47;1 is tagged with VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C).</p><p class="bullet_sub" id="1255980"><span class="bold">&#x2013;&#160;&#160;&#160; </span>Access port 1&#47;1&#47;2 is assigned to SAPs that are each associated with an I&#x2D;SID (an SPB service instance) that will forward VLAN 2&#x30;&#x30; (BEB&#x2D;A and BEB&#x2D;C) and VLAN 4&#x30;&#x30; (BEB&#x2D;B and BEB&#x2D;C) traffic through the SPB backbone network.</p><p class="bullet_sub" id="1255981"><span class="bold">&#x2013;&#160;&#160;&#160; </span>A physical cable is connected to port 1&#47;1&#47;1 and to port 1&#47;1&#47;2 to create the connection between the VLAN and service domains.</p><p class="bullet_sub" id="1255982"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;A, an IPv6 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16).</p><p class="bullet_sub" id="1255983"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;B, an IPv6 L3 VPN interface is configured on VLAN 4&#x30;&#x30; (2&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16).</p><p class="bullet_sub" id="1255984"><span class="bold">&#x2013;&#160;&#160;&#160; </span>On BEB&#x2D;C, an IPv6 L3 VPN interface is configured on VLAN 2&#x30;&#x30; (1&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16) and on VLAN 4&#x30;&#x30; (2&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16).</p><p class="text" id="1255985">The following CLI command examples are used to configure the sample IPv4 over SPB topology shown in <a  href="#XREF_37872_%11Inter-ISID%11Routing%11Example%11(Two%11VRF)163" style="color:#0000ff;background-color:transparent;">IPv4 Inter-ISID&#160;Routing&#160;Example&#160;(Two&#160;VRFs)</a>.</p><p class="text" id="1255989">BEB&#x2D;A</p><p class="screen" id="1255990">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1255991">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1255992">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1255993">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1255994">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1255995">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1255996">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn1 vlan 2&#x30;&#x30; address 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16</p><p class="screen2" id="1255997">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export all&#x2D;routes</p><p class="screen2" id="1255998">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1255999">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1&#x30;&#x30;&#x30;&#x3A;&#x3A;1 all&#x2D;routes</p><p class="screen2" id="1256000">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1256001">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1256002">BEB&#x2D;B</p><p class="screen" id="1256003">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1256004">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged </p><p class="screen2" id="1256005">&#x2D;&#x3E; service access port 1&#47;1&#47;2 </p><p class="screen2" id="1256006">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1256007">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1256008">&#x2D;&#x3E; vrf create vrf&#x2D;2</p><p class="screen2" id="1256009">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn2 vlan 4&#x30;&#x30; address 2&#x30;&#x30;&#x30;&#x3A;&#x3A;1&#47;16</p><p class="screen2" id="1256010">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export all&#x2D;routes</p><p class="screen2" id="1256011">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1256012">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 2&#x30;&#x30;&#x30; gateway 2&#x30;&#x30;&#x30;&#x3A;&#x3A;1 all&#x2D;routes</p><p class="screen2" id="1256013">&#x2D;&#x3E; vrf vrf&#x2D;2</p><p class="screen2" id="1256014">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="text" id="1256015">BEB&#x2D;C</p><p class="screen" id="1256016">&#x2D;&#x3E; vlan 2&#x30;&#x30;</p><p class="screen2" id="1256017">&#x2D;&#x3E; vlan 2&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1256018">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="screen2" id="1256019">&#x2D;&#x3E; vlan 4&#x30;&#x30; members port 1&#47;1&#47;1 tagged</p><p class="screen2" id="1256020">&#x2D;&#x3E; service access port 1&#47;1&#47;2</p><p class="screen2" id="1256021">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; spb isid 1&#x30;&#x30;&#x30; bvlan 4&#x30; admin&#x2D;state enable </p><p class="screen2" id="1256022">&#x2D;&#x3E; service 1&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;2&#x30;&#x30; admin&#x2D;state enable </p><p class="screen2" id="1256023">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; spb isid 2&#x30;&#x30;&#x30; bvlan 41 admin&#x2D;state enable </p><p class="screen2" id="1256024">&#x2D;&#x3E; service 2&#x30;&#x30;&#x30; sap port 1&#47;1&#47;2&#x3A;4&#x30;&#x30; admin&#x2D;state enable</p><p class="screen2" id="1256025">&#x2D;&#x3E; vrf create vrf&#x2D;1</p><p class="screen2" id="1256026">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn1 vlan 2&#x30;&#x30; address 1&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16</p><p class="screen2" id="1256027">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf create vrf&#x2D;2</p><p class="screen2" id="1256028">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ipv6 interface l3vpn2 vlan 4&#x30;&#x30; address 2&#x30;&#x30;&#x30;&#x3A;&#x3A;2&#47;16</p><p class="screen2" id="1256306">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; vrf default</p><p class="screen2" id="1256307">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;1 isid 1&#x30;&#x30;&#x30; gateway 1&#x30;&#x30;&#x30;&#x3A;&#x3A;2 all&#x2D;routes</p><p class="screen2" id="1256308">&#x2D;&#x3E; spb ipvpn6 bind vrf&#x2D;2 isid 2&#x30;&#x30;&#x30; gateway 2&#x30;&#x30;&#x30;&#x3A;&#x3A;2 all&#x2D;routes</p><p class="screen2" id="1256032">&#x2D;&#x3E; spb ipvpn6 redist source&#x2D;isid 1&#x30;&#x30;&#x30; destination&#x2D;isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1256033">&#x2D;&#x3E; spb ipvpn6 redist source&#x2D;isid 2&#x30;&#x30;&#x30; destination&#x2D;isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1256034">&#x2D;&#x3E; spb ipvpn6 redist source&#x2D;vrf vrf&#x2D;1 destination&#x2D;isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1256035">&#x2D;&#x3E; vrf vrf&#x2D;1</p><p class="screen2" id="1256036">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1256037">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1256038">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; ipv6 export all&#x2D;routes</p><p class="screen2" id="1256039">vrf&#x2D;1&#x3A;&#x3A;&#x2D;&#x3E; vrf vrf&#x2D;2</p><p class="screen2" id="1256040">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import vrf&#x2D;1 all&#x2D;routes</p><p class="screen2" id="1256041">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 1&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="screen2" id="1256042">vrf&#x2D;2&#x3A;&#x3A;&#x2D;&#x3E; ipv6 import isid 2&#x30;&#x30;&#x30; all&#x2D;routes</p><p class="heading3" id="1339707"><a id="XREF_27375__L3_VPN_External_Loopback_Migration_to_Service-Base163" name="XREF_27375__L3_VPN_External_Loopback_Migration_to_Service-Base163">L3 VPN External Loopback Migration to Inline Routing</a></p><p class="text" id="1347319"><a id="163_text_1347319" name="163_text_1347319"></a>In the following sample IP over SPB topology, an external loopback configuration serves as an L3 VPN gateway interface. </p><p class="bullet" id="1347459"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>An IP interface (&#x201c;L3VPN&#x2D;1&#x30;&#x201d;) is created in a specific VRF instance and bound to VLAN 4&#x30;&#x30;.</p><p class="bullet" id="1347478"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Bridge port 1&#47;1&#47;6 is tagged with VLAN 4&#x30;&#x30;.</p><p class="bullet" id="1347320"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Service access port 1&#47;1&#47;1 is assigned to an SPB SAP that will process customer traffic that is tagged with VLAN 4&#x30;&#x30; (1&#47;1&#47;1&#x3A;4&#x30;&#x30;). The SAP is bound to SPB service 1&#x30;.</p><p class="bullet" id="1344447"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Service access port 1&#47;1&#47;5 is assigned to an SPB SAP that will process traffic tagged with VLAN 4&#x30;&#x30; (SAP 1&#47;1&#47;5&#x3A;4&#x30;&#x30;). The SAP is bound to SPB service 1&#x30;.</p><p class="bullet" id="1347533"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A physical cable connects VLAN port 1&#47;1&#47;6 with service access port 1&#47;1&#47;5 to form the loopback configuration. Traffic is passed through the physical loopback cable between the Layer 2 SPB service domain and the Layer 3 VLAN routing domain.</p><p class="bullet_sub" id="1346087"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The service access port handles Layer 2 bridging into the service domain (between SAPs 1&#47;1&#47;1&#x3A;4&#x30;&#x30; and 1&#47;1&#47;5&#x3A;4&#x30;&#x30;).</p><p class="bullet_sub" id="1346653"><span class="bold">&#x2013;&#160;&#160;&#160; </span>The VLAN port handles the Layer 3 routing into the VLAN domain (between VLAN 4&#x30;&#x30; and other IP interface VLANs).</p><p class="text" id="1348179"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_252.svg" height="223.144226" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1346645">Figure 7&#x2D;25 &#x3A;  L3 VPN Interface Before Migration to Inline Routing</p><p class="text" id="1346446">The following CLI command examples are used to configure the sample external loopback configuration&#x3A;</p><p class="example1" id="1346442">&#x2D;&#x3E; spb interface port 1&#47;1&#47;48</p><p class="example2" id="1345376">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;&#x30; </p><p class="example2" id="1345377">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;&#x30;</p><p class="example2" id="1345378">&#x2D;&#x3E; service access port 1&#47;1&#47;1 vlan&#x2D;xlation enable</p><p class="example2" id="1345380">&#x2D;&#x3E; service spb 1&#x30; isid 1&#x30;&#x30;&#x30; bvlan 4&#x30;&#x30;&#x30; vlan&#x2D;xlation enable</p><p class="example2" id="1346553">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;1&#x3A;4&#x30;&#x30;</p><p class="example2" id="1345381">&#x2D;&#x3E; service access port 1&#47;1&#47;5 vlan&#x2D;xlation enable</p><p class="example2" id="1345382">&#x2D;&#x3E; service 1&#x30; sap port 1&#47;1&#47;5&#x3A;4&#x30;&#x30;</p><p class="example2" id="1345383">&#x2D;&#x3E; vlan 4&#x30;&#x30;</p><p class="example2" id="1345384">&#x2D;&#x3E; vlan 4&#x30;&#x30; member port 1&#47;1&#47;6 tagged</p><p class="example2" id="1345385">&#x2D;&#x3E; ip interface L3VPN&#x2D;1&#x30; address 1&#x30;.&#x30;.&#x30;.1&#47;24 vlan 4&#x30;&#x30;</p><p class="text" id="1345371">To change the L3 VPN interface setup to use service&#x2D;based inline routing instead of an external loopback, the following steps are required&#x3A;</p><p class="step_first" id="1341170"><span class="Futura_Bold">1&#160;&#160;&#160; </span>Delete the IP interface assigned to VLAN 4&#x30;&#x30;.</p><p class="example1" id="1341630">&#x2D;&#x3E; no ip interface L3VPN&#x2D;1&#x30;</p><p class="step_next" id="1341261"><span class="Futura_Bold">2&#160;&#160;&#160; </span>Delete VLAN 4&#x30;&#x30; (this automatically removes the VLAN 4&#x30;&#x30; tag from port 1&#47;1&#47;6).</p><p class="example1" id="1347125">&#x2D;&#x3E; no vlan 4&#x30;&#x30;</p><p class="step_next" id="1341378"><span class="Futura_Bold">3&#160;&#160;&#160; </span>Delete SAP 1&#47;1&#47;5&#x3A;4&#x30;&#x30; (this does not remove SPB service 1&#x30;).</p><p class="example1" id="1341793">&#x2D;&#x3E; no service 1&#x30; sap port 1&#47;1&#47;5&#x3A;4&#x30;&#x30;</p><p class="step_next" id="1341815"><span class="Futura_Bold">4&#160;&#160;&#160; </span>Disconnect the physical cable from port 1&#47;1&#47;5 and port 1&#47;1&#47;6.</p><p class="step_next" id="1341889"><span class="Futura_Bold">5&#160;&#160;&#160; </span>Configure an IP interface and bind it to SPB service 1&#x30;.</p><p class="example1" id="1341947">&#x2D;&#x3E; ip interface L3vpn&#x2D;1&#x30; address 1&#x30;.&#x30;.&#x30;.1&#47;24 service 1&#x30;</p><p class="text" id="1348254">The following shows the sample IP over SPB topology after the L3 VPN interface setup has been changed from an external loopback configuration to a service&#x2D;based inline routing configuration.</p><p class="text" id="1348293"><object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_258.svg" height="204.744385" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="621.943075"></object></p><p class="FigureTitle" id="1342286">Figure 7&#x2D;26 &#x3A;  L3 VPN Interface After Migration to Inline Routing</p><p class="text" id="1342963">Refer to <a  href="#XREF_29739__IP_over_SPB_Configuration_Guidelines163" style="color:#0000ff;background-color:transparent;">IP over SPB Configuration Guidelines</a> for more information about configuring an L3 VPN gateway interface.</p><p class="heading2" id="1329093"><a id="XREF_27091__Configuring_SPB_over_a_Multiple_Access_Domain163" name="XREF_27091__Configuring_SPB_over_a_Multiple_Access_Domain163">Configuring SPB Over Shared Ethernet</a></p><p class="text" id="1329991"><a id="163_text_1329991" name="163_text_1329991"></a>Configuring SPB multi&#x2D;access network interfaces to implement the SPB over shared Ethernet feature was not supported prior to AOS release 8.7R1; only point&#x2D;to&#x2D;point (P2P) interfaces were supported. In a network where some SPB nodes are running AOS release 8.7R1 and other SPB nodes are running earlier AOS releases, configuring multi&#x2D;access interfaces may cause inconsistent connectivity to destinations beyond the shared Ethernet network segment. If such network reachability is desired, those SPB nodes must be upgraded to AOS Release 8.7R1.</p><p class="text" id="1330316">IS&#x2D;IS is a link state protocol that fundamentally requires every participating device in the topology to have the same view of the topology represented by a link state database and to follow the same procedure for determining the shortest path to reach every other participating device in the network.</p><p class="text" id="1345841">The SPB over shared Ethernet feature represents every shared link&#47;network as a pseudo&#x2D;node. One of the nodes on the shared link is elected as a Designated IS (DIS) node which originates a pseudo&#x2D;node LSP. This pseudo&#x2D;node LSP needs to be flooded across the entire SPB network and all the devices in the SPB network (not just the devices directly connected to the shared network) need to understand this LSP to determine the shortest paths to other devices which travels through the shared network.</p><p class="text" id="1329995">Advertisement and processing of such pseudo&#x2D;node LSPs is an enhancement to the standardized ISIS&#x2D;SPB functionality provided through the ability to configure SPB multi&#x2D;access links. AOS releases prior to 8.7R1 only supported P2P links and do not process pseudo&#x2D;node LSPs.</p><p class="heading3" id="1329094">SPB Over Shared Ethernet Configuration Guidelines</p><p class="text" id="1330181">Consider the following guidelines when configuring an SPB backbone over a shared Ethernet domain, as described in <a  href="#XREF_79553__SPB_over_a_Shared_Network163" style="color:#0000ff;background-color:transparent;">SPB Over Shared Ethernet</a>&#x3A;</p><p class="bullet" id="1329098"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Identify the Backbone Edge Bridges (BEBs) that are connected to the multi&#x2D;access domain (shared network) and on which adjacencies will be formed over the shared network. On each of these BEBs, configure an SPB multi&#x2D;access network interface.</p><p class="bullet" id="1329099"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configuring more than one multi&#x2D;access network interface on the same switch is supported. However, ISIS&#x2D;SPB selects only one interface on which to form adjacencies.</p><p class="bullet" id="1329100"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Configuring a P2P network interface and a multi&#x2D;access network interface on the same switch is supported.</p><p class="bullet" id="1329101"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A Designated Intermediate System (DIS) election process determines which multi&#x2D;access interface will serve as the DIS for the virtual SPB node. A DIS is elected based on which interface has the highest priority value, with the highest backbone MAC address (BMAC) used as a tiebreaker.</p><p class="bullet" id="1329102"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The configurable priority value applies only to SPB multi&#x2D;access interfaces, not SPB P2P interfaces.</p><p class="bullet" id="1329103"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The DIS defines and represents all the multi&#x2D;access links as a virtual SPB node (pseudo&#x2D;node); to the IS&#x2D;IS network, these links are treated as just another SPB node.</p><p class="bullet" id="1329919"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>The SPB configuration requirements for a BEB with P2P interfaces are the same for a BEB with multi&#x2D;access interfaces. The SPB service objects (BVLANs, service IDs, etc.) configured on each BEB must be the same.&#160;ISIS&#x2D;SPB forms adjacencies based on the underlying SPB backbone configuration for both P2P and multi&#x2D;access domains.</p><p class="heading3" id="1329921">Configuring an SPB Multi&#x2D;Access Interface</p><p class="text" id="1329106">In order for BEBs to communicate with other BEBs over a multi&#x2D;access domain, each BEB needs to form adjacencies with all of the other BEBs. This is not possible with a P2P configuration, so each SPB network interface port must be configured as a multi&#x2D;access interface to allow multiple adjacencies to form across the broadcast network domain.</p><p class="text" id="1329107">By default, the SPB network interface type is set to P2P. To configure a multi&#x2D;access network interface, use the <a href="../c_spb/c_spb.htm#XREF_50373__spb_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">spb isis interface</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">multi&#x2D;access</span> option. For example&#x3A;</p><p class="example1" id="1329111">&#x2D;&#x3E; spb isis interface port 1&#47;1&#47;2&#x30; type multi&#x2D;access</p><p class="text" id="1329112">To configure a P2P network interface, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis interface</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">p2p</span> option. For example&#x3A;</p><p class="example1" id="1329113">&#x2D;&#x3E; spb isis interface port 1&#47;1&#47;2&#x30; type p2p</p><p class="text" id="1329114">By default, the priority value for a multi&#x2D;access interface is set to 64. This value is used to determine which multi&#x2D;access interface is elected as the DIS. To change this value, use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">spb isis interface</span> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">priority</span> parameter. For example&#x3A;</p><p class="example1" id="1329115">&#x2D;&#x3E; spb isis interface port 1&#47;1&#47;2&#x30; type multi&#x2D;access priority 1&#x30;&#x30;</p><p class="heading3" id="1329116">Verifying the SPB Multi&#x2D;Access Interface Configuration</p><p class="text" id="1329117">Each BEB that will form adjacencies over a shared Ethernet domain must be configured with an SPB multi&#x2D;access interface. To verify the interface type, use the <a href="../c_spb/c_spb.htm#XREF_79870__show_ip_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis interface</a> command. The &#x201c;Circ Type&#x201d; field displays the interface type (&#x201c;P2P or &#x201c;Multi&#x2D;Access&#x201d;). For example&#x3A;</p><p class="screen" id="1329121">&#x2D;&#x3E; show spb isis interface</p><p class="screen2" id="1329122">SPB ISIS Interfaces&#x3A;</p><p class="screen2" id="1329123">                               Oper   Admin   Link      Hello   Hello   Circ</p><p class="screen2" id="1329124"> Interface      Level  CircID  state  state   Metric    Intvl   Mult    Type</p><p class="screen2" id="1329125">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1329126"> 1&#47;1&#47;1          L1      1       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329127"> 1&#47;1&#47;2          L1      2       UP     UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329128"> 1&#47;1&#47;3          L1      3       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329129"> 1&#47;1&#47;4          L1      4       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329130"> 1&#47;1&#47;5          L1      5       UP     UP      1&#x30;      3       3       Multi&#x2D;Access</p><p class="screen2" id="1329131"> 1&#47;1&#47;6          L1      6       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329132"> 1&#47;1&#47;7          L1      7       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329133"> 1&#47;1&#47;1&#x30;         L1      9       DOWN   UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329134"> &#x30;&#47;3            L1      1       UP     UP      1&#x30;      9       3       P2P</p><p class="screen2" id="1329135"><br/></p><p class="screen2" id="1329136">Interfaces &#x3A; 9</p><p class="text" id="1329140">To determine if the multi&#x2D;access interface is serving as the DIS, use the <a href="../c_spb/c_spb.htm#XREF_79870__show_ip_isis_interface" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis interface</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">port</span> or <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">linkagg</span> parameter. For example, the following displays additional information for the SPB interface configured on port 1&#47;1&#47;5&#x3A;</p><p class="screen" id="1329141">&#x2D;&#x3E; show spb isis interface port 1&#47;1&#47;5 </p><p class="screen2" id="1329142">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1329143">Interface        &#x3A; 1&#47;1&#47;5                     Type          &#x3A; Multi&#x2D;Access</p><p class="screen2" id="1329144">Oper State       &#x3A; UP                        Admin State   &#x3A; UP        </p><p class="screen2" id="1329145">Circuit Id       &#x3A; 1                         CSNP Int      &#x3A; 1&#x30; sec    </p><p class="screen2" id="1329146">Desg IS          &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.8a1c            Adjacencies   &#x3A; 3</p><p class="screen2" id="1329147">Metric           &#x3A; 1&#x30;                        Hello Timer   &#x3A; 3 sec</p><p class="screen2" id="1329148">Hello Mult       &#x3A; 3                         Priority      &#x3A; 64</p><p class="screen2" id="1329149">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="text" id="1329150">In the above <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show</span> command example, interface port 1&#47;1&#47;5 is serving as the DIS. This is indicated by the system ID displayed in the &#x201c;Desg IS&#x201d; field. If this interface is not a multi&#x2D;access interface, then &#x201c;N&#47;A&#x201d; would appear in this field.</p><p class="text" id="1329154">To verify the adjacencies formed on a multi&#x2D;access interface, use the <a href="../c_spb/c_spb.htm#XREF_76155__show_ip_isis_adjacency" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis adjacency</a> command. For example, the following displays three adjacencies discovered and formed on multi&#x2D;access interface port 1&#47;1&#47;5&#x3A;</p><p class="screen" id="1329155">&#x2D;&#x3E; show spb isis adjacency </p><p class="screen2" id="1329156">SPB ISIS Adjacency&#x3A;</p><p class="screen2" id="1329157">System                                                               </p><p class="screen2" id="1329158"> (Name &#x3A; SystemId)                     Type   State   Hold  Interface </p><p class="screen2" id="1329159">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1329160">BEB&#x2D;3               &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.f&#x30;2c  L1    UP        25      1&#47;1&#47;5</p><p class="screen2" id="1329161">BEB&#x2D;4               &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.f61c  L1    UP        18      1&#47;1&#47;5</p><p class="screen2" id="1329162">BEB&#x2D;5               &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.51dc  L1    UP        26      1&#47;1&#47;5</p><p class="text" id="1329163">The elected DIS represents all of the multi&#x2D;access links as a virtual SPB node (pseudo&#x2D;node). As a result, the DIS also generates a pseudo&#x2D;node LSP that lists all the multi&#x2D;access links as neighbors. The pseudo&#x2D;node LSP differs from a regular LSP in that a regular LSP lists the pseudo&#x2D;node as a neighbor, along with other information about the SPB service configuration.</p><p class="text" id="1329166">To display the ISIS&#x2D;SPB topology information maintained in the link state database (LSDB), use the <a href="../c_spb/c_spb.htm#XREF_86288__show_ip_isis_database" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis database</a> command. For example&#x3A;</p><p class="screen" id="1329168">&#x2D;&#x3E; show spb isis database </p><p class="screen2" id="1329169">Legends &#x3A; P    &#x3D; The Partition repair bit is set</p><p class="screen2" id="1329170">          OV   &#x3D; The overload bit is set</p><p class="screen2" id="1329171">          ATT  &#x3D; The Attach bit is set</p><p class="screen2" id="1329172">          L1   &#x3D; Specifies a Level 1 IS type</p><p class="screen2" id="1329173">          L2   &#x3D; Specifies a Level 2 IS type</p><p class="screen2" id="1329174">SPB ISIS LSP Database&#x3A;</p><p class="screen2" id="1329175">LSP ID                 Sequence    Checksum   Lifetime   Attributes </p><p class="screen2" id="1329176">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;+&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1329177"> &#x30;&#x30;d&#x30;.95&#x30;1.51dc.&#x30;&#x30;&#x2D;&#x30;&#x30;        &#x30;x&#x30;b     &#x30;x98ba       1&#x30;49   L1          </p><p class="screen2" id="1329178"> &#x30;&#x30;d&#x30;.95&#x30;1.8a1c.&#x30;&#x30;&#x2D;&#x30;&#x30;        &#x30;x&#x30;d     &#x30;x97&#x30;5       1&#x30;47   L1          </p><p class="screen2" id="1329179"> &#x30;&#x30;d&#x30;.95&#x30;1.8a1c.23&#x2D;&#x30;&#x30;        &#x30;x&#x30;1     &#x30;x7e66        985   L1          </p><p class="screen2" id="1329180"> &#x30;&#x30;d&#x30;.95&#x30;1.f&#x30;2c.&#x30;&#x30;&#x2D;&#x30;&#x30;        &#x30;x&#x30;7     &#x30;x515b        99&#x30;   L1          </p><p class="screen2" id="1329181"> &#x30;&#x30;d&#x30;.95&#x30;1.f&#x30;2c.19&#x2D;&#x30;&#x30;        &#x30;x&#x30;1       &#x30;x&#x30;&#x30;      (982)   L1          </p><p class="screen2" id="1329182"> &#x30;&#x30;d&#x30;.95&#x30;1.f61c.&#x30;&#x30;&#x2D;&#x30;&#x30;        &#x30;x&#x30;6     &#x30;xcc&#x30;8        991   L1          </p><p class="screen2" id="1329183"> &#x30;&#x30;d&#x30;.95&#x30;1.f61c.15&#x2D;&#x30;&#x30;        &#x30;x&#x30;3       &#x30;x&#x30;&#x30;      (984)   L1          </p><p class="screen2" id="1329184"><br/></p><p class="screen2" id="1329185"> Level&#x2D;1 LSP count &#x3A; 7</p><p class="text" id="1329189">To display the pseudo&#x2D;node LSP, use the <a href="../c_spb/c_spb.htm#XREF_86288__show_ip_isis_database" style="font-weight:Bold;color:#0000ff;background-color:transparent;">show spb isis database</a> command with the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">lsp&#x2D;id</span> parameter. For example, the following command displays pseudo&#x2D;node LSP ID &#x30;&#x30;d&#x30;.95&#x30;1.8alc.23&#x2D;&#x30;&#x30;, which was generated by the DIS multi&#x2D;access interface&#x3A;</p><p class="screen" id="1329190">&#x2D;&#x3E; show spb isis database lsp&#x2D;id &#x30;&#x30;d&#x30;.95&#x30;1.8a1c.23&#x2D;&#x30;&#x30;</p><p class="screen2" id="1329191">Legends &#x3A; P    &#x3D; The Partition repair bit is set</p><p class="screen2" id="1329192">          OV   &#x3D; The overload bit is set</p><p class="screen2" id="1329193">          ATT  &#x3D; The Attach bit is set</p><p class="screen2" id="1329194">          L1   &#x3D; Specifies a Level 1 IS type</p><p class="screen2" id="1329195">          L2   &#x3D; Specifies a Level 2 IS type</p><p class="screen2" id="1329196">SPB ISIS LSP Database&#x3A;</p><p class="screen2" id="1329197">&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;&#x2D;</p><p class="screen2" id="1329198">LSP ID        &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.8a1c.23&#x2D;&#x30;&#x30;                   Level     &#x3A; L1      </p><p class="screen2" id="1329199">Sequence      &#x3A; &#x30;x&#x30;1             Checksum  &#x3A; &#x30;x7e66    Lifetime  &#x3A; 966     </p><p class="screen2" id="1329200">Version       &#x3A; 1                Pkt Type  &#x3A; 18        Pkt Ver   &#x3A; 1       </p><p class="screen2" id="1329201">Attributes    &#x3A; L1               Max Area  &#x3A; 3                         </p><p class="screen2" id="1329202">SysID Len     &#x3A; 6                Used Len  &#x3A; 1&#x30;5       Alloc Len &#x3A; 1492    </p><p class="screen2" id="1329203"><br/></p><p class="screen2" id="1329204">TLVs &#x3A;</p><p class="screen2" id="1329205">TE IS Neighbors     &#x3A;</p><p class="screen2" id="1329206">   Neighbor         &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.8a1c  SPB Metric 1&#x30; Num of Ports 1 Port&#x2D;Id &#x30;x8&#x30;&#x30;2()</p><p class="screen2" id="1329207">   Neighbor         &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.51dc  SPB Metric 1&#x30; Num of Ports 1 Port&#x2D;Id &#x30;x8&#x30;&#x30;2()</p><p class="screen2" id="1329208">   Neighbor         &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.f&#x30;2c  SPB Metric 1&#x30; Num of Ports 1 Port&#x2D;Id &#x30;x8&#x30;&#x30;2()</p><p class="screen2" id="1329209">   Neighbor         &#x3A; &#x30;&#x30;d&#x30;.95&#x30;1.f61c  SPB Metric 1&#x30; Num of Ports 1 Port&#x2D;Id &#x30;x8&#x30;&#x30;2()</p><p class="screen2" id="1329210"><br/></p><p class="heading3" id="1329211"><a id="XREF_63452__SPB_over_a_Multi-Access_Domain_Configuration_Examp163" name="XREF_63452__SPB_over_a_Multi-Access_Domain_Configuration_Examp163">SPB </a>Over Shared Ethernet Configuration Examples</p><p class="text" id="1329212"><a id="163_text_1329212" name="163_text_1329212"></a>An SPB multi&#x2D;access domain can be configured over a shared Ethernet network (such as a service provider network) or even another SPB network. This section contains diagrams and CLI command examples for configuring the following scenarios&#x3A;</p><p class="bullet" id="1329216"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_13552__SPB_Backbone_over_a_Shared_Network163" style="color:#0000ff;background-color:transparent;">SPB Backbone over a Shared Network</a>.</p><p class="bullet" id="1329220"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span><a  href="#XREF_41741__SPB_Backbone_over_Another_SPB_Network163" style="color:#0000ff;background-color:transparent;">SPB Backbone over Another SPB Network</a>.</p><p class="heading4" id="1329221"><a id="XREF_13552__SPB_Backbone_over_a_Shared_Network163" name="XREF_13552__SPB_Backbone_over_a_Shared_Network163">SPB Backbone over a Shared Network</a></p><p class="text" id="1329222"><a id="163_text_1329222" name="163_text_1329222"></a>The following diagram shows an example of an SPB network backbone comprised of SPB Backbone Edge Bridges (BEBs) that are connected to a shared service provider network. In this sample topology, each BEB establishes ISIS&#x2D;SPB adjacencies with all of the other BEBs to form an SPB backbone that is extended over the service provider network.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_264.svg" height="351.244853" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="609.143188"></object></p><p class="FigureTitle" id="1329257">Figure 7&#x2D;27 &#x3A;  SPB Backbone over a Shared Network</p><p class="text" id="1329258">In this sample topology, all four BEBs are configured as follows&#x3A;</p><p class="bullet" id="1329259"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>BVLAN 4&#x30;&#x30;1 and 4&#x30;&#x30;2, with Control BVLAN set to 4&#x30;&#x30;1.</p><p class="bullet" id="1329260"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB network interface port 1&#47;1&#47;5 configured as a multi&#x2D;access interface.</p><p class="bullet" id="1329261"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Port 1&#47;1&#47;1&#x30; configured as an access port </p><p class="bullet" id="1329262"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 2&#x30; bound to I&#x2D;SID 15&#x30;1 and BVLAN 4&#x30;&#x30;1.</p><p class="bullet" id="1329263"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 4&#x30; bound to I&#x2D;SID 15&#x30;2 and BVLAN 4&#x30;&#x30;2.</p><p class="bullet" id="1329264"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A service access point (SAP) comprised of the SPB service, access port, and encapsulation. The SAP identifies VLAN traffic to associate with the service.</p><p class="text" id="1329265">The following CLI command examples are used to configure each BEB in the sample topology&#x3A;</p><p class="example1" id="1329266">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="example2" id="1329267">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="example2" id="1329268">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="example2" id="1329269">&#x2D;&#x3E; spb isis interface port 1&#47;1&#47;5 type multi&#x2D;access</p><p class="example2" id="1329270">&#x2D;&#x3E; service access port 1&#47;1&#47;1&#x30;</p><p class="example2" id="1329271">&#x2D;&#x3E; service 2&#x30; spb isid 15&#x30;1 bvlan 4&#x30;&#x30;1</p><p class="example2" id="1329272">&#x2D;&#x3E; service 4&#x30; spb isid 15&#x30;2 bvlan 4&#x30;&#x30;2</p><p class="example2" id="1329273">&#x2D;&#x3E; service 2&#x30; sap port 1&#47;1&#47;1&#x30;&#x3A;all</p><p class="example2" id="1329274">&#x2D;&#x3E; service 4&#x30; sap port 1&#47;1&#47;1&#x30;&#x3A;all</p><p class="example2" id="1329275">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="heading4" id="1329276"><a id="XREF_41741__SPB_Backbone_over_Another_SPB_Network163" name="XREF_41741__SPB_Backbone_over_Another_SPB_Network163">SPB Backbone over Another SPB Network</a></p><p class="text" id="1329277"><a id="163_text_1329277" name="163_text_1329277"></a>The following diagram shows an example of an SPB network backbone comprised of SPB Backbone Edge Bridges (BEBs) that are connected to another SPB network. In this sample topology, the SPB network interface port on each BEB connects to an access port on the inner SPB backbone. ISIS&#x2D;SPB adjacencies are established between all of the BEBs over the inner SPB network.<object class="imageSettings" data="../assets/os8_nt_-_Web_7-Configuring_Shortest_Path_Bridging_FOM_SVG_270.svg" height="348.844869" style="max-width: 100% ;height: auto;display:block;margin:auto;" type="image/svg+xml" width="609.143188"></object></p><p class="FigureTitle" id="1329318">Figure 7&#x2D;28 &#x3A;  SPB Backbone over Another SPB Network</p><p class="text" id="1329319">In this sample topology, all four BEBs are configured as follows&#x3A;</p><p class="bullet" id="1329320"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>BVLAN 4&#x30;&#x30;1 and 4&#x30;&#x30;2, with Control BVLAN set to 4&#x30;&#x30;1.</p><p class="bullet" id="1329321"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB network interface port 1&#47;1&#47;5 configured as a multi&#x2D;access interface. Each multi&#x2D;access interface port connects to access port 1&#47;1&#47;2 on the inner SPB backbone network.</p><p class="bullet" id="1329322"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>Port 1&#47;1&#47;1&#x30; configured as an access port.</p><p class="bullet" id="1329323"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 2&#x30; bound to I&#x2D;SID 15&#x30;1 and BVLAN 4&#x30;&#x30;1.</p><p class="bullet" id="1329324"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>SPB service 4&#x30; bound to I&#x2D;SID 15&#x30;2 and BVLAN 4&#x30;&#x30;2.</p><p class="bullet" id="1329325"><span class="Bullet_Character">&#x2022;&#160;&#160;&#160; </span>A Service Access Point (SAP) comprised of the SPB service, access port, and encapsulation. The SAP identifies VLAN traffic to associate with the service. </p><p class="text" id="1329326">The following CLI command examples are used to configure each BEB in the sample topology&#x3A;</p><p class="example1" id="1329327">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;1</p><p class="example2" id="1329328">&#x2D;&#x3E; spb bvlan 4&#x30;&#x30;2</p><p class="example2" id="1329329">&#x2D;&#x3E; spb isis control&#x2D;bvlan 4&#x30;&#x30;1</p><p class="example2" id="1329330">&#x2D;&#x3E; spb isis interface port 1&#47;1&#47;5 type multi&#x2D;access</p><p class="example2" id="1329331">&#x2D;&#x3E; service access port 1&#47;1&#47;1&#x30;</p><p class="example2" id="1329332">&#x2D;&#x3E; service 2&#x30; spb isid 15&#x30;1 bvlan 4&#x30;&#x30;1</p><p class="example2" id="1329333">&#x2D;&#x3E; service 4&#x30; spb isid 15&#x30;2 bvlan 4&#x30;&#x30;2</p><p class="example2" id="1329334">&#x2D;&#x3E; service 2&#x30; sap port 1&#47;1&#47;1&#x30;&#x3A;all</p><p class="example2" id="1329335">&#x2D;&#x3E; service 4&#x30; sap port 1&#47;1&#47;1&#x30;&#x3A;all</p><p class="example2" id="1329336">&#x2D;&#x3E; spb isis admin&#x2D;state enable</p><p class="heading1" id="1132964"><a id="XREF_40397__OmniSwitch_9900_IP_over_SPB_Configuration_Examples163" name="XREF_40397__OmniSwitch_9900_IP_over_SPB_Configuration_Examples163"></a><a id="XREF_98796__Verifying_the_SPB_Backbone_and_Services163" name="XREF_98796__Verifying_the_SPB_Backbone_and_Services163">Verifying the SPB Backbone and Services</a></p><p class="text" id="1077424"><a id="163_text_1077424" name="163_text_1077424"></a>Displaying the SPBM configuration is helpful to verify the actual configuration on each SPB switch in the topology and to troubleshoot ISIS&#x2D;SPB backbone and SPB service connectivity. </p><p class="heading2" id="1133135">Verifying the ISIS&#x2D;SPB Backbone Configuration</p><p>To display information about the ISIS&#x2D;SPB infrastructure (backbone), use the <span class="Times_Bold" style="font-weight:Bold;background-color:transparent;">show</span> commands listed in this section.<div align="left"><table class="Related_Cmds" style="max-width: 100% ;height: auto;"><col width="192.00px"/><col width="408.00px"/><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133290"><a href="../c_spb/c_spb.htm#XREF_61081__show_ip_isis_status" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis info</a></p></td><td><p class="CellBody" id="1133292">Displays the global status and configuration for the ISIS&#x2D;SPB instance on the switch.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1133294"><a href="../c_spb/c_spb.htm#XREF_92652__show_spb_isis_bvlans" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis bvlans</a></p></td><td><p class="CellBody" id="1133296">Displays the backbone VLAN (BVLAN) configuration for the switch.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1118966"><a href="../c_spb/c_spb.htm#XREF_79870__show_ip_isis_interface" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis interface</a></p></td><td><p class="CellBody" id="1118968">Displays the SPB interface (network port) configuration for the switch.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1118973"><a href="../c_spb/c_spb.htm#XREF_76155__show_ip_isis_adjacency" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis adjacency</a></p></td><td><p class="CellBody" id="1118975">Displays information about the ISIS&#x2D;SPB adjacencies created for the SPB switch.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133307"><a href="../c_spb/c_spb.htm#XREF_86288__show_ip_isis_database" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis database</a></p></td><td><p class="CellBody" id="1133309">Displays ISIS&#x2D;SPB topology information maintained in the link state database (LSDB).</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1118980"><a href="../c_spb/c_spb.htm#XREF_93171__show_spb_isis_nodes" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis nodes</a></p></td><td><p class="CellBody" id="1118982">Displays the discovered node&#x2D;level parameter values for all of the ISIS&#x2D;SPB switches participating in the topology.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1133318"><a href="../c_spb/c_spb.htm#XREF_65691__show_spb_isis_unicast-table" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis unicast-table</a></p></td><td><p class="CellBody" id="1133320">Displays the unicast forwarding information for the BVLAN topology.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133338"><a href="../c_spb/c_spb.htm#XREF_11040__show_spb_isis_services" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis services</a></p></td><td><p class="CellBody" id="1133340">Displays a network&#x2D;wide view of existing services to help verify that SPB services are correctly advertised and learned by ISIS&#x2D;SPB</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133375"><a href="../c_spb/c_spb.htm#XREF_91702__show_spb_isis_spf_bvlan" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis spf</a></p></td><td><p class="CellBody" id="1133377">Displays the shortest path first (SPF) information to all known SPB switches for a specific BVLAN.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1133349"><a href="../c_spb/c_spb.htm#XREF_21605__show_spb_isis_multicast-table" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis multicast-table</a></p></td><td><p class="CellBody" id="1133351">Displays the multicast forwarding entries for services.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133365"><a href="../c_spb/c_spb.htm#XREF_95974__show_spb_isis_multicast-sources" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis multicast-sources</a></p></td><td><p class="CellBody" id="1133367">Displays all the known multicast sources across the SPB domain and BVLANs.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133396"><a href="../c_spb/c_spb.htm#XREF_53760__show_spb_isis_multicast-sources-spf" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis multicast-sources-spf</a></p></td><td><p class="CellBody" id="1133403">Displays the shortest path first (SPF) readability for a known multicast source bridge for a specific BVLAN.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133412"><a href="../c_spb/c_spb.htm#XREF_12075__show_spb_isis_ingress-mac-filter" style="font-kerning:none;color:#0000ff;background-color:transparent;">show spb isis ingress-mac-filter</a></p></td><td><p class="CellBody" id="1135058">Displays the ingress MAC filter for multicast traffic for a given BVLAN operating in the (&#x2A;,G) mode.</p></td></tr></table></div></p><p class="heading2" id="1133422">Verifying the SPB Service Configuration</p><p style="margin-top : 9.00pt;line-height : 13.00pt;font-size : 12.00pt;"><span style="font-size : 10.50pt;">To display information about the Service Manager configuration for SPB service connectivity, use the </span><span class="Times_Bold" style="font-weight:Bold;font-size : 10.50pt;background-color:transparent;">show</span><span style="font-size : 10.50pt;"> commands listed in this section.</span><div align="left"><table class="Related_Cmds" style="max-width: 100% ;height: auto;"><col width="192.00px"/><col width="408.00px"/><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1133435"><a href="../c_svcmgr/c_svcmgr.htm#XREF_98570__show_service_port" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service access</a></p></td><td><p class="CellBody" id="1133437">Displays the service access (customer&#x2D;facing) port configuration.</p></td></tr><tr height="54.00px"><td><p class="CellBody_cli_cmd" id="1133442"><a href="../c_svcmgr/c_svcmgr.htm#XREF_44687__show_service_l2profile" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service l2profile</a></p></td><td><p class="CellBody" id="1133444">Displays the Layer 2 profile definitions. These profiles are applied to service access ports to determine how Layer 2 control protocol frames are processed on these ports.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1133500"><a href="../c_svcmgr/c_svcmgr.htm#XREF_82323__show_service" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service</a></p></td><td><p class="CellBody" id="1133502">Displays the service configuration.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133511"><a href="../c_svcmgr/c_svcmgr.htm#XREF_15149__show_service_spb_ports" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service ports</a></p></td><td><p class="CellBody" id="1133513">Displays all the virtual ports (SAPs, SDPs) that are associated with an SPB service.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133515"><a href="../c_svcmgr/c_svcmgr.htm#XREF_76189__show_service_spb_sap" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service spb sap</a></p></td><td><p class="CellBody" id="1133517">Displays the configuration information for the specified SAP ID associated with the specified service.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1133449"><a href="../c_svcmgr/c_svcmgr.htm#XREF_47069__show_service_sdp" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service sdp</a></p></td><td><p class="CellBody" id="1133451">Displays the dynamic Service Distribution Point (SDP) configuration.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1133456"><a href="../c_svcmgr/c_svcmgr.htm#XREF_23989__show_service_mesh-sdp" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service bind-sdp</a></p></td><td><p class="CellBody" id="1133458">Displays the dynamic SDP&#x2D;to&#x2D;service binding configuration.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133467"><a href="../c_svcmgr/c_svcmgr.htm#XREF_87728__show_service_spb_debug-info" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service debug-info</a></p></td><td><p class="CellBody" id="1133469">&#160;Displays debug information for the virtual ports associated with the SPB service.</p></td></tr><tr height="22.00px"><td><p class="CellBody_cli_cmd" id="1145787"><a href="../c_svcmgr/c_svcmgr.htm#XREF_39146__show_service_vxlan_udp-port" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service info</a></p></td><td><p class="CellBody" id="1145789">Displays the global Service Manager configuration for the switch.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133471"><a href="../c_svcmgr/c_svcmgr.htm#XREF_59176__show_service_spb_counters" style="font-kerning:none;color:#0000ff;background-color:transparent;">show service counters</a></p></td><td><p class="CellBody" id="1133473">Displays the traffic statistics for the specified SPB service and associated virtual ports.</p></td></tr><tr height="38.00px"><td><p class="CellBody_cli_cmd" id="1133475"><a href="../c_svcmgr/c_svcmgr.htm#XREF_16216__clear_service_spb_counters" style="font-kerning:none;color:#0000ff;background-color:transparent;">clear service counters</a></p></td><td><p class="CellBody" id="1133477">Clears the traffic statistics for the specified SPB service and associated virtual ports.</p></td></tr></table></div></p><p class="text" id="1119045">For more information about the resulting displays from these commands, see the <span class="Times_italics" style="font-style:Italic;background-color:transparent;"><span data-keyref="CLI Reference Guide">OmniSwitch AOS Release 8 CLI Reference Guide</span></span>. </p></div>
</body>
</html>